<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-pragma">{-# LANGUAGE Trustworthy #-}</span><span>
</span><a name="line-2"></a><span class="hs-pragma">{-# LANGUAGE CPP, NoImplicitPrelude, ScopedTypeVariables, BangPatterns #-}</span><span>
</span><a name="line-3"></a><span>
</span><a name="line-4"></a><span class="hs-comment">-----------------------------------------------------------------------------</span><span>
</span><a name="line-5"></a><span class="hs-comment">-- |</span><span>
</span><a name="line-6"></a><span class="hs-comment">-- Module      :  Foreign.Storable</span><span>
</span><a name="line-7"></a><span class="hs-comment">-- Copyright   :  (c) The FFI task force 2001</span><span>
</span><a name="line-8"></a><span class="hs-comment">-- License     :  see libraries/base/LICENSE</span><span>
</span><a name="line-9"></a><span class="hs-comment">-- </span><span>
</span><a name="line-10"></a><span class="hs-comment">-- Maintainer  :  ffi@haskell.org</span><span>
</span><a name="line-11"></a><span class="hs-comment">-- Stability   :  provisional</span><span>
</span><a name="line-12"></a><span class="hs-comment">-- Portability :  portable</span><span>
</span><a name="line-13"></a><span class="hs-comment">--</span><span>
</span><a name="line-14"></a><span class="hs-comment">-- The module &quot;Foreign.Storable&quot; provides most elementary support for</span><span>
</span><a name="line-15"></a><span class="hs-comment">-- marshalling and is part of the language-independent portion of the</span><span>
</span><a name="line-16"></a><span class="hs-comment">-- Foreign Function Interface (FFI), and will normally be imported via</span><span>
</span><a name="line-17"></a><span class="hs-comment">-- the &quot;Foreign&quot; module.</span><span>
</span><a name="line-18"></a><span class="hs-comment">--</span><span>
</span><a name="line-19"></a><span class="hs-comment">-----------------------------------------------------------------------------</span><span>
</span><a name="line-20"></a><span>
</span><a name="line-21"></a><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Foreign.Storable</span><span>
</span><a name="line-22"></a><span>        </span><span class="hs-special">(</span><span> </span><a href="Foreign.Storable.html#Storable"><span class="hs-identifier hs-type">Storable</span></a><span class="hs-special">(</span><span>
</span><a name="line-23"></a><span>             </span><a href="Foreign.Storable.html#sizeOf"><span class="hs-identifier hs-var">sizeOf</span></a><span class="hs-special">,</span><span>
</span><a name="line-24"></a><span>             </span><a href="Foreign.Storable.html#alignment"><span class="hs-identifier hs-var">alignment</span></a><span class="hs-special">,</span><span>
</span><a name="line-25"></a><span>             </span><a href="Foreign.Storable.html#peekElemOff"><span class="hs-identifier hs-var">peekElemOff</span></a><span class="hs-special">,</span><span>
</span><a name="line-26"></a><span>             </span><a href="Foreign.Storable.html#pokeElemOff"><span class="hs-identifier hs-var">pokeElemOff</span></a><span class="hs-special">,</span><span>
</span><a name="line-27"></a><span>             </span><a href="Foreign.Storable.html#peekByteOff"><span class="hs-identifier hs-var">peekByteOff</span></a><span class="hs-special">,</span><span>
</span><a name="line-28"></a><span>             </span><a href="Foreign.Storable.html#pokeByteOff"><span class="hs-identifier hs-var">pokeByteOff</span></a><span class="hs-special">,</span><span>
</span><a name="line-29"></a><span>             </span><a href="Foreign.Storable.html#peek"><span class="hs-identifier hs-var">peek</span></a><span class="hs-special">,</span><span>
</span><a name="line-30"></a><span>             </span><a href="Foreign.Storable.html#poke"><span class="hs-identifier hs-var">poke</span></a><span class="hs-special">)</span><span>
</span><a name="line-31"></a><span>        </span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-32"></a><span>
</span><a name="line-33"></a><span>
</span><a name="line-34"></a><span class="hs-cpp">#include &quot;MachDeps.h&quot;
#include &quot;HsBaseConfig.h&quot;
</span><span>
</span><a name="line-37"></a><span class="hs-keyword">import</span><span> </span><a href="GHC.Storable.html"><span class="hs-identifier">GHC.Storable</span></a><span>
</span><a name="line-38"></a><span class="hs-keyword">import</span><span> </span><a href="GHC.Stable.html"><span class="hs-identifier">GHC.Stable</span></a><span>       </span><span class="hs-special">(</span><span> </span><a href="GHC.Stable.html#StablePtr"><span class="hs-identifier hs-type">StablePtr</span></a><span> </span><span class="hs-special">)</span><span>
</span><a name="line-39"></a><span class="hs-keyword">import</span><span> </span><a href="GHC.Num.html"><span class="hs-identifier">GHC.Num</span></a><span>
</span><a name="line-40"></a><span class="hs-keyword">import</span><span> </span><a href="GHC.Int.html"><span class="hs-identifier">GHC.Int</span></a><span>
</span><a name="line-41"></a><span class="hs-keyword">import</span><span> </span><a href="GHC.Word.html"><span class="hs-identifier">GHC.Word</span></a><span>
</span><a name="line-42"></a><span class="hs-keyword">import</span><span> </span><a href="GHC.Ptr.html"><span class="hs-identifier">GHC.Ptr</span></a><span>
</span><a name="line-43"></a><span class="hs-keyword">import</span><span> </span><a href="GHC.Base.html"><span class="hs-identifier">GHC.Base</span></a><span>
</span><a name="line-44"></a><span class="hs-keyword">import</span><span> </span><a href="GHC.Fingerprint.Type.html"><span class="hs-identifier">GHC.Fingerprint.Type</span></a><span>
</span><a name="line-45"></a><span class="hs-keyword">import</span><span> </span><a href="Data.Bits.html"><span class="hs-identifier">Data.Bits</span></a><span>
</span><a name="line-46"></a><span class="hs-keyword">import</span><span> </span><a href="GHC.Real.html"><span class="hs-identifier">GHC.Real</span></a><span>
</span><a name="line-47"></a><span>
</span><a name="line-48"></a><span class="hs-comment">{- |
The member functions of this class facilitate writing values of
primitive types to raw memory (which may have been allocated with the
above mentioned routines) and reading values from blocks of raw
memory.  The class, furthermore, includes support for computing the
storage requirements and alignment restrictions of storable types.

Memory addresses are represented as values of type @'Ptr' a@, for some
@a@ which is an instance of class 'Storable'.  The type argument to
'Ptr' helps provide some valuable type safety in FFI code (you can\'t
mix pointers of different types without an explicit cast), while
helping the Haskell type system figure out which marshalling method is
needed for a given pointer.

All marshalling between Haskell and a foreign language ultimately
boils down to translating Haskell data structures into the binary
representation of a corresponding data structure of the foreign
language and vice versa.  To code this marshalling in Haskell, it is
necessary to manipulate primitive data types stored in unstructured
memory blocks.  The class 'Storable' facilitates this manipulation on
all types for which it is instantiated, which are the standard basic
types of Haskell, the fixed size @Int@ types ('Int8', 'Int16',
'Int32', 'Int64'), the fixed size @Word@ types ('Word8', 'Word16',
'Word32', 'Word64'), 'StablePtr', all types from &quot;Foreign.C.Types&quot;,
as well as 'Ptr'.
-}</span><span>
</span><a name="line-74"></a><span>
</span><a name="line-75"></a><span class="hs-keyword">class</span><span> </span><a name="Storable"><a href="Foreign.Storable.html#Storable"><span class="hs-identifier">Storable</span></a></a><span> </span><a name="local-6989586621679090510"><a href="#local-6989586621679090510"><span class="hs-identifier">a</span></a></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-76"></a><span>   </span><span class="hs-pragma">{-# MINIMAL</span><span> </span><span class="hs-pragma">sizeOf</span><span class="hs-pragma">,</span><span> </span><span class="hs-pragma">alignment</span><span class="hs-pragma">,</span><span>
</span><a name="line-77"></a><span>               </span><span class="hs-pragma">(</span><span class="hs-pragma">peek</span><span> </span><span class="hs-pragma">|</span><span> </span><span class="hs-pragma">peekElemOff</span><span> </span><span class="hs-pragma">|</span><span> </span><span class="hs-pragma">peekByteOff</span><span class="hs-pragma">)</span><span class="hs-pragma">,</span><span>
</span><a name="line-78"></a><span>               </span><span class="hs-pragma">(</span><span class="hs-pragma">poke</span><span> </span><span class="hs-pragma">|</span><span> </span><span class="hs-pragma">pokeElemOff</span><span> </span><span class="hs-pragma">|</span><span> </span><span class="hs-pragma">pokeByteOff</span><span class="hs-pragma">)</span><span> </span><span class="hs-pragma">#-}</span><span>
</span><a name="line-79"></a><span>
</span><a name="line-80"></a><span>   </span><a name="sizeOf"><a href="Foreign.Storable.html#sizeOf"><span class="hs-identifier">sizeOf</span></a></a><span>      </span><span class="hs-glyph">::</span><span> </span><a href="#local-6989586621679090510"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../ghc-prim-0.5.2.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Types.html#Int"><span class="hs-identifier hs-type">Int</span></a><span>
</span><a name="line-81"></a><span>   </span><span class="hs-comment">-- ^ Computes the storage requirements (in bytes) of the argument.</span><span>
</span><a name="line-82"></a><span>   </span><span class="hs-comment">-- The value of the argument is not used.</span><span>
</span><a name="line-83"></a><span>
</span><a name="line-84"></a><span>   </span><a name="alignment"><a href="Foreign.Storable.html#alignment"><span class="hs-identifier">alignment</span></a></a><span>   </span><span class="hs-glyph">::</span><span> </span><a href="#local-6989586621679090510"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../ghc-prim-0.5.2.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Types.html#Int"><span class="hs-identifier hs-type">Int</span></a><span>
</span><a name="line-85"></a><span>   </span><span class="hs-comment">-- ^ Computes the alignment constraint of the argument.  An</span><span>
</span><a name="line-86"></a><span>   </span><span class="hs-comment">-- alignment constraint @x@ is fulfilled by any address divisible</span><span>
</span><a name="line-87"></a><span>   </span><span class="hs-comment">-- by @x@.  The value of the argument is not used.</span><span>
</span><a name="line-88"></a><span>
</span><a name="line-89"></a><span>   </span><a name="peekElemOff"><a href="Foreign.Storable.html#peekElemOff"><span class="hs-identifier">peekElemOff</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><a href="GHC.Ptr.html#Ptr"><span class="hs-identifier hs-type">Ptr</span></a><span> </span><a href="#local-6989586621679090510"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../ghc-prim-0.5.2.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Types.html#Int"><span class="hs-identifier hs-type">Int</span></a><span>      </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../ghc-prim-0.5.2.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Types.html#IO"><span class="hs-identifier hs-type">IO</span></a><span> </span><a href="#local-6989586621679090510"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-90"></a><span>   </span><span class="hs-comment">-- ^       Read a value from a memory area regarded as an array</span><span>
</span><a name="line-91"></a><span>   </span><span class="hs-comment">--         of values of the same kind.  The first argument specifies</span><span>
</span><a name="line-92"></a><span>   </span><span class="hs-comment">--         the start address of the array and the second the index into</span><span>
</span><a name="line-93"></a><span>   </span><span class="hs-comment">--         the array (the first element of the array has index</span><span>
</span><a name="line-94"></a><span>   </span><span class="hs-comment">--         @0@).  The following equality holds,</span><span>
</span><a name="line-95"></a><span>   </span><span class="hs-comment">-- </span><span>
</span><a name="line-96"></a><span>   </span><span class="hs-comment">-- &gt; peekElemOff addr idx = IOExts.fixIO $ \result -&gt;</span><span>
</span><a name="line-97"></a><span>   </span><span class="hs-comment">-- &gt;   peek (addr `plusPtr` (idx * sizeOf result))</span><span>
</span><a name="line-98"></a><span>   </span><span class="hs-comment">--</span><span>
</span><a name="line-99"></a><span>   </span><span class="hs-comment">--         Note that this is only a specification, not</span><span>
</span><a name="line-100"></a><span>   </span><span class="hs-comment">--         necessarily the concrete implementation of the</span><span>
</span><a name="line-101"></a><span>   </span><span class="hs-comment">--         function.</span><span>
</span><a name="line-102"></a><span>
</span><a name="line-103"></a><span>   </span><a name="pokeElemOff"><a href="Foreign.Storable.html#pokeElemOff"><span class="hs-identifier">pokeElemOff</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><a href="GHC.Ptr.html#Ptr"><span class="hs-identifier hs-type">Ptr</span></a><span> </span><a href="#local-6989586621679090510"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../ghc-prim-0.5.2.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Types.html#Int"><span class="hs-identifier hs-type">Int</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679090510"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../ghc-prim-0.5.2.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Types.html#IO"><span class="hs-identifier hs-type">IO</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-104"></a><span>   </span><span class="hs-comment">-- ^       Write a value to a memory area regarded as an array of</span><span>
</span><a name="line-105"></a><span>   </span><span class="hs-comment">--         values of the same kind.  The following equality holds:</span><span>
</span><a name="line-106"></a><span>   </span><span class="hs-comment">-- </span><span>
</span><a name="line-107"></a><span>   </span><span class="hs-comment">-- &gt; pokeElemOff addr idx x = </span><span>
</span><a name="line-108"></a><span>   </span><span class="hs-comment">-- &gt;   poke (addr `plusPtr` (idx * sizeOf x)) x</span><span>
</span><a name="line-109"></a><span>
</span><a name="line-110"></a><span>   </span><a name="peekByteOff"><a href="Foreign.Storable.html#peekByteOff"><span class="hs-identifier">peekByteOff</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><a href="GHC.Ptr.html#Ptr"><span class="hs-identifier hs-type">Ptr</span></a><span> </span><a href="#local-6989586621679090511"><span class="hs-identifier hs-type">b</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../ghc-prim-0.5.2.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Types.html#Int"><span class="hs-identifier hs-type">Int</span></a><span>      </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../ghc-prim-0.5.2.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Types.html#IO"><span class="hs-identifier hs-type">IO</span></a><span> </span><a href="#local-6989586621679090510"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-111"></a><span>   </span><span class="hs-comment">-- ^       Read a value from a memory location given by a base</span><span>
</span><a name="line-112"></a><span>   </span><span class="hs-comment">--         address and offset.  The following equality holds:</span><span>
</span><a name="line-113"></a><span>   </span><span class="hs-comment">--</span><span>
</span><a name="line-114"></a><span>   </span><span class="hs-comment">-- &gt; peekByteOff addr off = peek (addr `plusPtr` off)</span><span>
</span><a name="line-115"></a><span>
</span><a name="line-116"></a><span>   </span><a name="pokeByteOff"><a href="Foreign.Storable.html#pokeByteOff"><span class="hs-identifier">pokeByteOff</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><a href="GHC.Ptr.html#Ptr"><span class="hs-identifier hs-type">Ptr</span></a><span> </span><a href="#local-6989586621679090512"><span class="hs-identifier hs-type">b</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../ghc-prim-0.5.2.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Types.html#Int"><span class="hs-identifier hs-type">Int</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679090510"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../ghc-prim-0.5.2.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Types.html#IO"><span class="hs-identifier hs-type">IO</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-117"></a><span>   </span><span class="hs-comment">-- ^       Write a value to a memory location given by a base</span><span>
</span><a name="line-118"></a><span>   </span><span class="hs-comment">--         address and offset.  The following equality holds:</span><span>
</span><a name="line-119"></a><span>   </span><span class="hs-comment">--</span><span>
</span><a name="line-120"></a><span>   </span><span class="hs-comment">-- &gt; pokeByteOff addr off x = poke (addr `plusPtr` off) x</span><span>
</span><a name="line-121"></a><span>
</span><a name="line-122"></a><span>   </span><a name="peek"><a href="Foreign.Storable.html#peek"><span class="hs-identifier">peek</span></a></a><span>        </span><span class="hs-glyph">::</span><span> </span><a href="GHC.Ptr.html#Ptr"><span class="hs-identifier hs-type">Ptr</span></a><span> </span><a href="#local-6989586621679090510"><span class="hs-identifier hs-type">a</span></a><span>      </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../ghc-prim-0.5.2.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Types.html#IO"><span class="hs-identifier hs-type">IO</span></a><span> </span><a href="#local-6989586621679090510"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-123"></a><span>   </span><span class="hs-comment">-- ^ Read a value from the given memory location.</span><span>
</span><a name="line-124"></a><span>   </span><span class="hs-comment">--</span><span>
</span><a name="line-125"></a><span>   </span><span class="hs-comment">--  Note that the peek and poke functions might require properly</span><span>
</span><a name="line-126"></a><span>   </span><span class="hs-comment">--  aligned addresses to function correctly.  This is architecture</span><span>
</span><a name="line-127"></a><span>   </span><span class="hs-comment">--  dependent; thus, portable code should ensure that when peeking or</span><span>
</span><a name="line-128"></a><span>   </span><span class="hs-comment">--  poking values of some type @a@, the alignment</span><span>
</span><a name="line-129"></a><span>   </span><span class="hs-comment">--  constraint for @a@, as given by the function</span><span>
</span><a name="line-130"></a><span>   </span><span class="hs-comment">--  'alignment' is fulfilled.</span><span>
</span><a name="line-131"></a><span>
</span><a name="line-132"></a><span>   </span><a name="poke"><a href="Foreign.Storable.html#poke"><span class="hs-identifier">poke</span></a></a><span>        </span><span class="hs-glyph">::</span><span> </span><a href="GHC.Ptr.html#Ptr"><span class="hs-identifier hs-type">Ptr</span></a><span> </span><a href="#local-6989586621679090510"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679090510"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../ghc-prim-0.5.2.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Types.html#IO"><span class="hs-identifier hs-type">IO</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-133"></a><span>   </span><span class="hs-comment">-- ^ Write the given value to the given memory location.  Alignment</span><span>
</span><a name="line-134"></a><span>   </span><span class="hs-comment">-- restrictions might apply; see 'peek'.</span><span>
</span><a name="line-135"></a><span>
</span><a name="line-136"></a><span>   </span><span class="hs-comment">-- circular default instances</span><span>
</span><a name="line-137"></a><span>   </span><a name="local-8214565720323865413"><a href="Foreign.Storable.html#peekElemOff"><span class="hs-identifier">peekElemOff</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679090513"><span class="hs-identifier hs-var">peekElemOff_</span></a><span> </span><a href="GHC.Err.html#undefined"><span class="hs-identifier hs-var">undefined</span></a><span>
</span><a name="line-138"></a><span>      </span><span class="hs-keyword">where</span><span> </span><span class="hs-identifier">peekElemOff_</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="#local-6989586621679090510"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="GHC.Ptr.html#Ptr"><span class="hs-identifier hs-type">Ptr</span></a><span> </span><a href="#local-6989586621679090510"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../ghc-prim-0.5.2.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Types.html#Int"><span class="hs-identifier hs-type">Int</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../ghc-prim-0.5.2.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Types.html#IO"><span class="hs-identifier hs-type">IO</span></a><span> </span><a href="#local-6989586621679090510"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-139"></a><span>            </span><a name="local-6989586621679090513"><a href="#local-6989586621679090513"><span class="hs-identifier">peekElemOff_</span></a></a><span> </span><a name="local-6989586621679090514"><a href="#local-6989586621679090514"><span class="hs-identifier">undef</span></a></a><span> </span><a name="local-6989586621679090515"><a href="#local-6989586621679090515"><span class="hs-identifier">ptr</span></a></a><span> </span><a name="local-6989586621679090516"><a href="#local-6989586621679090516"><span class="hs-identifier">off</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Foreign.Storable.html#peekByteOff"><span class="hs-identifier hs-var">peekByteOff</span></a><span> </span><a href="#local-6989586621679090515"><span class="hs-identifier hs-var">ptr</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679090516"><span class="hs-identifier hs-var">off</span></a><span> </span><a href="GHC.Num.html#%2A"><span class="hs-operator hs-var">*</span></a><span> </span><a href="Foreign.Storable.html#sizeOf"><span class="hs-identifier hs-var">sizeOf</span></a><span> </span><a href="#local-6989586621679090514"><span class="hs-identifier hs-var">undef</span></a><span class="hs-special">)</span><span>
</span><a name="line-140"></a><span>   </span><a name="local-8214565720323865414"><a href="Foreign.Storable.html#pokeElemOff"><span class="hs-identifier">pokeElemOff</span></a></a><span> </span><a name="local-6989586621679090517"><a href="#local-6989586621679090517"><span class="hs-identifier">ptr</span></a></a><span> </span><a name="local-6989586621679090518"><a href="#local-6989586621679090518"><span class="hs-identifier">off</span></a></a><span> </span><a name="local-6989586621679090519"><a href="#local-6989586621679090519"><span class="hs-identifier">val</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Foreign.Storable.html#pokeByteOff"><span class="hs-identifier hs-var">pokeByteOff</span></a><span> </span><a href="#local-6989586621679090517"><span class="hs-identifier hs-var">ptr</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679090518"><span class="hs-identifier hs-var">off</span></a><span> </span><a href="GHC.Num.html#%2A"><span class="hs-operator hs-var">*</span></a><span> </span><a href="Foreign.Storable.html#sizeOf"><span class="hs-identifier hs-var">sizeOf</span></a><span> </span><a href="#local-6989586621679090519"><span class="hs-identifier hs-var">val</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679090519"><span class="hs-identifier hs-var">val</span></a><span>
</span><a name="line-141"></a><span>
</span><a name="line-142"></a><span>   </span><a name="local-8214565720323865415"><a href="Foreign.Storable.html#peekByteOff"><span class="hs-identifier">peekByteOff</span></a></a><span> </span><a name="local-6989586621679090520"><a href="#local-6989586621679090520"><span class="hs-identifier">ptr</span></a></a><span> </span><a name="local-6989586621679090521"><a href="#local-6989586621679090521"><span class="hs-identifier">off</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Foreign.Storable.html#peek"><span class="hs-identifier hs-var">peek</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679090520"><span class="hs-identifier hs-var">ptr</span></a><span> </span><span class="hs-special">`</span><a href="GHC.Ptr.html#plusPtr"><span class="hs-identifier hs-var">plusPtr</span></a><span class="hs-special">`</span><span> </span><a href="#local-6989586621679090521"><span class="hs-identifier hs-var">off</span></a><span class="hs-special">)</span><span>
</span><a name="line-143"></a><span>   </span><a name="local-8214565720323865416"><a href="Foreign.Storable.html#pokeByteOff"><span class="hs-identifier">pokeByteOff</span></a></a><span> </span><a name="local-6989586621679090522"><a href="#local-6989586621679090522"><span class="hs-identifier">ptr</span></a></a><span> </span><a name="local-6989586621679090523"><a href="#local-6989586621679090523"><span class="hs-identifier">off</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Foreign.Storable.html#poke"><span class="hs-identifier hs-var">poke</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679090522"><span class="hs-identifier hs-var">ptr</span></a><span> </span><span class="hs-special">`</span><a href="GHC.Ptr.html#plusPtr"><span class="hs-identifier hs-var">plusPtr</span></a><span class="hs-special">`</span><span> </span><a href="#local-6989586621679090523"><span class="hs-identifier hs-var">off</span></a><span class="hs-special">)</span><span>
</span><a name="line-144"></a><span>
</span><a name="line-145"></a><span>   </span><a name="local-8214565720323865417"><a href="Foreign.Storable.html#peek"><span class="hs-identifier">peek</span></a></a><span> </span><a name="local-6989586621679090524"><a href="#local-6989586621679090524"><span class="hs-identifier">ptr</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Foreign.Storable.html#peekElemOff"><span class="hs-identifier hs-var">peekElemOff</span></a><span> </span><a href="#local-6989586621679090524"><span class="hs-identifier hs-var">ptr</span></a><span> </span><span class="hs-number">0</span><span>
</span><a name="line-146"></a><span>   </span><a name="local-8214565720323865418"><a href="Foreign.Storable.html#poke"><span class="hs-identifier">poke</span></a></a><span> </span><a name="local-6989586621679090525"><a href="#local-6989586621679090525"><span class="hs-identifier">ptr</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Foreign.Storable.html#pokeElemOff"><span class="hs-identifier hs-var">pokeElemOff</span></a><span> </span><a href="#local-6989586621679090525"><span class="hs-identifier hs-var">ptr</span></a><span> </span><span class="hs-number">0</span><span>
</span><a name="line-147"></a><span>
</span><a name="line-148"></a><span class="hs-comment">-- | @since 4.9.0.0</span><span>
</span><a name="line-149"></a><span class="hs-keyword">instance</span><span> </span><a href="Foreign.Storable.html#Storable"><span class="hs-identifier hs-type">Storable</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-150"></a><span>  </span><a name="local-8214565720323865411"><a href="Foreign.Storable.html#sizeOf"><span class="hs-identifier">sizeOf</span></a></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-number">0</span><span>
</span><a name="line-151"></a><span>  </span><a name="local-8214565720323865412"><a href="Foreign.Storable.html#alignment"><span class="hs-identifier">alignment</span></a></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-number">1</span><span>
</span><a name="line-152"></a><span>  </span><a name="local-8214565720323865417"><a href="Foreign.Storable.html#peek"><span class="hs-identifier">peek</span></a></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-153"></a><span>  </span><a name="local-8214565720323865418"><a href="Foreign.Storable.html#poke"><span class="hs-identifier">poke</span></a></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-154"></a><span>
</span><a name="line-155"></a><span class="hs-comment">-- System-dependent, but rather obvious instances</span><span>
</span><a name="line-156"></a><span>
</span><a name="line-157"></a><span class="hs-comment">-- | @since 2.01</span><span>
</span><a name="line-158"></a><span class="hs-keyword">instance</span><span> </span><a href="Foreign.Storable.html#Storable"><span class="hs-identifier hs-type">Storable</span></a><span> </span><a href="../ghc-prim-0.5.2.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Types.html#Bool"><span class="hs-identifier hs-type">Bool</span></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-159"></a><span>   </span><a name="local-8214565720323865411"><a href="Foreign.Storable.html#sizeOf"><span class="hs-identifier">sizeOf</span></a></a><span> </span><span class="hs-identifier">_</span><span>          </span><span class="hs-glyph">=</span><span> </span><a href="Foreign.Storable.html#sizeOf"><span class="hs-identifier hs-var">sizeOf</span></a><span> </span><span class="hs-special">(</span><a href="GHC.Err.html#undefined"><span class="hs-identifier hs-var">undefined</span></a><span class="hs-glyph">::</span><span class="hs-identifier">HTYPE_INT</span><span class="hs-special">)</span><span>
</span><a name="line-160"></a><span>   </span><a name="local-8214565720323865412"><a href="Foreign.Storable.html#alignment"><span class="hs-identifier">alignment</span></a></a><span> </span><span class="hs-identifier">_</span><span>       </span><span class="hs-glyph">=</span><span> </span><a href="Foreign.Storable.html#alignment"><span class="hs-identifier hs-var">alignment</span></a><span> </span><span class="hs-special">(</span><a href="GHC.Err.html#undefined"><span class="hs-identifier hs-var">undefined</span></a><span class="hs-glyph">::</span><span class="hs-identifier">HTYPE_INT</span><span class="hs-special">)</span><span>
</span><a name="line-161"></a><span>   </span><a name="local-8214565720323865413"><a href="Foreign.Storable.html#peekElemOff"><span class="hs-identifier">peekElemOff</span></a></a><span> </span><a name="local-6989586621679090538"><a href="#local-6989586621679090538"><span class="hs-identifier">p</span></a></a><span> </span><a name="local-6989586621679090539"><a href="#local-6989586621679090539"><span class="hs-identifier">i</span></a></a><span>   </span><span class="hs-glyph">=</span><span> </span><a href="GHC.Base.html#liftM"><span class="hs-identifier hs-var">liftM</span></a><span> </span><span class="hs-special">(</span><a href="../ghc-prim-0.5.2.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Classes.html#%2F%3D"><span class="hs-operator hs-var">/=</span></a><span> </span><span class="hs-special">(</span><span class="hs-number">0</span><span class="hs-glyph">::</span><span class="hs-identifier">HTYPE_INT</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><a href="Foreign.Storable.html#peekElemOff"><span class="hs-operator hs-var">$</span></a><span> </span><span class="hs-identifier">peekElemOff</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">castPtr</span><span> </span><span class="hs-identifier">p</span><span class="hs-special">)</span><span> </span><span class="hs-identifier">i</span><span>
</span><a name="line-162"></a><span>   </span><a name="local-8214565720323865414"><a href="Foreign.Storable.html#pokeElemOff"><span class="hs-identifier">pokeElemOff</span></a></a><span> </span><a name="local-6989586621679090540"><a href="#local-6989586621679090540"><span class="hs-identifier">p</span></a></a><span> </span><a name="local-6989586621679090541"><a href="#local-6989586621679090541"><span class="hs-identifier">i</span></a></a><span> </span><a name="local-6989586621679090542"><a href="#local-6989586621679090542"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Foreign.Storable.html#pokeElemOff"><span class="hs-identifier hs-var">pokeElemOff</span></a><span> </span><span class="hs-special">(</span><a href="GHC.Ptr.html#castPtr"><span class="hs-identifier hs-var">castPtr</span></a><span> </span><a href="#local-6989586621679090540"><span class="hs-identifier hs-var">p</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679090541"><span class="hs-identifier hs-var">i</span></a><span> </span><span class="hs-special">(</span><span class="hs-keyword">if</span><span> </span><a href="#local-6989586621679090542"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-keyword">then</span><span> </span><span class="hs-number">1</span><span> </span><span class="hs-keyword">else</span><span> </span><span class="hs-number">0</span><span class="hs-glyph">::</span><span class="hs-identifier">HTYPE_INT</span><span class="hs-special">)</span><span>
</span><a name="line-163"></a><span>
</span><a name="line-164"></a><span class="hs-cpp">#define STORABLE(T,size,align,read,write)       \
instance Storable (T) where {                   \
    sizeOf    _ = size;                         \
    alignment _ = align;                        \
    peekElemOff = read;                         \
    pokeElemOff = write }
</span><span>
</span><a name="line-171"></a><span class="hs-comment">-- | @since 2.01</span><span>
</span><a name="line-172"></a><span class="hs-identifier">STORABLE</span><span class="hs-special">(</span><a href="Foreign.Storable.html#Storable"><span class="hs-identifier hs-type">Char</span></a><span class="hs-special">,</span><span class="hs-identifier">SIZEOF_INT32</span><span class="hs-special">,</span><span class="hs-identifier">ALIGNMENT_INT32</span><span class="hs-special">,</span><span>
</span><a name="line-173"></a><span>         </span><span class="hs-identifier">readWideCharOffPtr</span><span class="hs-special">,</span><span class="hs-identifier">writeWideCharOffPtr</span><span class="hs-special">)</span><span>
</span><a name="line-174"></a><span>
</span><a name="line-175"></a><span class="hs-comment">-- | @since 2.01</span><span>
</span><a name="line-176"></a><span class="hs-identifier">STORABLE</span><span class="hs-special">(</span><a href="Foreign.Storable.html#Storable"><span class="hs-identifier hs-type">Int</span></a><span class="hs-special">,</span><span class="hs-identifier">SIZEOF_HSINT</span><span class="hs-special">,</span><span class="hs-identifier">ALIGNMENT_HSINT</span><span class="hs-special">,</span><span>
</span><a name="line-177"></a><span>         </span><span class="hs-identifier">readIntOffPtr</span><span class="hs-special">,</span><span class="hs-identifier">writeIntOffPtr</span><span class="hs-special">)</span><span>
</span><a name="line-178"></a><span>
</span><a name="line-179"></a><span class="hs-comment">-- | @since 2.01</span><span>
</span><a name="line-180"></a><span class="hs-identifier">STORABLE</span><span class="hs-special">(</span><a href="Foreign.Storable.html#Storable"><span class="hs-identifier hs-type">Word</span></a><span class="hs-special">,</span><span class="hs-identifier">SIZEOF_HSWORD</span><span class="hs-special">,</span><span class="hs-identifier">ALIGNMENT_HSWORD</span><span class="hs-special">,</span><span>
</span><a name="line-181"></a><span>         </span><span class="hs-identifier">readWordOffPtr</span><span class="hs-special">,</span><span class="hs-identifier">writeWordOffPtr</span><span class="hs-special">)</span><span>
</span><a name="line-182"></a><span>
</span><a name="line-183"></a><span class="hs-comment">-- | @since 2.01</span><span>
</span><a name="line-184"></a><span class="hs-identifier">STORABLE</span><span class="hs-special">(</span><span class="hs-special">(</span><a href="Foreign.Storable.html#Storable"><span class="hs-identifier hs-type">Ptr</span></a><span> </span><a href="Foreign.Storable.html#Storable"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span class="hs-special">,</span><span class="hs-identifier">SIZEOF_HSPTR</span><span class="hs-special">,</span><span class="hs-identifier">ALIGNMENT_HSPTR</span><span class="hs-special">,</span><span>
</span><a name="line-185"></a><span>         </span><span class="hs-identifier">readPtrOffPtr</span><span class="hs-special">,</span><span class="hs-identifier">writePtrOffPtr</span><span class="hs-special">)</span><span>
</span><a name="line-186"></a><span>
</span><a name="line-187"></a><span class="hs-comment">-- | @since 2.01</span><span>
</span><a name="line-188"></a><span class="hs-identifier">STORABLE</span><span class="hs-special">(</span><span class="hs-special">(</span><a href="Foreign.Storable.html#Storable"><span class="hs-identifier hs-type">FunPtr</span></a><span> </span><span class="hs-identifier">a</span><span class="hs-special">)</span><span class="hs-special">,</span><span class="hs-identifier">SIZEOF_HSFUNPTR</span><span class="hs-special">,</span><span class="hs-identifier">ALIGNMENT_HSFUNPTR</span><span class="hs-special">,</span><span>
</span><a name="line-189"></a><span>         </span><span class="hs-identifier">readFunPtrOffPtr</span><span class="hs-special">,</span><span class="hs-identifier">writeFunPtrOffPtr</span><span class="hs-special">)</span><span>
</span><a name="line-190"></a><span>
</span><a name="line-191"></a><span class="hs-comment">-- | @since 2.01</span><span>
</span><a name="line-192"></a><span class="hs-identifier">STORABLE</span><span class="hs-special">(</span><span class="hs-special">(</span><span class="hs-identifier">StablePtr</span><span> </span><a href="GHC.Stable.html#StablePtr"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span class="hs-special">,</span><span class="hs-identifier">SIZEOF_HSSTABLEPTR</span><span class="hs-special">,</span><span class="hs-identifier">ALIGNMENT_HSSTABLEPTR</span><span class="hs-special">,</span><span>
</span><a name="line-193"></a><span>         </span><span class="hs-identifier">readStablePtrOffPtr</span><span class="hs-special">,</span><span class="hs-identifier">writeStablePtrOffPtr</span><span class="hs-special">)</span><span>
</span><a name="line-194"></a><span>
</span><a name="line-195"></a><span class="hs-comment">-- | @since 2.01</span><span>
</span><a name="line-196"></a><span class="hs-identifier">STORABLE</span><span class="hs-special">(</span><a href="Foreign.Storable.html#Storable"><span class="hs-identifier hs-type">Float</span></a><span class="hs-special">,</span><span class="hs-identifier">SIZEOF_HSFLOAT</span><span class="hs-special">,</span><span class="hs-identifier">ALIGNMENT_HSFLOAT</span><span class="hs-special">,</span><span>
</span><a name="line-197"></a><span>         </span><span class="hs-identifier">readFloatOffPtr</span><span class="hs-special">,</span><span class="hs-identifier">writeFloatOffPtr</span><span class="hs-special">)</span><span>
</span><a name="line-198"></a><span>
</span><a name="line-199"></a><span class="hs-comment">-- | @since 2.01</span><span>
</span><a name="line-200"></a><span class="hs-identifier">STORABLE</span><span class="hs-special">(</span><a href="Foreign.Storable.html#Storable"><span class="hs-identifier hs-type">Double</span></a><span class="hs-special">,</span><span class="hs-identifier">SIZEOF_HSDOUBLE</span><span class="hs-special">,</span><span class="hs-identifier">ALIGNMENT_HSDOUBLE</span><span class="hs-special">,</span><span>
</span><a name="line-201"></a><span>         </span><span class="hs-identifier">readDoubleOffPtr</span><span class="hs-special">,</span><span class="hs-identifier">writeDoubleOffPtr</span><span class="hs-special">)</span><span>
</span><a name="line-202"></a><span>
</span><a name="line-203"></a><span class="hs-comment">-- | @since 2.01</span><span>
</span><a name="line-204"></a><span class="hs-identifier">STORABLE</span><span class="hs-special">(</span><a href="Foreign.Storable.html#Storable"><span class="hs-identifier hs-type">Word8</span></a><span class="hs-special">,</span><span class="hs-identifier">SIZEOF_WORD8</span><span class="hs-special">,</span><span class="hs-identifier">ALIGNMENT_WORD8</span><span class="hs-special">,</span><span>
</span><a name="line-205"></a><span>         </span><span class="hs-identifier">readWord8OffPtr</span><span class="hs-special">,</span><span class="hs-identifier">writeWord8OffPtr</span><span class="hs-special">)</span><span>
</span><a name="line-206"></a><span>
</span><a name="line-207"></a><span class="hs-comment">-- | @since 2.01</span><span>
</span><a name="line-208"></a><span class="hs-identifier">STORABLE</span><span class="hs-special">(</span><a href="Foreign.Storable.html#Storable"><span class="hs-identifier hs-type">Word16</span></a><span class="hs-special">,</span><span class="hs-identifier">SIZEOF_WORD16</span><span class="hs-special">,</span><span class="hs-identifier">ALIGNMENT_WORD16</span><span class="hs-special">,</span><span>
</span><a name="line-209"></a><span>         </span><span class="hs-identifier">readWord16OffPtr</span><span class="hs-special">,</span><span class="hs-identifier">writeWord16OffPtr</span><span class="hs-special">)</span><span>
</span><a name="line-210"></a><span>
</span><a name="line-211"></a><span class="hs-comment">-- | @since 2.01</span><span>
</span><a name="line-212"></a><span class="hs-identifier">STORABLE</span><span class="hs-special">(</span><a href="Foreign.Storable.html#Storable"><span class="hs-identifier hs-type">Word32</span></a><span class="hs-special">,</span><span class="hs-identifier">SIZEOF_WORD32</span><span class="hs-special">,</span><span class="hs-identifier">ALIGNMENT_WORD32</span><span class="hs-special">,</span><span>
</span><a name="line-213"></a><span>         </span><span class="hs-identifier">readWord32OffPtr</span><span class="hs-special">,</span><span class="hs-identifier">writeWord32OffPtr</span><span class="hs-special">)</span><span>
</span><a name="line-214"></a><span>
</span><a name="line-215"></a><span class="hs-comment">-- | @since 2.01</span><span>
</span><a name="line-216"></a><span class="hs-identifier">STORABLE</span><span class="hs-special">(</span><a href="Foreign.Storable.html#Storable"><span class="hs-identifier hs-type">Word64</span></a><span class="hs-special">,</span><span class="hs-identifier">SIZEOF_WORD64</span><span class="hs-special">,</span><span class="hs-identifier">ALIGNMENT_WORD64</span><span class="hs-special">,</span><span>
</span><a name="line-217"></a><span>         </span><span class="hs-identifier">readWord64OffPtr</span><span class="hs-special">,</span><span class="hs-identifier">writeWord64OffPtr</span><span class="hs-special">)</span><span>
</span><a name="line-218"></a><span>
</span><a name="line-219"></a><span class="hs-comment">-- | @since 2.01</span><span>
</span><a name="line-220"></a><span class="hs-identifier">STORABLE</span><span class="hs-special">(</span><a href="Foreign.Storable.html#Storable"><span class="hs-identifier hs-type">Int8</span></a><span class="hs-special">,</span><span class="hs-identifier">SIZEOF_INT8</span><span class="hs-special">,</span><span class="hs-identifier">ALIGNMENT_INT8</span><span class="hs-special">,</span><span>
</span><a name="line-221"></a><span>         </span><span class="hs-identifier">readInt8OffPtr</span><span class="hs-special">,</span><span class="hs-identifier">writeInt8OffPtr</span><span class="hs-special">)</span><span>
</span><a name="line-222"></a><span>
</span><a name="line-223"></a><span class="hs-comment">-- | @since 2.01</span><span>
</span><a name="line-224"></a><span class="hs-identifier">STORABLE</span><span class="hs-special">(</span><a href="Foreign.Storable.html#Storable"><span class="hs-identifier hs-type">Int16</span></a><span class="hs-special">,</span><span class="hs-identifier">SIZEOF_INT16</span><span class="hs-special">,</span><span class="hs-identifier">ALIGNMENT_INT16</span><span class="hs-special">,</span><span>
</span><a name="line-225"></a><span>         </span><span class="hs-identifier">readInt16OffPtr</span><span class="hs-special">,</span><span class="hs-identifier">writeInt16OffPtr</span><span class="hs-special">)</span><span>
</span><a name="line-226"></a><span>
</span><a name="line-227"></a><span class="hs-comment">-- | @since 2.01</span><span>
</span><a name="line-228"></a><span class="hs-identifier">STORABLE</span><span class="hs-special">(</span><a href="Foreign.Storable.html#Storable"><span class="hs-identifier hs-type">Int32</span></a><span class="hs-special">,</span><span class="hs-identifier">SIZEOF_INT32</span><span class="hs-special">,</span><span class="hs-identifier">ALIGNMENT_INT32</span><span class="hs-special">,</span><span>
</span><a name="line-229"></a><span>         </span><span class="hs-identifier">readInt32OffPtr</span><span class="hs-special">,</span><span class="hs-identifier">writeInt32OffPtr</span><span class="hs-special">)</span><span>
</span><a name="line-230"></a><span>
</span><a name="line-231"></a><span class="hs-comment">-- | @since 2.01</span><span>
</span><a name="line-232"></a><span class="hs-identifier">STORABLE</span><span class="hs-special">(</span><a href="Foreign.Storable.html#Storable"><span class="hs-identifier hs-type">Int64</span></a><span class="hs-special">,</span><span class="hs-identifier">SIZEOF_INT64</span><span class="hs-special">,</span><span class="hs-identifier">ALIGNMENT_INT64</span><span class="hs-special">,</span><span>
</span><a name="line-233"></a><span>         </span><span class="hs-identifier">readInt64OffPtr</span><span class="hs-special">,</span><span class="hs-identifier">writeInt64OffPtr</span><span class="hs-special">)</span><span>
</span><a name="line-234"></a><span>
</span><a name="line-235"></a><span class="hs-comment">-- | @since 4.8.0.0</span><span>
</span><a name="line-236"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-special">(</span><a href="Foreign.Storable.html#Storable"><span class="hs-identifier hs-type">Storable</span></a><span> </span><a href="#local-6989586621679090526"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">,</span><span> </span><a href="GHC.Real.html#Integral"><span class="hs-identifier hs-type">Integral</span></a><span> </span><a href="#local-6989586621679090526"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="Foreign.Storable.html#Storable"><span class="hs-identifier hs-type">Storable</span></a><span> </span><span class="hs-special">(</span><a href="GHC.Real.html#Ratio"><span class="hs-identifier hs-type">Ratio</span></a><span> </span><a href="#local-6989586621679090526"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-237"></a><span>    </span><a name="local-8214565720323865411"><a href="Foreign.Storable.html#sizeOf"><span class="hs-identifier">sizeOf</span></a></a><span> </span><span class="hs-identifier">_</span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="hs-number">2</span><span> </span><a href="GHC.Num.html#%2A"><span class="hs-operator hs-var">*</span></a><span> </span><a href="Foreign.Storable.html#sizeOf"><span class="hs-identifier hs-var">sizeOf</span></a><span> </span><span class="hs-special">(</span><a href="GHC.Err.html#undefined"><span class="hs-identifier hs-var">undefined</span></a><span> </span><span class="hs-glyph">::</span><span> </span><a href="#local-6989586621679090526"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span>
</span><a name="line-238"></a><span>    </span><a name="local-8214565720323865412"><a href="Foreign.Storable.html#alignment"><span class="hs-identifier">alignment</span></a></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Foreign.Storable.html#alignment"><span class="hs-identifier hs-var">alignment</span></a><span> </span><span class="hs-special">(</span><a href="GHC.Err.html#undefined"><span class="hs-identifier hs-var">undefined</span></a><span> </span><span class="hs-glyph">::</span><span> </span><a href="#local-6989586621679090526"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-special">)</span><span>
</span><a name="line-239"></a><span>    </span><a name="local-8214565720323865417"><a href="Foreign.Storable.html#peek"><span class="hs-identifier">peek</span></a></a><span> </span><a name="local-6989586621679090527"><a href="#local-6989586621679090527"><span class="hs-identifier">p</span></a></a><span>           </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-240"></a><span>                        </span><a name="local-6989586621679090528"><a href="#local-6989586621679090528"><span class="hs-identifier">q</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><a href="GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span> </span><a href="GHC.Ptr.html#castPtr"><span class="hs-identifier hs-var">castPtr</span></a><span> </span><a href="#local-6989586621679090527"><span class="hs-identifier hs-var">p</span></a><span>
</span><a name="line-241"></a><span>                        </span><a name="local-6989586621679090529"><a href="#local-6989586621679090529"><span class="hs-identifier">r</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Foreign.Storable.html#peek"><span class="hs-identifier hs-var">peek</span></a><span> </span><a href="#local-6989586621679090528"><span class="hs-identifier hs-var">q</span></a><span>
</span><a name="line-242"></a><span>                        </span><a name="local-6989586621679090530"><a href="#local-6989586621679090530"><span class="hs-identifier">i</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Foreign.Storable.html#peekElemOff"><span class="hs-identifier hs-var">peekElemOff</span></a><span> </span><a href="#local-6989586621679090528"><span class="hs-identifier hs-var">q</span></a><span> </span><span class="hs-number">1</span><span>
</span><a name="line-243"></a><span>                        </span><a href="GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679090529"><span class="hs-identifier hs-var">r</span></a><span> </span><a href="GHC.Real.html#%25"><span class="hs-operator hs-var">%</span></a><span> </span><a href="#local-6989586621679090530"><span class="hs-identifier hs-var">i</span></a><span class="hs-special">)</span><span>
</span><a name="line-244"></a><span>    </span><a name="local-8214565720323865418"><a href="Foreign.Storable.html#poke"><span class="hs-identifier">poke</span></a></a><span> </span><a name="local-6989586621679090531"><a href="#local-6989586621679090531"><span class="hs-identifier">p</span></a></a><span> </span><span class="hs-special">(</span><a name="local-6989586621679090532"><a href="#local-6989586621679090532"><span class="hs-identifier">r</span></a></a><span> </span><a href="GHC.Real.html#%3A%25"><span class="hs-operator hs-var">:%</span></a><span> </span><a name="local-6989586621679090533"><a href="#local-6989586621679090533"><span class="hs-identifier">i</span></a></a><span class="hs-special">)</span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-245"></a><span>                        </span><a name="local-6989586621679090534"><a href="#local-6989586621679090534"><span class="hs-identifier">q</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><a href="GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><a href="GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span>  </span><span class="hs-special">(</span><a href="GHC.Ptr.html#castPtr"><span class="hs-identifier hs-var">castPtr</span></a><span> </span><a href="#local-6989586621679090531"><span class="hs-identifier hs-var">p</span></a><span class="hs-special">)</span><span>
</span><a name="line-246"></a><span>                        </span><a href="Foreign.Storable.html#poke"><span class="hs-identifier hs-var">poke</span></a><span> </span><a href="#local-6989586621679090534"><span class="hs-identifier hs-var">q</span></a><span> </span><a href="#local-6989586621679090532"><span class="hs-identifier hs-var">r</span></a><span>
</span><a name="line-247"></a><span>                        </span><a href="Foreign.Storable.html#pokeElemOff"><span class="hs-identifier hs-var">pokeElemOff</span></a><span> </span><a href="#local-6989586621679090534"><span class="hs-identifier hs-var">q</span></a><span> </span><span class="hs-number">1</span><span> </span><a href="#local-6989586621679090533"><span class="hs-identifier hs-var">i</span></a><span>
</span><a name="line-248"></a><span>
</span><a name="line-249"></a><span class="hs-comment">-- XXX: here to avoid orphan instance in GHC.Fingerprint</span><span>
</span><a name="line-250"></a><span class="hs-comment">-- | @since 4.4.0.0</span><span>
</span><a name="line-251"></a><span class="hs-keyword">instance</span><span> </span><a href="Foreign.Storable.html#Storable"><span class="hs-identifier hs-type">Storable</span></a><span> </span><a href="GHC.Fingerprint.Type.html#Fingerprint"><span class="hs-identifier hs-type">Fingerprint</span></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-252"></a><span>  </span><a name="local-8214565720323865411"><a href="Foreign.Storable.html#sizeOf"><span class="hs-identifier">sizeOf</span></a></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-number">16</span><span>
</span><a name="line-253"></a><span>  </span><a name="local-8214565720323865412"><a href="Foreign.Storable.html#alignment"><span class="hs-identifier">alignment</span></a></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-number">8</span><span>
</span><a name="line-254"></a><span>  </span><a name="local-8214565720323865417"><a href="Foreign.Storable.html#peek"><span class="hs-identifier">peek</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Foreign.Storable.html#peekFingerprint"><span class="hs-identifier hs-var">peekFingerprint</span></a><span>
</span><a name="line-255"></a><span>  </span><a name="local-8214565720323865418"><a href="Foreign.Storable.html#poke"><span class="hs-identifier">poke</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Foreign.Storable.html#pokeFingerprint"><span class="hs-identifier hs-var">pokeFingerprint</span></a><span>
</span><a name="line-256"></a><span>
</span><a name="line-257"></a><span class="hs-comment">-- peek/poke in fixed BIG-endian 128-bit format</span><span>
</span><a name="line-258"></a><span class="hs-identifier">peekFingerprint</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="GHC.Ptr.html#Ptr"><span class="hs-identifier hs-type">Ptr</span></a><span> </span><a href="GHC.Fingerprint.Type.html#Fingerprint"><span class="hs-identifier hs-type">Fingerprint</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../ghc-prim-0.5.2.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Types.html#IO"><span class="hs-identifier hs-type">IO</span></a><span> </span><a href="GHC.Fingerprint.Type.html#Fingerprint"><span class="hs-identifier hs-type">Fingerprint</span></a><span>
</span><a name="line-259"></a><a name="peekFingerprint"><a href="Foreign.Storable.html#peekFingerprint"><span class="hs-identifier">peekFingerprint</span></a></a><span> </span><a name="local-6989586621679090543"><a href="#local-6989586621679090543"><span class="hs-identifier">p0</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-260"></a><span>      </span><span class="hs-keyword">let</span><span> </span><span class="hs-identifier">peekW64</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="GHC.Ptr.html#Ptr"><span class="hs-identifier hs-type">Ptr</span></a><span> </span><a href="GHC.Word.html#Word8"><span class="hs-identifier hs-type">Word8</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../ghc-prim-0.5.2.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Types.html#Int"><span class="hs-identifier hs-type">Int</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="GHC.Word.html#Word64"><span class="hs-identifier hs-type">Word64</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../ghc-prim-0.5.2.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Types.html#IO"><span class="hs-identifier hs-type">IO</span></a><span> </span><a href="GHC.Word.html#Word64"><span class="hs-identifier hs-type">Word64</span></a><span>
</span><a name="line-261"></a><span>          </span><a name="local-6989586621679090544"><a href="#local-6989586621679090544"><span class="hs-identifier">peekW64</span></a></a><span> </span><span class="hs-identifier">_</span><span>  </span><span class="hs-number">0</span><span>  </span><span class="hs-glyph">!</span><a name="local-6989586621679090545"><a href="#local-6989586621679090545"><span class="hs-identifier">i</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><a href="#local-6989586621679090545"><span class="hs-identifier hs-var">i</span></a><span>
</span><a name="line-262"></a><span>          </span><span class="hs-identifier">peekW64</span><span> </span><span class="hs-glyph">!</span><a name="local-6989586621679090546"><a href="#local-6989586621679090546"><span class="hs-identifier">p</span></a></a><span> </span><span class="hs-glyph">!</span><a name="local-6989586621679090547"><a href="#local-6989586621679090547"><span class="hs-identifier">n</span></a></a><span> </span><span class="hs-glyph">!</span><a name="local-6989586621679090548"><a href="#local-6989586621679090548"><span class="hs-identifier">i</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-263"></a><span>                </span><a name="local-6989586621679090549"><a href="#local-6989586621679090549"><span class="hs-identifier">w8</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Foreign.Storable.html#peek"><span class="hs-identifier hs-var">peek</span></a><span> </span><a href="#local-6989586621679090546"><span class="hs-identifier hs-var">p</span></a><span>
</span><a name="line-264"></a><span>                </span><a href="#local-6989586621679090544"><span class="hs-identifier hs-var">peekW64</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679090546"><span class="hs-identifier hs-var">p</span></a><span> </span><span class="hs-special">`</span><a href="GHC.Ptr.html#plusPtr"><span class="hs-identifier hs-var">plusPtr</span></a><span class="hs-special">`</span><span> </span><span class="hs-number">1</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679090547"><span class="hs-identifier hs-var">n</span></a><span class="hs-glyph">-</span><span class="hs-number">1</span><span class="hs-special">)</span><span>
</span><a name="line-265"></a><span>                    </span><span class="hs-special">(</span><span class="hs-special">(</span><a href="#local-6989586621679090548"><span class="hs-identifier hs-var">i</span></a><span> </span><span class="hs-special">`</span><a href="Data.Bits.html#shiftL"><span class="hs-identifier hs-var">shiftL</span></a><span class="hs-special">`</span><span> </span><span class="hs-number">8</span><span class="hs-special">)</span><span> </span><a href="Data.Bits.html#.%7C."><span class="hs-operator hs-var">.|.</span></a><span> </span><a href="GHC.Real.html#fromIntegral"><span class="hs-identifier hs-var">fromIntegral</span></a><span> </span><a href="#local-6989586621679090549"><span class="hs-identifier hs-var">w8</span></a><span class="hs-special">)</span><span>
</span><a name="line-266"></a><span>
</span><a name="line-267"></a><span>      </span><a name="local-6989586621679090550"><a href="#local-6989586621679090550"><span class="hs-identifier">high</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-6989586621679090544"><span class="hs-identifier hs-var">peekW64</span></a><span> </span><span class="hs-special">(</span><a href="GHC.Ptr.html#castPtr"><span class="hs-identifier hs-var">castPtr</span></a><span> </span><a href="#local-6989586621679090543"><span class="hs-identifier hs-var">p0</span></a><span class="hs-special">)</span><span> </span><span class="hs-number">8</span><span> </span><span class="hs-number">0</span><span>
</span><a name="line-268"></a><span>      </span><a name="local-6989586621679090551"><a href="#local-6989586621679090551"><span class="hs-identifier">low</span></a></a><span>  </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-6989586621679090544"><span class="hs-identifier hs-var">peekW64</span></a><span> </span><span class="hs-special">(</span><a href="GHC.Ptr.html#castPtr"><span class="hs-identifier hs-var">castPtr</span></a><span> </span><a href="#local-6989586621679090543"><span class="hs-identifier hs-var">p0</span></a><span> </span><span class="hs-special">`</span><a href="GHC.Ptr.html#plusPtr"><span class="hs-identifier hs-var">plusPtr</span></a><span class="hs-special">`</span><span> </span><span class="hs-number">8</span><span class="hs-special">)</span><span> </span><span class="hs-number">8</span><span> </span><span class="hs-number">0</span><span>
</span><a name="line-269"></a><span>      </span><a href="GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><a href="GHC.Fingerprint.Type.html#Fingerprint"><span class="hs-identifier hs-var">Fingerprint</span></a><span> </span><a href="#local-6989586621679090550"><span class="hs-identifier hs-var">high</span></a><span> </span><a href="#local-6989586621679090551"><span class="hs-identifier hs-var">low</span></a><span class="hs-special">)</span><span>
</span><a name="line-270"></a><span>
</span><a name="line-271"></a><span class="hs-identifier">pokeFingerprint</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="GHC.Ptr.html#Ptr"><span class="hs-identifier hs-type">Ptr</span></a><span> </span><a href="GHC.Fingerprint.Type.html#Fingerprint"><span class="hs-identifier hs-type">Fingerprint</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="GHC.Fingerprint.Type.html#Fingerprint"><span class="hs-identifier hs-type">Fingerprint</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../ghc-prim-0.5.2.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Types.html#IO"><span class="hs-identifier hs-type">IO</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-272"></a><a name="pokeFingerprint"><a href="Foreign.Storable.html#pokeFingerprint"><span class="hs-identifier">pokeFingerprint</span></a></a><span> </span><a name="local-6989586621679090552"><a href="#local-6989586621679090552"><span class="hs-identifier">p0</span></a></a><span> </span><span class="hs-special">(</span><a href="GHC.Fingerprint.Type.html#Fingerprint"><span class="hs-identifier hs-var">Fingerprint</span></a><span> </span><a name="local-6989586621679090553"><a href="#local-6989586621679090553"><span class="hs-identifier">high</span></a></a><span> </span><a name="local-6989586621679090554"><a href="#local-6989586621679090554"><span class="hs-identifier">low</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-273"></a><span>      </span><span class="hs-keyword">let</span><span> </span><span class="hs-identifier">pokeW64</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="GHC.Ptr.html#Ptr"><span class="hs-identifier hs-type">Ptr</span></a><span> </span><a href="GHC.Word.html#Word8"><span class="hs-identifier hs-type">Word8</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../ghc-prim-0.5.2.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Types.html#Int"><span class="hs-identifier hs-type">Int</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="GHC.Word.html#Word64"><span class="hs-identifier hs-type">Word64</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../ghc-prim-0.5.2.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Types.html#IO"><span class="hs-identifier hs-type">IO</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-274"></a><span>          </span><a name="local-6989586621679090555"><a href="#local-6989586621679090555"><span class="hs-identifier">pokeW64</span></a></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-number">0</span><span>  </span><span class="hs-identifier">_</span><span>  </span><span class="hs-glyph">=</span><span> </span><a href="GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-275"></a><span>          </span><span class="hs-identifier">pokeW64</span><span> </span><a name="local-6989586621679090556"><a href="#local-6989586621679090556"><span class="hs-identifier">p</span></a></a><span> </span><span class="hs-glyph">!</span><a name="local-6989586621679090557"><a href="#local-6989586621679090557"><span class="hs-identifier">n</span></a></a><span> </span><span class="hs-glyph">!</span><a name="local-6989586621679090558"><a href="#local-6989586621679090558"><span class="hs-identifier">i</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-276"></a><span>                </span><a href="Foreign.Storable.html#pokeElemOff"><span class="hs-identifier hs-var">pokeElemOff</span></a><span> </span><a href="#local-6989586621679090556"><span class="hs-identifier hs-var">p</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679090557"><span class="hs-identifier hs-var">n</span></a><span class="hs-glyph">-</span><span class="hs-number">1</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="GHC.Real.html#fromIntegral"><span class="hs-identifier hs-var">fromIntegral</span></a><span> </span><a href="#local-6989586621679090558"><span class="hs-identifier hs-var">i</span></a><span class="hs-special">)</span><span>
</span><a name="line-277"></a><span>                </span><a href="#local-6989586621679090555"><span class="hs-identifier hs-var">pokeW64</span></a><span> </span><a href="#local-6989586621679090556"><span class="hs-identifier hs-var">p</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679090557"><span class="hs-identifier hs-var">n</span></a><span class="hs-glyph">-</span><span class="hs-number">1</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679090558"><span class="hs-identifier hs-var">i</span></a><span> </span><span class="hs-special">`</span><a href="Data.Bits.html#shiftR"><span class="hs-identifier hs-var">shiftR</span></a><span class="hs-special">`</span><span> </span><span class="hs-number">8</span><span class="hs-special">)</span><span>
</span><a name="line-278"></a><span>
</span><a name="line-279"></a><span>      </span><a href="#local-6989586621679090555"><span class="hs-identifier hs-var">pokeW64</span></a><span> </span><span class="hs-special">(</span><a href="GHC.Ptr.html#castPtr"><span class="hs-identifier hs-var">castPtr</span></a><span> </span><a href="#local-6989586621679090552"><span class="hs-identifier hs-var">p0</span></a><span class="hs-special">)</span><span> </span><span class="hs-number">8</span><span> </span><a href="#local-6989586621679090553"><span class="hs-identifier hs-var">high</span></a><span>
</span><a name="line-280"></a><span>      </span><a href="#local-6989586621679090555"><span class="hs-identifier hs-var">pokeW64</span></a><span> </span><span class="hs-special">(</span><a href="GHC.Ptr.html#castPtr"><span class="hs-identifier hs-var">castPtr</span></a><span> </span><a href="#local-6989586621679090552"><span class="hs-identifier hs-var">p0</span></a><span> </span><span class="hs-special">`</span><a href="GHC.Ptr.html#plusPtr"><span class="hs-identifier hs-var">plusPtr</span></a><span class="hs-special">`</span><span> </span><span class="hs-number">8</span><span class="hs-special">)</span><span> </span><span class="hs-number">8</span><span> </span><a href="#local-6989586621679090554"><span class="hs-identifier hs-var">low</span></a><span>
</span><a name="line-281"></a></pre></body></html>