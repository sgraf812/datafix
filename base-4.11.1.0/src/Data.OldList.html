<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-pragma">{-# LANGUAGE Trustworthy #-}</span><span>
</span><a name="line-2"></a><span class="hs-pragma">{-# LANGUAGE CPP, NoImplicitPrelude, ScopedTypeVariables,
             MagicHash, BangPatterns #-}</span><span>
</span><a name="line-4"></a><span>
</span><a name="line-5"></a><span class="hs-comment">-----------------------------------------------------------------------------</span><span>
</span><a name="line-6"></a><span class="hs-comment">-- |</span><span>
</span><a name="line-7"></a><span class="hs-comment">-- Module      :  Data.List</span><span>
</span><a name="line-8"></a><span class="hs-comment">-- Copyright   :  (c) The University of Glasgow 2001</span><span>
</span><a name="line-9"></a><span class="hs-comment">-- License     :  BSD-style (see the file libraries/base/LICENSE)</span><span>
</span><a name="line-10"></a><span class="hs-comment">--</span><span>
</span><a name="line-11"></a><span class="hs-comment">-- Maintainer  :  libraries@haskell.org</span><span>
</span><a name="line-12"></a><span class="hs-comment">-- Stability   :  stable</span><span>
</span><a name="line-13"></a><span class="hs-comment">-- Portability :  portable</span><span>
</span><a name="line-14"></a><span class="hs-comment">--</span><span>
</span><a name="line-15"></a><span class="hs-comment">-- Operations on lists.</span><span>
</span><a name="line-16"></a><span class="hs-comment">--</span><span>
</span><a name="line-17"></a><span class="hs-comment">-----------------------------------------------------------------------------</span><span>
</span><a name="line-18"></a><span>
</span><a name="line-19"></a><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Data.OldList</span><span>
</span><a name="line-20"></a><span>   </span><span class="hs-special">(</span><span>
</span><a name="line-21"></a><span>   </span><span class="hs-comment">-- * Basic functions</span><span>
</span><a name="line-22"></a><span>
</span><a name="line-23"></a><span>     </span><span class="hs-special">(</span><a href="GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a><span class="hs-special">)</span><span>
</span><a name="line-24"></a><span>   </span><span class="hs-special">,</span><span> </span><a href="GHC.List.html#head"><span class="hs-identifier hs-var">head</span></a><span>
</span><a name="line-25"></a><span>   </span><span class="hs-special">,</span><span> </span><a href="GHC.List.html#last"><span class="hs-identifier hs-var">last</span></a><span>
</span><a name="line-26"></a><span>   </span><span class="hs-special">,</span><span> </span><a href="GHC.List.html#tail"><span class="hs-identifier hs-var">tail</span></a><span>
</span><a name="line-27"></a><span>   </span><span class="hs-special">,</span><span> </span><a href="GHC.List.html#init"><span class="hs-identifier hs-var">init</span></a><span>
</span><a name="line-28"></a><span>   </span><span class="hs-special">,</span><span> </span><a href="GHC.List.html#uncons"><span class="hs-identifier hs-var">uncons</span></a><span>
</span><a name="line-29"></a><span>   </span><span class="hs-special">,</span><span> </span><a href="GHC.List.html#null"><span class="hs-identifier hs-var">null</span></a><span>
</span><a name="line-30"></a><span>   </span><span class="hs-special">,</span><span> </span><a href="GHC.List.html#length"><span class="hs-identifier hs-var">length</span></a><span>
</span><a name="line-31"></a><span>
</span><a name="line-32"></a><span>   </span><span class="hs-comment">-- * List transformations</span><span>
</span><a name="line-33"></a><span>   </span><span class="hs-special">,</span><span> </span><a href="GHC.Base.html#map"><span class="hs-identifier hs-var">map</span></a><span>
</span><a name="line-34"></a><span>   </span><span class="hs-special">,</span><span> </span><a href="GHC.List.html#reverse"><span class="hs-identifier hs-var">reverse</span></a><span>
</span><a name="line-35"></a><span>
</span><a name="line-36"></a><span>   </span><span class="hs-special">,</span><span> </span><a href="Data.OldList.html#intersperse"><span class="hs-identifier hs-var">intersperse</span></a><span>
</span><a name="line-37"></a><span>   </span><span class="hs-special">,</span><span> </span><a href="Data.OldList.html#intercalate"><span class="hs-identifier hs-var">intercalate</span></a><span>
</span><a name="line-38"></a><span>   </span><span class="hs-special">,</span><span> </span><a href="Data.OldList.html#transpose"><span class="hs-identifier hs-var">transpose</span></a><span>
</span><a name="line-39"></a><span>
</span><a name="line-40"></a><span>   </span><span class="hs-special">,</span><span> </span><a href="Data.OldList.html#subsequences"><span class="hs-identifier hs-var">subsequences</span></a><span>
</span><a name="line-41"></a><span>   </span><span class="hs-special">,</span><span> </span><a href="Data.OldList.html#permutations"><span class="hs-identifier hs-var">permutations</span></a><span>
</span><a name="line-42"></a><span>
</span><a name="line-43"></a><span>   </span><span class="hs-comment">-- * Reducing lists (folds)</span><span>
</span><a name="line-44"></a><span>
</span><a name="line-45"></a><span>   </span><span class="hs-special">,</span><span> </span><a href="GHC.List.html#foldl"><span class="hs-identifier hs-var">foldl</span></a><span>
</span><a name="line-46"></a><span>   </span><span class="hs-special">,</span><span> </span><a href="GHC.List.html#foldl%27"><span class="hs-identifier hs-var">foldl'</span></a><span>
</span><a name="line-47"></a><span>   </span><span class="hs-special">,</span><span> </span><a href="GHC.List.html#foldl1"><span class="hs-identifier hs-var">foldl1</span></a><span>
</span><a name="line-48"></a><span>   </span><span class="hs-special">,</span><span> </span><a href="GHC.List.html#foldl1%27"><span class="hs-identifier hs-var">foldl1'</span></a><span>
</span><a name="line-49"></a><span>   </span><span class="hs-special">,</span><span> </span><a href="GHC.Base.html#foldr"><span class="hs-identifier hs-var">foldr</span></a><span>
</span><a name="line-50"></a><span>   </span><span class="hs-special">,</span><span> </span><a href="GHC.List.html#foldr1"><span class="hs-identifier hs-var">foldr1</span></a><span>
</span><a name="line-51"></a><span>
</span><a name="line-52"></a><span>   </span><span class="hs-comment">-- ** Special folds</span><span>
</span><a name="line-53"></a><span>
</span><a name="line-54"></a><span>   </span><span class="hs-special">,</span><span> </span><a href="GHC.List.html#concat"><span class="hs-identifier hs-var">concat</span></a><span>
</span><a name="line-55"></a><span>   </span><span class="hs-special">,</span><span> </span><a href="GHC.List.html#concatMap"><span class="hs-identifier hs-var">concatMap</span></a><span>
</span><a name="line-56"></a><span>   </span><span class="hs-special">,</span><span> </span><a href="GHC.List.html#and"><span class="hs-identifier hs-var">and</span></a><span>
</span><a name="line-57"></a><span>   </span><span class="hs-special">,</span><span> </span><a href="GHC.List.html#or"><span class="hs-identifier hs-var">or</span></a><span>
</span><a name="line-58"></a><span>   </span><span class="hs-special">,</span><span> </span><a href="GHC.List.html#any"><span class="hs-identifier hs-var">any</span></a><span>
</span><a name="line-59"></a><span>   </span><span class="hs-special">,</span><span> </span><a href="GHC.List.html#all"><span class="hs-identifier hs-var">all</span></a><span>
</span><a name="line-60"></a><span>   </span><span class="hs-special">,</span><span> </span><a href="GHC.List.html#sum"><span class="hs-identifier hs-var">sum</span></a><span>
</span><a name="line-61"></a><span>   </span><span class="hs-special">,</span><span> </span><a href="GHC.List.html#product"><span class="hs-identifier hs-var">product</span></a><span>
</span><a name="line-62"></a><span>   </span><span class="hs-special">,</span><span> </span><a href="GHC.List.html#maximum"><span class="hs-identifier hs-var">maximum</span></a><span>
</span><a name="line-63"></a><span>   </span><span class="hs-special">,</span><span> </span><a href="GHC.List.html#minimum"><span class="hs-identifier hs-var">minimum</span></a><span>
</span><a name="line-64"></a><span>
</span><a name="line-65"></a><span>   </span><span class="hs-comment">-- * Building lists</span><span>
</span><a name="line-66"></a><span>
</span><a name="line-67"></a><span>   </span><span class="hs-comment">-- ** Scans</span><span>
</span><a name="line-68"></a><span>   </span><span class="hs-special">,</span><span> </span><a href="GHC.List.html#scanl"><span class="hs-identifier hs-var">scanl</span></a><span>
</span><a name="line-69"></a><span>   </span><span class="hs-special">,</span><span> </span><a href="GHC.List.html#scanl%27"><span class="hs-identifier hs-var">scanl'</span></a><span>
</span><a name="line-70"></a><span>   </span><span class="hs-special">,</span><span> </span><a href="GHC.List.html#scanl1"><span class="hs-identifier hs-var">scanl1</span></a><span>
</span><a name="line-71"></a><span>   </span><span class="hs-special">,</span><span> </span><a href="GHC.List.html#scanr"><span class="hs-identifier hs-var">scanr</span></a><span>
</span><a name="line-72"></a><span>   </span><span class="hs-special">,</span><span> </span><a href="GHC.List.html#scanr1"><span class="hs-identifier hs-var">scanr1</span></a><span>
</span><a name="line-73"></a><span>
</span><a name="line-74"></a><span>   </span><span class="hs-comment">-- ** Accumulating maps</span><span>
</span><a name="line-75"></a><span>   </span><span class="hs-special">,</span><span> </span><a href="Data.OldList.html#mapAccumL"><span class="hs-identifier hs-var">mapAccumL</span></a><span>
</span><a name="line-76"></a><span>   </span><span class="hs-special">,</span><span> </span><a href="Data.OldList.html#mapAccumR"><span class="hs-identifier hs-var">mapAccumR</span></a><span>
</span><a name="line-77"></a><span>
</span><a name="line-78"></a><span>   </span><span class="hs-comment">-- ** Infinite lists</span><span>
</span><a name="line-79"></a><span>   </span><span class="hs-special">,</span><span> </span><a href="GHC.List.html#iterate"><span class="hs-identifier hs-var">iterate</span></a><span>
</span><a name="line-80"></a><span>   </span><span class="hs-special">,</span><span> </span><a href="GHC.List.html#iterate%27"><span class="hs-identifier hs-var">iterate'</span></a><span>
</span><a name="line-81"></a><span>   </span><span class="hs-special">,</span><span> </span><a href="GHC.List.html#repeat"><span class="hs-identifier hs-var">repeat</span></a><span>
</span><a name="line-82"></a><span>   </span><span class="hs-special">,</span><span> </span><a href="GHC.List.html#replicate"><span class="hs-identifier hs-var">replicate</span></a><span>
</span><a name="line-83"></a><span>   </span><span class="hs-special">,</span><span> </span><a href="GHC.List.html#cycle"><span class="hs-identifier hs-var">cycle</span></a><span>
</span><a name="line-84"></a><span>
</span><a name="line-85"></a><span>   </span><span class="hs-comment">-- ** Unfolding</span><span>
</span><a name="line-86"></a><span>   </span><span class="hs-special">,</span><span> </span><a href="Data.OldList.html#unfoldr"><span class="hs-identifier hs-var">unfoldr</span></a><span>
</span><a name="line-87"></a><span>
</span><a name="line-88"></a><span>   </span><span class="hs-comment">-- * Sublists</span><span>
</span><a name="line-89"></a><span>
</span><a name="line-90"></a><span>   </span><span class="hs-comment">-- ** Extracting sublists</span><span>
</span><a name="line-91"></a><span>   </span><span class="hs-special">,</span><span> </span><a href="GHC.List.html#take"><span class="hs-identifier hs-var">take</span></a><span>
</span><a name="line-92"></a><span>   </span><span class="hs-special">,</span><span> </span><a href="GHC.List.html#drop"><span class="hs-identifier hs-var">drop</span></a><span>
</span><a name="line-93"></a><span>   </span><span class="hs-special">,</span><span> </span><a href="GHC.List.html#splitAt"><span class="hs-identifier hs-var">splitAt</span></a><span>
</span><a name="line-94"></a><span>
</span><a name="line-95"></a><span>   </span><span class="hs-special">,</span><span> </span><a href="GHC.List.html#takeWhile"><span class="hs-identifier hs-var">takeWhile</span></a><span>
</span><a name="line-96"></a><span>   </span><span class="hs-special">,</span><span> </span><a href="GHC.List.html#dropWhile"><span class="hs-identifier hs-var">dropWhile</span></a><span>
</span><a name="line-97"></a><span>   </span><span class="hs-special">,</span><span> </span><a href="Data.OldList.html#dropWhileEnd"><span class="hs-identifier hs-var">dropWhileEnd</span></a><span>
</span><a name="line-98"></a><span>   </span><span class="hs-special">,</span><span> </span><a href="GHC.List.html#span"><span class="hs-identifier hs-var">span</span></a><span>
</span><a name="line-99"></a><span>   </span><span class="hs-special">,</span><span> </span><a href="GHC.List.html#break"><span class="hs-identifier hs-var">break</span></a><span>
</span><a name="line-100"></a><span>
</span><a name="line-101"></a><span>   </span><span class="hs-special">,</span><span> </span><a href="Data.OldList.html#stripPrefix"><span class="hs-identifier hs-var">stripPrefix</span></a><span>
</span><a name="line-102"></a><span>
</span><a name="line-103"></a><span>   </span><span class="hs-special">,</span><span> </span><a href="Data.OldList.html#group"><span class="hs-identifier hs-var">group</span></a><span>
</span><a name="line-104"></a><span>
</span><a name="line-105"></a><span>   </span><span class="hs-special">,</span><span> </span><a href="Data.OldList.html#inits"><span class="hs-identifier hs-var">inits</span></a><span>
</span><a name="line-106"></a><span>   </span><span class="hs-special">,</span><span> </span><a href="Data.OldList.html#tails"><span class="hs-identifier hs-var">tails</span></a><span>
</span><a name="line-107"></a><span>
</span><a name="line-108"></a><span>   </span><span class="hs-comment">-- ** Predicates</span><span>
</span><a name="line-109"></a><span>   </span><span class="hs-special">,</span><span> </span><a href="Data.OldList.html#isPrefixOf"><span class="hs-identifier hs-var">isPrefixOf</span></a><span>
</span><a name="line-110"></a><span>   </span><span class="hs-special">,</span><span> </span><a href="Data.OldList.html#isSuffixOf"><span class="hs-identifier hs-var">isSuffixOf</span></a><span>
</span><a name="line-111"></a><span>   </span><span class="hs-special">,</span><span> </span><a href="Data.OldList.html#isInfixOf"><span class="hs-identifier hs-var">isInfixOf</span></a><span>
</span><a name="line-112"></a><span>
</span><a name="line-113"></a><span>   </span><span class="hs-comment">-- * Searching lists</span><span>
</span><a name="line-114"></a><span>
</span><a name="line-115"></a><span>   </span><span class="hs-comment">-- ** Searching by equality</span><span>
</span><a name="line-116"></a><span>   </span><span class="hs-special">,</span><span> </span><a href="GHC.List.html#elem"><span class="hs-identifier hs-var">elem</span></a><span>
</span><a name="line-117"></a><span>   </span><span class="hs-special">,</span><span> </span><a href="GHC.List.html#notElem"><span class="hs-identifier hs-var">notElem</span></a><span>
</span><a name="line-118"></a><span>   </span><span class="hs-special">,</span><span> </span><a href="GHC.List.html#lookup"><span class="hs-identifier hs-var">lookup</span></a><span>
</span><a name="line-119"></a><span>
</span><a name="line-120"></a><span>   </span><span class="hs-comment">-- ** Searching with a predicate</span><span>
</span><a name="line-121"></a><span>   </span><span class="hs-special">,</span><span> </span><a href="Data.OldList.html#find"><span class="hs-identifier hs-var">find</span></a><span>
</span><a name="line-122"></a><span>   </span><span class="hs-special">,</span><span> </span><a href="GHC.List.html#filter"><span class="hs-identifier hs-var">filter</span></a><span>
</span><a name="line-123"></a><span>   </span><span class="hs-special">,</span><span> </span><a href="Data.OldList.html#partition"><span class="hs-identifier hs-var">partition</span></a><span>
</span><a name="line-124"></a><span>
</span><a name="line-125"></a><span>   </span><span class="hs-comment">-- * Indexing lists</span><span>
</span><a name="line-126"></a><span>   </span><span class="hs-comment">-- | These functions treat a list @xs@ as a indexed collection,</span><span>
</span><a name="line-127"></a><span>   </span><span class="hs-comment">-- with indices ranging from 0 to @'length' xs - 1@.</span><span>
</span><a name="line-128"></a><span>
</span><a name="line-129"></a><span>   </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><a href="GHC.List.html#%21%21"><span class="hs-operator hs-var">!!</span></a><span class="hs-special">)</span><span>
</span><a name="line-130"></a><span>
</span><a name="line-131"></a><span>   </span><span class="hs-special">,</span><span> </span><a href="Data.OldList.html#elemIndex"><span class="hs-identifier hs-var">elemIndex</span></a><span>
</span><a name="line-132"></a><span>   </span><span class="hs-special">,</span><span> </span><a href="Data.OldList.html#elemIndices"><span class="hs-identifier hs-var">elemIndices</span></a><span>
</span><a name="line-133"></a><span>
</span><a name="line-134"></a><span>   </span><span class="hs-special">,</span><span> </span><a href="Data.OldList.html#findIndex"><span class="hs-identifier hs-var">findIndex</span></a><span>
</span><a name="line-135"></a><span>   </span><span class="hs-special">,</span><span> </span><a href="Data.OldList.html#findIndices"><span class="hs-identifier hs-var">findIndices</span></a><span>
</span><a name="line-136"></a><span>
</span><a name="line-137"></a><span>   </span><span class="hs-comment">-- * Zipping and unzipping lists</span><span>
</span><a name="line-138"></a><span>
</span><a name="line-139"></a><span>   </span><span class="hs-special">,</span><span> </span><a href="GHC.List.html#zip"><span class="hs-identifier hs-var">zip</span></a><span>
</span><a name="line-140"></a><span>   </span><span class="hs-special">,</span><span> </span><a href="GHC.List.html#zip3"><span class="hs-identifier hs-var">zip3</span></a><span>
</span><a name="line-141"></a><span>   </span><span class="hs-special">,</span><span> </span><a href="Data.OldList.html#zip4"><span class="hs-identifier hs-var">zip4</span></a><span class="hs-special">,</span><span> </span><a href="Data.OldList.html#zip5"><span class="hs-identifier hs-var">zip5</span></a><span class="hs-special">,</span><span> </span><a href="Data.OldList.html#zip6"><span class="hs-identifier hs-var">zip6</span></a><span class="hs-special">,</span><span> </span><a href="Data.OldList.html#zip7"><span class="hs-identifier hs-var">zip7</span></a><span>
</span><a name="line-142"></a><span>
</span><a name="line-143"></a><span>   </span><span class="hs-special">,</span><span> </span><a href="GHC.List.html#zipWith"><span class="hs-identifier hs-var">zipWith</span></a><span>
</span><a name="line-144"></a><span>   </span><span class="hs-special">,</span><span> </span><a href="GHC.List.html#zipWith3"><span class="hs-identifier hs-var">zipWith3</span></a><span>
</span><a name="line-145"></a><span>   </span><span class="hs-special">,</span><span> </span><a href="Data.OldList.html#zipWith4"><span class="hs-identifier hs-var">zipWith4</span></a><span class="hs-special">,</span><span> </span><a href="Data.OldList.html#zipWith5"><span class="hs-identifier hs-var">zipWith5</span></a><span class="hs-special">,</span><span> </span><a href="Data.OldList.html#zipWith6"><span class="hs-identifier hs-var">zipWith6</span></a><span class="hs-special">,</span><span> </span><a href="Data.OldList.html#zipWith7"><span class="hs-identifier hs-var">zipWith7</span></a><span>
</span><a name="line-146"></a><span>
</span><a name="line-147"></a><span>   </span><span class="hs-special">,</span><span> </span><a href="GHC.List.html#unzip"><span class="hs-identifier hs-var">unzip</span></a><span>
</span><a name="line-148"></a><span>   </span><span class="hs-special">,</span><span> </span><a href="GHC.List.html#unzip3"><span class="hs-identifier hs-var">unzip3</span></a><span>
</span><a name="line-149"></a><span>   </span><span class="hs-special">,</span><span> </span><a href="Data.OldList.html#unzip4"><span class="hs-identifier hs-var">unzip4</span></a><span class="hs-special">,</span><span> </span><a href="Data.OldList.html#unzip5"><span class="hs-identifier hs-var">unzip5</span></a><span class="hs-special">,</span><span> </span><a href="Data.OldList.html#unzip6"><span class="hs-identifier hs-var">unzip6</span></a><span class="hs-special">,</span><span> </span><a href="Data.OldList.html#unzip7"><span class="hs-identifier hs-var">unzip7</span></a><span>
</span><a name="line-150"></a><span>
</span><a name="line-151"></a><span>   </span><span class="hs-comment">-- * Special lists</span><span>
</span><a name="line-152"></a><span>
</span><a name="line-153"></a><span>   </span><span class="hs-comment">-- ** Functions on strings</span><span>
</span><a name="line-154"></a><span>   </span><span class="hs-special">,</span><span> </span><a href="Data.OldList.html#lines"><span class="hs-identifier hs-var">lines</span></a><span>
</span><a name="line-155"></a><span>   </span><span class="hs-special">,</span><span> </span><a href="Data.OldList.html#words"><span class="hs-identifier hs-var">words</span></a><span>
</span><a name="line-156"></a><span>   </span><span class="hs-special">,</span><span> </span><a href="Data.OldList.html#unlines"><span class="hs-identifier hs-var">unlines</span></a><span>
</span><a name="line-157"></a><span>   </span><span class="hs-special">,</span><span> </span><a href="Data.OldList.html#unwords"><span class="hs-identifier hs-var">unwords</span></a><span>
</span><a name="line-158"></a><span>
</span><a name="line-159"></a><span>   </span><span class="hs-comment">-- ** \&quot;Set\&quot; operations</span><span>
</span><a name="line-160"></a><span>
</span><a name="line-161"></a><span>   </span><span class="hs-special">,</span><span> </span><a href="Data.OldList.html#nub"><span class="hs-identifier hs-var">nub</span></a><span>
</span><a name="line-162"></a><span>
</span><a name="line-163"></a><span>   </span><span class="hs-special">,</span><span> </span><a href="Data.OldList.html#delete"><span class="hs-identifier hs-var">delete</span></a><span>
</span><a name="line-164"></a><span>   </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><a href="Data.OldList.html#%5C%5C"><span class="hs-operator hs-var">\\</span></a><span class="hs-special">)</span><span>
</span><a name="line-165"></a><span>
</span><a name="line-166"></a><span>   </span><span class="hs-special">,</span><span> </span><a href="Data.OldList.html#union"><span class="hs-identifier hs-var">union</span></a><span>
</span><a name="line-167"></a><span>   </span><span class="hs-special">,</span><span> </span><a href="Data.OldList.html#intersect"><span class="hs-identifier hs-var">intersect</span></a><span>
</span><a name="line-168"></a><span>
</span><a name="line-169"></a><span>   </span><span class="hs-comment">-- ** Ordered lists</span><span>
</span><a name="line-170"></a><span>   </span><span class="hs-special">,</span><span> </span><a href="Data.OldList.html#sort"><span class="hs-identifier hs-var">sort</span></a><span>
</span><a name="line-171"></a><span>   </span><span class="hs-special">,</span><span> </span><a href="Data.OldList.html#sortOn"><span class="hs-identifier hs-var">sortOn</span></a><span>
</span><a name="line-172"></a><span>   </span><span class="hs-special">,</span><span> </span><a href="Data.OldList.html#insert"><span class="hs-identifier hs-var">insert</span></a><span>
</span><a name="line-173"></a><span>
</span><a name="line-174"></a><span>   </span><span class="hs-comment">-- * Generalized functions</span><span>
</span><a name="line-175"></a><span>
</span><a name="line-176"></a><span>   </span><span class="hs-comment">-- ** The \&quot;@By@\&quot; operations</span><span>
</span><a name="line-177"></a><span>   </span><span class="hs-comment">-- | By convention, overloaded functions have a non-overloaded</span><span>
</span><a name="line-178"></a><span>   </span><span class="hs-comment">-- counterpart whose name is suffixed with \`@By@\'.</span><span>
</span><a name="line-179"></a><span>   </span><span class="hs-comment">--</span><span>
</span><a name="line-180"></a><span>   </span><span class="hs-comment">-- It is often convenient to use these functions together with</span><span>
</span><a name="line-181"></a><span>   </span><span class="hs-comment">-- 'Data.Function.on', for instance @'sortBy' ('compare'</span><span>
</span><a name="line-182"></a><span>   </span><span class="hs-comment">-- \`on\` 'fst')@.</span><span>
</span><a name="line-183"></a><span>
</span><a name="line-184"></a><span>   </span><span class="hs-comment">-- *** User-supplied equality (replacing an @Eq@ context)</span><span>
</span><a name="line-185"></a><span>   </span><span class="hs-comment">-- | The predicate is assumed to define an equivalence.</span><span>
</span><a name="line-186"></a><span>   </span><span class="hs-special">,</span><span> </span><a href="Data.OldList.html#nubBy"><span class="hs-identifier hs-var">nubBy</span></a><span>
</span><a name="line-187"></a><span>   </span><span class="hs-special">,</span><span> </span><a href="Data.OldList.html#deleteBy"><span class="hs-identifier hs-var">deleteBy</span></a><span>
</span><a name="line-188"></a><span>   </span><span class="hs-special">,</span><span> </span><a href="Data.OldList.html#deleteFirstsBy"><span class="hs-identifier hs-var">deleteFirstsBy</span></a><span>
</span><a name="line-189"></a><span>   </span><span class="hs-special">,</span><span> </span><a href="Data.OldList.html#unionBy"><span class="hs-identifier hs-var">unionBy</span></a><span>
</span><a name="line-190"></a><span>   </span><span class="hs-special">,</span><span> </span><a href="Data.OldList.html#intersectBy"><span class="hs-identifier hs-var">intersectBy</span></a><span>
</span><a name="line-191"></a><span>   </span><span class="hs-special">,</span><span> </span><a href="Data.OldList.html#groupBy"><span class="hs-identifier hs-var">groupBy</span></a><span>
</span><a name="line-192"></a><span>
</span><a name="line-193"></a><span>   </span><span class="hs-comment">-- *** User-supplied comparison (replacing an @Ord@ context)</span><span>
</span><a name="line-194"></a><span>   </span><span class="hs-comment">-- | The function is assumed to define a total ordering.</span><span>
</span><a name="line-195"></a><span>   </span><span class="hs-special">,</span><span> </span><a href="Data.OldList.html#sortBy"><span class="hs-identifier hs-var">sortBy</span></a><span>
</span><a name="line-196"></a><span>   </span><span class="hs-special">,</span><span> </span><a href="Data.OldList.html#insertBy"><span class="hs-identifier hs-var">insertBy</span></a><span>
</span><a name="line-197"></a><span>   </span><span class="hs-special">,</span><span> </span><a href="Data.OldList.html#maximumBy"><span class="hs-identifier hs-var">maximumBy</span></a><span>
</span><a name="line-198"></a><span>   </span><span class="hs-special">,</span><span> </span><a href="Data.OldList.html#minimumBy"><span class="hs-identifier hs-var">minimumBy</span></a><span>
</span><a name="line-199"></a><span>
</span><a name="line-200"></a><span>   </span><span class="hs-comment">-- ** The \&quot;@generic@\&quot; operations</span><span>
</span><a name="line-201"></a><span>   </span><span class="hs-comment">-- | The prefix \`@generic@\' indicates an overloaded function that</span><span>
</span><a name="line-202"></a><span>   </span><span class="hs-comment">-- is a generalized version of a &quot;Prelude&quot; function.</span><span>
</span><a name="line-203"></a><span>
</span><a name="line-204"></a><span>   </span><span class="hs-special">,</span><span> </span><a href="Data.OldList.html#genericLength"><span class="hs-identifier hs-var">genericLength</span></a><span>
</span><a name="line-205"></a><span>   </span><span class="hs-special">,</span><span> </span><a href="Data.OldList.html#genericTake"><span class="hs-identifier hs-var">genericTake</span></a><span>
</span><a name="line-206"></a><span>   </span><span class="hs-special">,</span><span> </span><a href="Data.OldList.html#genericDrop"><span class="hs-identifier hs-var">genericDrop</span></a><span>
</span><a name="line-207"></a><span>   </span><span class="hs-special">,</span><span> </span><a href="Data.OldList.html#genericSplitAt"><span class="hs-identifier hs-var">genericSplitAt</span></a><span>
</span><a name="line-208"></a><span>   </span><span class="hs-special">,</span><span> </span><a href="Data.OldList.html#genericIndex"><span class="hs-identifier hs-var">genericIndex</span></a><span>
</span><a name="line-209"></a><span>   </span><span class="hs-special">,</span><span> </span><a href="Data.OldList.html#genericReplicate"><span class="hs-identifier hs-var">genericReplicate</span></a><span>
</span><a name="line-210"></a><span>
</span><a name="line-211"></a><span>   </span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-212"></a><span>
</span><a name="line-213"></a><span class="hs-keyword">import</span><span> </span><a href="Data.Maybe.html"><span class="hs-identifier">Data.Maybe</span></a><span>
</span><a name="line-214"></a><span class="hs-keyword">import</span><span> </span><a href="Data.Bits.html"><span class="hs-identifier">Data.Bits</span></a><span>        </span><span class="hs-special">(</span><span> </span><span class="hs-special">(</span><a href="Data.Bits.html#.%26."><span class="hs-operator hs-var">.&amp;.</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">)</span><span>
</span><a name="line-215"></a><span class="hs-keyword">import</span><span> </span><a href="Data.Char.html"><span class="hs-identifier">Data.Char</span></a><span>        </span><span class="hs-special">(</span><span> </span><a href="GHC.Unicode.html#isSpace"><span class="hs-identifier hs-var">isSpace</span></a><span> </span><span class="hs-special">)</span><span>
</span><a name="line-216"></a><span class="hs-keyword">import</span><span> </span><a href="Data.Ord.html"><span class="hs-identifier">Data.Ord</span></a><span>         </span><span class="hs-special">(</span><span> </span><a href="Data.Ord.html#comparing"><span class="hs-identifier hs-var">comparing</span></a><span> </span><span class="hs-special">)</span><span>
</span><a name="line-217"></a><span class="hs-keyword">import</span><span> </span><a href="Data.Tuple.html"><span class="hs-identifier">Data.Tuple</span></a><span>       </span><span class="hs-special">(</span><span> </span><a href="Data.Tuple.html#fst"><span class="hs-identifier hs-var">fst</span></a><span class="hs-special">,</span><span> </span><a href="Data.Tuple.html#snd"><span class="hs-identifier hs-var">snd</span></a><span> </span><span class="hs-special">)</span><span>
</span><a name="line-218"></a><span>
</span><a name="line-219"></a><span class="hs-keyword">import</span><span> </span><a href="GHC.Num.html"><span class="hs-identifier">GHC.Num</span></a><span>
</span><a name="line-220"></a><span class="hs-keyword">import</span><span> </span><a href="GHC.Real.html"><span class="hs-identifier">GHC.Real</span></a><span>
</span><a name="line-221"></a><span class="hs-keyword">import</span><span> </span><a href="GHC.List.html"><span class="hs-identifier">GHC.List</span></a><span>
</span><a name="line-222"></a><span class="hs-keyword">import</span><span> </span><a href="GHC.Base.html"><span class="hs-identifier">GHC.Base</span></a><span>
</span><a name="line-223"></a><span>
</span><a name="line-224"></a><span class="hs-keyword">infix</span><span> </span><span class="hs-number">5</span><span> </span><a name="%5C%5C"><a href="Data.OldList.html#%5C%5C"><span class="hs-operator">\\</span></a></a><span> </span><span class="hs-comment">-- comment to fool cpp: https://www.haskell.org/ghc/docs/latest/html/users_guide/options-phases.html#cpp-string-gaps</span><span>
</span><a name="line-225"></a><span>
</span><a name="line-226"></a><span class="hs-comment">-- -----------------------------------------------------------------------------</span><span>
</span><a name="line-227"></a><span class="hs-comment">-- List functions</span><span>
</span><a name="line-228"></a><span>
</span><a name="line-229"></a><span class="hs-comment">-- | The 'dropWhileEnd' function drops the largest suffix of a list</span><span>
</span><a name="line-230"></a><span class="hs-comment">-- in which the given predicate holds for all elements.  For example:</span><span>
</span><a name="line-231"></a><span class="hs-comment">--</span><span>
</span><a name="line-232"></a><span class="hs-comment">-- &gt;&gt;&gt; dropWhileEnd isSpace &quot;foo\n&quot;</span><span>
</span><a name="line-233"></a><span class="hs-comment">-- &quot;foo&quot;</span><span>
</span><a name="line-234"></a><span class="hs-comment">--</span><span>
</span><a name="line-235"></a><span class="hs-comment">-- &gt;&gt;&gt; dropWhileEnd isSpace &quot;foo bar&quot;</span><span>
</span><a name="line-236"></a><span class="hs-comment">-- &quot;foo bar&quot;</span><span>
</span><a name="line-237"></a><span class="hs-comment">--</span><span>
</span><a name="line-238"></a><span class="hs-comment">-- &gt; dropWhileEnd isSpace (&quot;foo\n&quot; ++ undefined) == &quot;foo&quot; ++ undefined</span><span>
</span><a name="line-239"></a><span class="hs-comment">--</span><span>
</span><a name="line-240"></a><span class="hs-comment">-- @since 4.5.0.0</span><span>
</span><a name="line-241"></a><span class="hs-identifier">dropWhileEnd</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679151773"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../ghc-prim-0.5.2.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Types.html#Bool"><span class="hs-identifier hs-type">Bool</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679151773"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679151773"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">]</span><span>
</span><a name="line-242"></a><a name="dropWhileEnd"><a href="Data.OldList.html#dropWhileEnd"><span class="hs-identifier">dropWhileEnd</span></a></a><span> </span><a name="local-6989586621679151774"><a href="#local-6989586621679151774"><span class="hs-identifier">p</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="GHC.Base.html#foldr"><span class="hs-identifier hs-var">foldr</span></a><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><a name="local-6989586621679151775"><a href="#local-6989586621679151775"><span class="hs-identifier">x</span></a></a><span> </span><a name="local-6989586621679151776"><a href="#local-6989586621679151776"><span class="hs-identifier">xs</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">if</span><span> </span><a href="#local-6989586621679151774"><span class="hs-identifier hs-var">p</span></a><span> </span><a href="#local-6989586621679151775"><span class="hs-identifier hs-var">x</span></a><span> </span><a href="../ghc-prim-0.5.2.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Classes.html#%26%26"><span class="hs-operator hs-var">&amp;&amp;</span></a><span> </span><a href="GHC.List.html#null"><span class="hs-identifier hs-var">null</span></a><span> </span><a href="#local-6989586621679151776"><span class="hs-identifier hs-var">xs</span></a><span> </span><span class="hs-keyword">then</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-keyword">else</span><span> </span><a href="#local-6989586621679151775"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-glyph">:</span><span> </span><a href="#local-6989586621679151776"><span class="hs-identifier hs-var">xs</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-243"></a><span>
</span><a name="line-244"></a><span class="hs-comment">-- | The 'stripPrefix' function drops the given prefix from a list.</span><span>
</span><a name="line-245"></a><span class="hs-comment">-- It returns 'Nothing' if the list did not start with the prefix</span><span>
</span><a name="line-246"></a><span class="hs-comment">-- given, or 'Just' the list after the prefix, if it does.</span><span>
</span><a name="line-247"></a><span class="hs-comment">--</span><span>
</span><a name="line-248"></a><span class="hs-comment">-- &gt;&gt;&gt; stripPrefix &quot;foo&quot; &quot;foobar&quot;</span><span>
</span><a name="line-249"></a><span class="hs-comment">-- Just &quot;bar&quot;</span><span>
</span><a name="line-250"></a><span class="hs-comment">--</span><span>
</span><a name="line-251"></a><span class="hs-comment">-- &gt;&gt;&gt; stripPrefix &quot;foo&quot; &quot;foo&quot;</span><span>
</span><a name="line-252"></a><span class="hs-comment">-- Just &quot;&quot;</span><span>
</span><a name="line-253"></a><span class="hs-comment">--</span><span>
</span><a name="line-254"></a><span class="hs-comment">-- &gt;&gt;&gt; stripPrefix &quot;foo&quot; &quot;barfoo&quot;</span><span>
</span><a name="line-255"></a><span class="hs-comment">-- Nothing</span><span>
</span><a name="line-256"></a><span class="hs-comment">--</span><span>
</span><a name="line-257"></a><span class="hs-comment">-- &gt;&gt;&gt; stripPrefix &quot;foo&quot; &quot;barfoobaz&quot;</span><span>
</span><a name="line-258"></a><span class="hs-comment">-- Nothing</span><span>
</span><a name="line-259"></a><span class="hs-identifier">stripPrefix</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="../ghc-prim-0.5.2.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Classes.html#Eq"><span class="hs-identifier hs-type">Eq</span></a><span> </span><a href="#local-6989586621679151772"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679151772"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679151772"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="GHC.Base.html#Maybe"><span class="hs-identifier hs-type">Maybe</span></a><span> </span><span class="hs-special">[</span><a href="#local-6989586621679151772"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">]</span><span>
</span><a name="line-260"></a><a name="stripPrefix"><a href="Data.OldList.html#stripPrefix"><span class="hs-identifier">stripPrefix</span></a></a><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><a name="local-6989586621679151777"><a href="#local-6989586621679151777"><span class="hs-identifier">ys</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><a href="#local-6989586621679151777"><span class="hs-identifier hs-var">ys</span></a><span>
</span><a name="line-261"></a><span class="hs-identifier">stripPrefix</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679151778"><a href="#local-6989586621679151778"><span class="hs-identifier">x</span></a></a><span class="hs-glyph">:</span><a name="local-6989586621679151779"><a href="#local-6989586621679151779"><span class="hs-identifier">xs</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679151780"><a href="#local-6989586621679151780"><span class="hs-identifier">y</span></a></a><span class="hs-glyph">:</span><a name="local-6989586621679151781"><a href="#local-6989586621679151781"><span class="hs-identifier">ys</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-262"></a><span> </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621679151778"><span class="hs-identifier hs-var">x</span></a><span> </span><a href="../ghc-prim-0.5.2.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Classes.html#%3D%3D"><span class="hs-operator hs-var">==</span></a><span> </span><a href="#local-6989586621679151780"><span class="hs-identifier hs-var">y</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.OldList.html#stripPrefix"><span class="hs-identifier hs-var">stripPrefix</span></a><span> </span><a href="#local-6989586621679151779"><span class="hs-identifier hs-var">xs</span></a><span> </span><a href="#local-6989586621679151781"><span class="hs-identifier hs-var">ys</span></a><span>
</span><a name="line-263"></a><span class="hs-identifier">stripPrefix</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="GHC.Base.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a><span>
</span><a name="line-264"></a><span>
</span><a name="line-265"></a><span class="hs-comment">-- | The 'elemIndex' function returns the index of the first element</span><span>
</span><a name="line-266"></a><span class="hs-comment">-- in the given list which is equal (by '==') to the query element,</span><span>
</span><a name="line-267"></a><span class="hs-comment">-- or 'Nothing' if there is no such element.</span><span>
</span><a name="line-268"></a><span class="hs-comment">--</span><span>
</span><a name="line-269"></a><span class="hs-comment">-- &gt;&gt;&gt; elemIndex 4 [0..]</span><span>
</span><a name="line-270"></a><span class="hs-comment">-- Just 4</span><span>
</span><a name="line-271"></a><span class="hs-identifier">elemIndex</span><span>       </span><span class="hs-glyph">::</span><span> </span><a href="../ghc-prim-0.5.2.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Classes.html#Eq"><span class="hs-identifier hs-type">Eq</span></a><span> </span><a href="#local-6989586621679151771"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="#local-6989586621679151771"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679151771"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="GHC.Base.html#Maybe"><span class="hs-identifier hs-type">Maybe</span></a><span> </span><a href="../ghc-prim-0.5.2.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Types.html#Int"><span class="hs-identifier hs-type">Int</span></a><span>
</span><a name="line-272"></a><a name="elemIndex"><a href="Data.OldList.html#elemIndex"><span class="hs-identifier">elemIndex</span></a></a><span> </span><a name="local-6989586621679151782"><a href="#local-6989586621679151782"><span class="hs-identifier">x</span></a></a><span>     </span><span class="hs-glyph">=</span><span> </span><a href="Data.OldList.html#findIndex"><span class="hs-identifier hs-var">findIndex</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679151782"><span class="hs-identifier hs-var">x</span></a><a href="../ghc-prim-0.5.2.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Classes.html#%3D%3D"><span class="hs-operator hs-var">==</span></a><span class="hs-special">)</span><span>
</span><a name="line-273"></a><span>
</span><a name="line-274"></a><span class="hs-comment">-- | The 'elemIndices' function extends 'elemIndex', by returning the</span><span>
</span><a name="line-275"></a><span class="hs-comment">-- indices of all elements equal to the query element, in ascending order.</span><span>
</span><a name="line-276"></a><span class="hs-comment">--</span><span>
</span><a name="line-277"></a><span class="hs-comment">-- &gt;&gt;&gt; elemIndices 'o' &quot;Hello World&quot;</span><span>
</span><a name="line-278"></a><span class="hs-comment">-- [4,7]</span><span>
</span><a name="line-279"></a><span class="hs-identifier">elemIndices</span><span>     </span><span class="hs-glyph">::</span><span> </span><a href="../ghc-prim-0.5.2.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Classes.html#Eq"><span class="hs-identifier hs-type">Eq</span></a><span> </span><a href="#local-6989586621679151770"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="#local-6989586621679151770"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679151770"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="../ghc-prim-0.5.2.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Types.html#Int"><span class="hs-identifier hs-type">Int</span></a><span class="hs-special">]</span><span>
</span><a name="line-280"></a><a name="elemIndices"><a href="Data.OldList.html#elemIndices"><span class="hs-identifier">elemIndices</span></a></a><span> </span><a name="local-6989586621679151783"><a href="#local-6989586621679151783"><span class="hs-identifier">x</span></a></a><span>   </span><span class="hs-glyph">=</span><span> </span><a href="Data.OldList.html#findIndices"><span class="hs-identifier hs-var">findIndices</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679151783"><span class="hs-identifier hs-var">x</span></a><a href="../ghc-prim-0.5.2.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Classes.html#%3D%3D"><span class="hs-operator hs-var">==</span></a><span class="hs-special">)</span><span>
</span><a name="line-281"></a><span>
</span><a name="line-282"></a><span class="hs-comment">-- | The 'find' function takes a predicate and a list and returns the</span><span>
</span><a name="line-283"></a><span class="hs-comment">-- first element in the list matching the predicate, or 'Nothing' if</span><span>
</span><a name="line-284"></a><span class="hs-comment">-- there is no such element.</span><span>
</span><a name="line-285"></a><span class="hs-comment">--</span><span>
</span><a name="line-286"></a><span class="hs-comment">-- &gt;&gt;&gt; find (&gt; 4) [1..]</span><span>
</span><a name="line-287"></a><span class="hs-comment">-- Just 5</span><span>
</span><a name="line-288"></a><span class="hs-comment">--</span><span>
</span><a name="line-289"></a><span class="hs-comment">-- &gt;&gt;&gt; find (&lt; 0) [1..10]</span><span>
</span><a name="line-290"></a><span class="hs-comment">-- Nothing</span><span>
</span><a name="line-291"></a><span class="hs-identifier">find</span><span>            </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679151769"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../ghc-prim-0.5.2.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Types.html#Bool"><span class="hs-identifier hs-type">Bool</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679151769"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="GHC.Base.html#Maybe"><span class="hs-identifier hs-type">Maybe</span></a><span> </span><a href="#local-6989586621679151769"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-292"></a><a name="find"><a href="Data.OldList.html#find"><span class="hs-identifier">find</span></a></a><span> </span><a name="local-6989586621679151784"><a href="#local-6989586621679151784"><span class="hs-identifier">p</span></a></a><span>          </span><span class="hs-glyph">=</span><span> </span><a href="Data.Maybe.html#listToMaybe"><span class="hs-identifier hs-var">listToMaybe</span></a><span> </span><a href="GHC.Base.html#."><span class="hs-operator hs-var">.</span></a><span> </span><a href="GHC.List.html#filter"><span class="hs-identifier hs-var">filter</span></a><span> </span><a href="#local-6989586621679151784"><span class="hs-identifier hs-var">p</span></a><span>
</span><a name="line-293"></a><span>
</span><a name="line-294"></a><span class="hs-comment">-- | The 'findIndex' function takes a predicate and a list and returns</span><span>
</span><a name="line-295"></a><span class="hs-comment">-- the index of the first element in the list satisfying the predicate,</span><span>
</span><a name="line-296"></a><span class="hs-comment">-- or 'Nothing' if there is no such element.</span><span>
</span><a name="line-297"></a><span class="hs-comment">--</span><span>
</span><a name="line-298"></a><span class="hs-comment">-- &gt;&gt;&gt; findIndex isSpace &quot;Hello World!&quot;</span><span>
</span><a name="line-299"></a><span class="hs-comment">-- Just 5</span><span>
</span><a name="line-300"></a><span class="hs-identifier">findIndex</span><span>       </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679151768"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../ghc-prim-0.5.2.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Types.html#Bool"><span class="hs-identifier hs-type">Bool</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679151768"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="GHC.Base.html#Maybe"><span class="hs-identifier hs-type">Maybe</span></a><span> </span><a href="../ghc-prim-0.5.2.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Types.html#Int"><span class="hs-identifier hs-type">Int</span></a><span>
</span><a name="line-301"></a><a name="findIndex"><a href="Data.OldList.html#findIndex"><span class="hs-identifier">findIndex</span></a></a><span> </span><a name="local-6989586621679151785"><a href="#local-6989586621679151785"><span class="hs-identifier">p</span></a></a><span>     </span><span class="hs-glyph">=</span><span> </span><a href="Data.Maybe.html#listToMaybe"><span class="hs-identifier hs-var">listToMaybe</span></a><span> </span><a href="GHC.Base.html#."><span class="hs-operator hs-var">.</span></a><span> </span><a href="Data.OldList.html#findIndices"><span class="hs-identifier hs-var">findIndices</span></a><span> </span><a href="#local-6989586621679151785"><span class="hs-identifier hs-var">p</span></a><span>
</span><a name="line-302"></a><span>
</span><a name="line-303"></a><span class="hs-comment">-- | The 'findIndices' function extends 'findIndex', by returning the</span><span>
</span><a name="line-304"></a><span class="hs-comment">-- indices of all elements satisfying the predicate, in ascending order.</span><span>
</span><a name="line-305"></a><span class="hs-comment">--</span><span>
</span><a name="line-306"></a><span class="hs-comment">-- &gt;&gt;&gt; findIndices (`elem` &quot;aeiou&quot;) &quot;Hello World!&quot;</span><span>
</span><a name="line-307"></a><span class="hs-comment">-- [1,4,7]</span><span>
</span><a name="line-308"></a><span class="hs-identifier">findIndices</span><span>      </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679151767"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../ghc-prim-0.5.2.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Types.html#Bool"><span class="hs-identifier hs-type">Bool</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679151767"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="../ghc-prim-0.5.2.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Types.html#Int"><span class="hs-identifier hs-type">Int</span></a><span class="hs-special">]</span><span>
</span><a name="line-309"></a><span class="hs-cpp">#if defined(USE_REPORT_PRELUDE)
</span><span class="hs-identifier">findIndices</span><span> </span><span class="hs-identifier">p</span><span> </span><span class="hs-identifier">xs</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span> </span><span class="hs-identifier">i</span><span> </span><span class="hs-glyph">|</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">x</span><span class="hs-special">,</span><span class="hs-identifier">i</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier">zip</span><span> </span><span class="hs-identifier">xs</span><span> </span><span class="hs-special">[</span><span class="hs-number">0</span><span class="hs-glyph">..</span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">p</span><span> </span><span class="hs-identifier">x</span><span class="hs-special">]</span><span>
</span><a name="line-311"></a><span class="hs-cpp">#else
</span><span class="hs-comment">-- Efficient definition, adapted from Data.Sequence</span><span>
</span><a name="line-313"></a><span class="hs-pragma">{-# INLINE</span><span> </span><span class="hs-pragma">findIndices</span><span> </span><span class="hs-pragma">#-}</span><span>
</span><a name="line-314"></a><a name="findIndices"><a href="Data.OldList.html#findIndices"><span class="hs-identifier">findIndices</span></a></a><span> </span><a name="local-6989586621679151786"><a href="#local-6989586621679151786"><span class="hs-identifier">p</span></a></a><span> </span><a name="local-6989586621679151787"><a href="#local-6989586621679151787"><span class="hs-identifier">ls</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="GHC.Base.html#build"><span class="hs-identifier hs-var">build</span></a><span> </span><a href="GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span> </span><span class="hs-glyph">\</span><a name="local-6989586621679151788"><a href="#local-6989586621679151788"><span class="hs-identifier">c</span></a></a><span> </span><a name="local-6989586621679151789"><a href="#local-6989586621679151789"><span class="hs-identifier">n</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-315"></a><span>  </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679151790"><a href="#local-6989586621679151790"><span class="hs-identifier">go</span></a></a><span> </span><a name="local-6989586621679151791"><a href="#local-6989586621679151791"><span class="hs-identifier">x</span></a></a><span> </span><a name="local-6989586621679151792"><a href="#local-6989586621679151792"><span class="hs-identifier">r</span></a></a><span> </span><a name="local-6989586621679151793"><a href="#local-6989586621679151793"><span class="hs-identifier">k</span></a></a><span> </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621679151786"><span class="hs-identifier hs-var">p</span></a><span> </span><a href="#local-6989586621679151791"><span class="hs-identifier hs-var">x</span></a><span>       </span><span class="hs-glyph">=</span><span> </span><a href="../ghc-prim-0.5.2.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Types.html#I%23"><span class="hs-identifier hs-var">I#</span></a><span> </span><a href="#local-6989586621679151793"><span class="hs-identifier hs-var">k</span></a><span> </span><span class="hs-special">`</span><a href="#local-6989586621679151788"><span class="hs-identifier hs-var">c</span></a><span class="hs-special">`</span><span> </span><a href="#local-6989586621679151792"><span class="hs-identifier hs-var">r</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679151793"><span class="hs-identifier hs-var">k</span></a><span> </span><a href="../ghc-prim-0.5.2.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Prim.html#%2B%23"><span class="hs-operator hs-var">+#</span></a><span> </span><span class="hs-number">1#</span><span class="hs-special">)</span><span>
</span><a name="line-316"></a><span>               </span><span class="hs-glyph">|</span><span> </span><a href="GHC.Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679151792"><span class="hs-identifier hs-var">r</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679151793"><span class="hs-identifier hs-var">k</span></a><span> </span><a href="../ghc-prim-0.5.2.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Prim.html#%2B%23"><span class="hs-operator hs-var">+#</span></a><span> </span><span class="hs-number">1#</span><span class="hs-special">)</span><span>
</span><a name="line-317"></a><span>  </span><span class="hs-keyword">in</span><span> </span><a href="GHC.Base.html#foldr"><span class="hs-identifier hs-var">foldr</span></a><span> </span><a href="#local-6989586621679151790"><span class="hs-identifier hs-var">go</span></a><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679151789"><span class="hs-identifier hs-var">n</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679151787"><span class="hs-identifier hs-var">ls</span></a><span> </span><span class="hs-number">0#</span><span>
</span><a name="line-318"></a><span class="hs-cpp">#endif  /* USE_REPORT_PRELUDE */
</span><span>
</span><a name="line-320"></a><span class="hs-comment">-- | The 'isPrefixOf' function takes two lists and returns 'True'</span><span>
</span><a name="line-321"></a><span class="hs-comment">-- iff the first list is a prefix of the second.</span><span>
</span><a name="line-322"></a><span class="hs-comment">--</span><span>
</span><a name="line-323"></a><span class="hs-comment">-- &gt;&gt;&gt; &quot;Hello&quot; `isPrefixOf` &quot;Hello World!&quot;</span><span>
</span><a name="line-324"></a><span class="hs-comment">-- True</span><span>
</span><a name="line-325"></a><span class="hs-comment">--</span><span>
</span><a name="line-326"></a><span class="hs-comment">-- &gt;&gt;&gt; &quot;Hello&quot; `isPrefixOf` &quot;Wello Horld!&quot;</span><span>
</span><a name="line-327"></a><span class="hs-comment">-- False</span><span>
</span><a name="line-328"></a><span class="hs-identifier">isPrefixOf</span><span>              </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><a href="../ghc-prim-0.5.2.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Classes.html#Eq"><span class="hs-identifier hs-type">Eq</span></a><span> </span><a href="#local-6989586621679151766"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679151766"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679151766"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../ghc-prim-0.5.2.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Types.html#Bool"><span class="hs-identifier hs-type">Bool</span></a><span>
</span><a name="line-329"></a><a name="isPrefixOf"><a href="Data.OldList.html#isPrefixOf"><span class="hs-identifier">isPrefixOf</span></a></a><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-identifier">_</span><span>         </span><span class="hs-glyph">=</span><span>  </span><a href="../ghc-prim-0.5.2.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Types.html#True"><span class="hs-identifier hs-var">True</span></a><span>
</span><a name="line-330"></a><span class="hs-identifier">isPrefixOf</span><span> </span><span class="hs-identifier">_</span><span>  </span><span class="hs-special">[</span><span class="hs-special">]</span><span>        </span><span class="hs-glyph">=</span><span>  </span><a href="../ghc-prim-0.5.2.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Types.html#False"><span class="hs-identifier hs-var">False</span></a><span>
</span><a name="line-331"></a><span class="hs-identifier">isPrefixOf</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679151794"><a href="#local-6989586621679151794"><span class="hs-identifier">x</span></a></a><span class="hs-glyph">:</span><a name="local-6989586621679151795"><a href="#local-6989586621679151795"><span class="hs-identifier">xs</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679151796"><a href="#local-6989586621679151796"><span class="hs-identifier">y</span></a></a><span class="hs-glyph">:</span><a name="local-6989586621679151797"><a href="#local-6989586621679151797"><span class="hs-identifier">ys</span></a></a><span class="hs-special">)</span><span class="hs-glyph">=</span><span>  </span><a href="#local-6989586621679151794"><span class="hs-identifier hs-var">x</span></a><span> </span><a href="../ghc-prim-0.5.2.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Classes.html#%3D%3D"><span class="hs-operator hs-var">==</span></a><span> </span><a href="#local-6989586621679151796"><span class="hs-identifier hs-var">y</span></a><span> </span><a href="../ghc-prim-0.5.2.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Classes.html#%26%26"><span class="hs-operator hs-var">&amp;&amp;</span></a><span> </span><a href="Data.OldList.html#isPrefixOf"><span class="hs-identifier hs-var">isPrefixOf</span></a><span> </span><a href="#local-6989586621679151795"><span class="hs-identifier hs-var">xs</span></a><span> </span><a href="#local-6989586621679151797"><span class="hs-identifier hs-var">ys</span></a><span>
</span><a name="line-332"></a><span>
</span><a name="line-333"></a><span class="hs-comment">-- | The 'isSuffixOf' function takes two lists and returns 'True' iff</span><span>
</span><a name="line-334"></a><span class="hs-comment">-- the first list is a suffix of the second. The second list must be</span><span>
</span><a name="line-335"></a><span class="hs-comment">-- finite.</span><span>
</span><a name="line-336"></a><span class="hs-comment">--</span><span>
</span><a name="line-337"></a><span class="hs-comment">-- &gt;&gt;&gt; &quot;ld!&quot; `isSuffixOf` &quot;Hello World!&quot;</span><span>
</span><a name="line-338"></a><span class="hs-comment">-- True</span><span>
</span><a name="line-339"></a><span class="hs-comment">--</span><span>
</span><a name="line-340"></a><span class="hs-comment">-- &gt;&gt;&gt; &quot;World&quot; `isSuffixOf` &quot;Hello World!&quot;</span><span>
</span><a name="line-341"></a><span class="hs-comment">-- False</span><span>
</span><a name="line-342"></a><span class="hs-identifier">isSuffixOf</span><span>              </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><a href="../ghc-prim-0.5.2.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Classes.html#Eq"><span class="hs-identifier hs-type">Eq</span></a><span> </span><a href="#local-6989586621679151765"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679151765"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679151765"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../ghc-prim-0.5.2.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Types.html#Bool"><span class="hs-identifier hs-type">Bool</span></a><span>
</span><a name="line-343"></a><a name="local-6989586621679151798"><a href="#local-6989586621679151798"><span class="hs-identifier">ns</span></a></a><span> </span><span class="hs-special">`</span><a name="isSuffixOf"><a href="Data.OldList.html#isSuffixOf"><span class="hs-identifier">isSuffixOf</span></a></a><span class="hs-special">`</span><span> </span><a name="local-6989586621679151799"><a href="#local-6989586621679151799"><span class="hs-identifier">hs</span></a></a><span>      </span><span class="hs-glyph">=</span><span> </span><a href="Data.Maybe.html#maybe"><span class="hs-identifier hs-var">maybe</span></a><span> </span><a href="../ghc-prim-0.5.2.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Types.html#False"><span class="hs-identifier hs-var">False</span></a><span> </span><a href="GHC.Base.html#id"><span class="hs-identifier hs-var">id</span></a><span> </span><a href="GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-344"></a><span>      </span><a name="local-6989586621679151800"><a href="#local-6989586621679151800"><span class="hs-identifier">delta</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Data.OldList.html#dropLengthMaybe"><span class="hs-identifier hs-var">dropLengthMaybe</span></a><span> </span><a href="#local-6989586621679151798"><span class="hs-identifier hs-var">ns</span></a><span> </span><a href="#local-6989586621679151799"><span class="hs-identifier hs-var">hs</span></a><span>
</span><a name="line-345"></a><span>      </span><a href="GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><a href="GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span> </span><a href="#local-6989586621679151798"><span class="hs-identifier hs-var">ns</span></a><span> </span><a href="../ghc-prim-0.5.2.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Classes.html#%3D%3D"><span class="hs-operator hs-var">==</span></a><span> </span><a href="Data.OldList.html#dropLength"><span class="hs-identifier hs-var">dropLength</span></a><span> </span><a href="#local-6989586621679151800"><span class="hs-identifier hs-var">delta</span></a><span> </span><a href="#local-6989586621679151799"><span class="hs-identifier hs-var">hs</span></a><span>
</span><a name="line-346"></a><span>      </span><span class="hs-comment">-- Since dropLengthMaybe ns hs succeeded, we know that (if hs is finite)</span><span>
</span><a name="line-347"></a><span>      </span><span class="hs-comment">-- length ns + length delta = length hs</span><span>
</span><a name="line-348"></a><span>      </span><span class="hs-comment">-- so dropping the length of delta from hs will yield a suffix exactly</span><span>
</span><a name="line-349"></a><span>      </span><span class="hs-comment">-- the length of ns.</span><span>
</span><a name="line-350"></a><span>
</span><a name="line-351"></a><span class="hs-comment">-- A version of drop that drops the length of the first argument from the</span><span>
</span><a name="line-352"></a><span class="hs-comment">-- second argument. If xs is longer than ys, xs will not be traversed in its</span><span>
</span><a name="line-353"></a><span class="hs-comment">-- entirety.  dropLength is also generally faster than (drop . length)</span><span>
</span><a name="line-354"></a><span class="hs-comment">-- Both this and dropLengthMaybe could be written as folds over their first</span><span>
</span><a name="line-355"></a><span class="hs-comment">-- arguments, but this reduces clarity with no benefit to isSuffixOf.</span><span>
</span><a name="line-356"></a><span class="hs-comment">--</span><span>
</span><a name="line-357"></a><span class="hs-comment">-- &gt;&gt;&gt; dropLength &quot;Hello&quot; &quot;Holla world&quot;</span><span>
</span><a name="line-358"></a><span class="hs-comment">-- &quot; world&quot;</span><span>
</span><a name="line-359"></a><span class="hs-comment">--</span><span>
</span><a name="line-360"></a><span class="hs-comment">-- &gt;&gt;&gt; dropLength [1..] [1,2,3]</span><span>
</span><a name="line-361"></a><span class="hs-comment">-- []</span><span>
</span><a name="line-362"></a><span class="hs-identifier">dropLength</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679151763"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679151764"><span class="hs-identifier hs-type">b</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679151764"><span class="hs-identifier hs-type">b</span></a><span class="hs-special">]</span><span>
</span><a name="line-363"></a><a name="dropLength"><a href="Data.OldList.html#dropLength"><span class="hs-identifier">dropLength</span></a></a><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><a name="local-6989586621679151801"><a href="#local-6989586621679151801"><span class="hs-identifier">y</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679151801"><span class="hs-identifier hs-var">y</span></a><span>
</span><a name="line-364"></a><span class="hs-identifier">dropLength</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-365"></a><span class="hs-identifier">dropLength</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">_</span><span class="hs-glyph">:</span><a name="local-6989586621679151802"><a href="#local-6989586621679151802"><span class="hs-identifier">x'</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">_</span><span class="hs-glyph">:</span><a name="local-6989586621679151803"><a href="#local-6989586621679151803"><span class="hs-identifier">y'</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.OldList.html#dropLength"><span class="hs-identifier hs-var">dropLength</span></a><span> </span><a href="#local-6989586621679151802"><span class="hs-identifier hs-var">x'</span></a><span> </span><a href="#local-6989586621679151803"><span class="hs-identifier hs-var">y'</span></a><span>
</span><a name="line-366"></a><span>
</span><a name="line-367"></a><span class="hs-comment">-- A version of dropLength that returns Nothing if the second list runs out of</span><span>
</span><a name="line-368"></a><span class="hs-comment">-- elements before the first.</span><span>
</span><a name="line-369"></a><span class="hs-comment">--</span><span>
</span><a name="line-370"></a><span class="hs-comment">-- &gt;&gt;&gt; dropLengthMaybe [1..] [1,2,3]</span><span>
</span><a name="line-371"></a><span class="hs-comment">-- Nothing</span><span>
</span><a name="line-372"></a><span class="hs-identifier">dropLengthMaybe</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679151761"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679151762"><span class="hs-identifier hs-type">b</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="GHC.Base.html#Maybe"><span class="hs-identifier hs-type">Maybe</span></a><span> </span><span class="hs-special">[</span><a href="#local-6989586621679151762"><span class="hs-identifier hs-type">b</span></a><span class="hs-special">]</span><span>
</span><a name="line-373"></a><a name="dropLengthMaybe"><a href="Data.OldList.html#dropLengthMaybe"><span class="hs-identifier">dropLengthMaybe</span></a></a><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><a name="local-6989586621679151804"><a href="#local-6989586621679151804"><span class="hs-identifier">y</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><a href="#local-6989586621679151804"><span class="hs-identifier hs-var">y</span></a><span>
</span><a name="line-374"></a><span class="hs-identifier">dropLengthMaybe</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="GHC.Base.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a><span>
</span><a name="line-375"></a><span class="hs-identifier">dropLengthMaybe</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">_</span><span class="hs-glyph">:</span><a name="local-6989586621679151805"><a href="#local-6989586621679151805"><span class="hs-identifier">x'</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">_</span><span class="hs-glyph">:</span><a name="local-6989586621679151806"><a href="#local-6989586621679151806"><span class="hs-identifier">y'</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.OldList.html#dropLengthMaybe"><span class="hs-identifier hs-var">dropLengthMaybe</span></a><span> </span><a href="#local-6989586621679151805"><span class="hs-identifier hs-var">x'</span></a><span> </span><a href="#local-6989586621679151806"><span class="hs-identifier hs-var">y'</span></a><span>
</span><a name="line-376"></a><span>
</span><a name="line-377"></a><span class="hs-comment">-- | The 'isInfixOf' function takes two lists and returns 'True'</span><span>
</span><a name="line-378"></a><span class="hs-comment">-- iff the first list is contained, wholly and intact,</span><span>
</span><a name="line-379"></a><span class="hs-comment">-- anywhere within the second.</span><span>
</span><a name="line-380"></a><span class="hs-comment">--</span><span>
</span><a name="line-381"></a><span class="hs-comment">-- &gt;&gt;&gt; isInfixOf &quot;Haskell&quot; &quot;I really like Haskell.&quot;</span><span>
</span><a name="line-382"></a><span class="hs-comment">-- True</span><span>
</span><a name="line-383"></a><span class="hs-comment">--</span><span>
</span><a name="line-384"></a><span class="hs-comment">-- &gt;&gt;&gt; isInfixOf &quot;Ial&quot; &quot;I really like Haskell.&quot;</span><span>
</span><a name="line-385"></a><span class="hs-comment">-- False</span><span>
</span><a name="line-386"></a><span class="hs-identifier">isInfixOf</span><span>               </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><a href="../ghc-prim-0.5.2.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Classes.html#Eq"><span class="hs-identifier hs-type">Eq</span></a><span> </span><a href="#local-6989586621679151760"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679151760"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679151760"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../ghc-prim-0.5.2.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Types.html#Bool"><span class="hs-identifier hs-type">Bool</span></a><span>
</span><a name="line-387"></a><a name="isInfixOf"><a href="Data.OldList.html#isInfixOf"><span class="hs-identifier">isInfixOf</span></a></a><span> </span><a name="local-6989586621679151807"><a href="#local-6989586621679151807"><span class="hs-identifier">needle</span></a></a><span> </span><a name="local-6989586621679151808"><a href="#local-6989586621679151808"><span class="hs-identifier">haystack</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="GHC.List.html#any"><span class="hs-identifier hs-var">any</span></a><span> </span><span class="hs-special">(</span><a href="Data.OldList.html#isPrefixOf"><span class="hs-identifier hs-var">isPrefixOf</span></a><span> </span><a href="#local-6989586621679151807"><span class="hs-identifier hs-var">needle</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Data.OldList.html#tails"><span class="hs-identifier hs-var">tails</span></a><span> </span><a href="#local-6989586621679151808"><span class="hs-identifier hs-var">haystack</span></a><span class="hs-special">)</span><span>
</span><a name="line-388"></a><span>
</span><a name="line-389"></a><span class="hs-comment">-- | /O(n^2)/. The 'nub' function removes duplicate elements from a list.</span><span>
</span><a name="line-390"></a><span class="hs-comment">-- In particular, it keeps only the first occurrence of each element.</span><span>
</span><a name="line-391"></a><span class="hs-comment">-- (The name 'nub' means \`essence\'.)</span><span>
</span><a name="line-392"></a><span class="hs-comment">-- It is a special case of 'nubBy', which allows the programmer to supply</span><span>
</span><a name="line-393"></a><span class="hs-comment">-- their own equality test.</span><span>
</span><a name="line-394"></a><span class="hs-comment">--</span><span>
</span><a name="line-395"></a><span class="hs-comment">-- &gt;&gt;&gt; nub [1,2,3,4,3,2,1,2,4,3,5]</span><span>
</span><a name="line-396"></a><span class="hs-comment">-- [1,2,3,4,5]</span><span>
</span><a name="line-397"></a><span class="hs-identifier">nub</span><span>                     </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><a href="../ghc-prim-0.5.2.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Classes.html#Eq"><span class="hs-identifier hs-type">Eq</span></a><span> </span><a href="#local-6989586621679151759"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679151759"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679151759"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">]</span><span>
</span><a name="line-398"></a><a name="nub"><a href="Data.OldList.html#nub"><span class="hs-identifier">nub</span></a></a><span>                     </span><span class="hs-glyph">=</span><span>  </span><a href="Data.OldList.html#nubBy"><span class="hs-identifier hs-var">nubBy</span></a><span> </span><span class="hs-special">(</span><a href="../ghc-prim-0.5.2.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Classes.html#%3D%3D"><span class="hs-operator hs-var">==</span></a><span class="hs-special">)</span><span>
</span><a name="line-399"></a><span>
</span><a name="line-400"></a><span class="hs-comment">-- | The 'nubBy' function behaves just like 'nub', except it uses a</span><span>
</span><a name="line-401"></a><span class="hs-comment">-- user-supplied equality predicate instead of the overloaded '=='</span><span>
</span><a name="line-402"></a><span class="hs-comment">-- function.</span><span>
</span><a name="line-403"></a><span class="hs-comment">--</span><span>
</span><a name="line-404"></a><span class="hs-comment">-- &gt;&gt;&gt; nubBy (\x y -&gt; mod x 3 == mod y 3) [1,2,4,5,6]</span><span>
</span><a name="line-405"></a><span class="hs-comment">-- [1,2,6]</span><span>
</span><a name="line-406"></a><span class="hs-identifier">nubBy</span><span>                   </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679151758"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679151758"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../ghc-prim-0.5.2.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Types.html#Bool"><span class="hs-identifier hs-type">Bool</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679151758"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679151758"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">]</span><span>
</span><a name="line-407"></a><span class="hs-cpp">#if defined(USE_REPORT_PRELUDE)
</span><span class="hs-identifier">nubBy</span><span> </span><span class="hs-identifier">eq</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>             </span><span class="hs-glyph">=</span><span>  </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-409"></a><span class="hs-identifier">nubBy</span><span> </span><span class="hs-identifier">eq</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">x</span><span class="hs-glyph">:</span><span class="hs-identifier">xs</span><span class="hs-special">)</span><span>         </span><span class="hs-glyph">=</span><span>  </span><span class="hs-identifier">x</span><span> </span><span class="hs-glyph">:</span><span> </span><span class="hs-identifier">nubBy</span><span> </span><span class="hs-identifier">eq</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">filter</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span> </span><span class="hs-identifier">y</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">not</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">eq</span><span> </span><span class="hs-identifier">x</span><span> </span><span class="hs-identifier">y</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-identifier">xs</span><span class="hs-special">)</span><span>
</span><a name="line-410"></a><span class="hs-cpp">#else
</span><span class="hs-comment">-- stolen from HBC</span><span>
</span><a name="line-412"></a><a name="nubBy"><a href="Data.OldList.html#nubBy"><span class="hs-identifier">nubBy</span></a></a><span> </span><a name="local-6989586621679151809"><a href="#local-6989586621679151809"><span class="hs-identifier">eq</span></a></a><span> </span><a name="local-6989586621679151810"><a href="#local-6989586621679151810"><span class="hs-identifier">l</span></a></a><span>              </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679151811"><span class="hs-identifier hs-var">nubBy'</span></a><span> </span><a href="#local-6989586621679151810"><span class="hs-identifier hs-var">l</span></a><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-413"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-414"></a><span>    </span><a name="local-6989586621679151811"><a href="#local-6989586621679151811"><span class="hs-identifier">nubBy'</span></a></a><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-identifier">_</span><span>         </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-415"></a><span>    </span><span class="hs-identifier">nubBy'</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679151812"><a href="#local-6989586621679151812"><span class="hs-identifier">y</span></a></a><span class="hs-glyph">:</span><a name="local-6989586621679151813"><a href="#local-6989586621679151813"><span class="hs-identifier">ys</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621679151814"><a href="#local-6989586621679151814"><span class="hs-identifier">xs</span></a></a><span>
</span><a name="line-416"></a><span>       </span><span class="hs-glyph">|</span><span> </span><a href="Data.OldList.html#elem_by"><span class="hs-identifier hs-var">elem_by</span></a><span> </span><a href="#local-6989586621679151809"><span class="hs-identifier hs-var">eq</span></a><span> </span><a href="#local-6989586621679151812"><span class="hs-identifier hs-var">y</span></a><span> </span><a href="#local-6989586621679151814"><span class="hs-identifier hs-var">xs</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679151811"><span class="hs-identifier hs-var">nubBy'</span></a><span> </span><a href="#local-6989586621679151813"><span class="hs-identifier hs-var">ys</span></a><span> </span><a href="#local-6989586621679151814"><span class="hs-identifier hs-var">xs</span></a><span>
</span><a name="line-417"></a><span>       </span><span class="hs-glyph">|</span><span> </span><a href="GHC.Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a><span>       </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679151812"><span class="hs-identifier hs-var">y</span></a><span> </span><span class="hs-glyph">:</span><span> </span><a href="#local-6989586621679151811"><span class="hs-identifier hs-var">nubBy'</span></a><span> </span><a href="#local-6989586621679151813"><span class="hs-identifier hs-var">ys</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679151812"><span class="hs-identifier hs-var">y</span></a><span class="hs-glyph">:</span><a href="#local-6989586621679151814"><span class="hs-identifier hs-var">xs</span></a><span class="hs-special">)</span><span>
</span><a name="line-418"></a><span>
</span><a name="line-419"></a><span class="hs-comment">-- Not exported:</span><span>
</span><a name="line-420"></a><span class="hs-comment">-- Note that we keep the call to `eq` with arguments in the</span><span>
</span><a name="line-421"></a><span class="hs-comment">-- same order as in the reference (prelude) implementation,</span><span>
</span><a name="line-422"></a><span class="hs-comment">-- and that this order is different from how `elem` calls (==).</span><span>
</span><a name="line-423"></a><span class="hs-comment">-- See #2528, #3280 and #7913.</span><span>
</span><a name="line-424"></a><span class="hs-comment">-- 'xs' is the list of things we've seen so far,</span><span>
</span><a name="line-425"></a><span class="hs-comment">-- 'y' is the potential new element</span><span>
</span><a name="line-426"></a><span class="hs-identifier">elem_by</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679151757"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679151757"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../ghc-prim-0.5.2.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Types.html#Bool"><span class="hs-identifier hs-type">Bool</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679151757"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679151757"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../ghc-prim-0.5.2.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Types.html#Bool"><span class="hs-identifier hs-type">Bool</span></a><span>
</span><a name="line-427"></a><a name="elem_by"><a href="Data.OldList.html#elem_by"><span class="hs-identifier">elem_by</span></a></a><span> </span><span class="hs-identifier">_</span><span>  </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>         </span><span class="hs-glyph">=</span><span>  </span><a href="../ghc-prim-0.5.2.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Types.html#False"><span class="hs-identifier hs-var">False</span></a><span>
</span><a name="line-428"></a><span class="hs-identifier">elem_by</span><span> </span><a name="local-6989586621679151815"><a href="#local-6989586621679151815"><span class="hs-identifier">eq</span></a></a><span> </span><a name="local-6989586621679151816"><a href="#local-6989586621679151816"><span class="hs-identifier">y</span></a></a><span> </span><span class="hs-special">(</span><a name="local-6989586621679151817"><a href="#local-6989586621679151817"><span class="hs-identifier">x</span></a></a><span class="hs-glyph">:</span><a name="local-6989586621679151818"><a href="#local-6989586621679151818"><span class="hs-identifier">xs</span></a></a><span class="hs-special">)</span><span>     </span><span class="hs-glyph">=</span><span>  </span><a href="#local-6989586621679151817"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-special">`</span><a href="#local-6989586621679151815"><span class="hs-identifier hs-var">eq</span></a><span class="hs-special">`</span><span> </span><a href="#local-6989586621679151816"><span class="hs-identifier hs-var">y</span></a><span> </span><a href="../ghc-prim-0.5.2.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Classes.html#%7C%7C"><span class="hs-operator hs-var">||</span></a><span> </span><a href="Data.OldList.html#elem_by"><span class="hs-identifier hs-var">elem_by</span></a><span> </span><a href="#local-6989586621679151815"><span class="hs-identifier hs-var">eq</span></a><span> </span><a href="#local-6989586621679151816"><span class="hs-identifier hs-var">y</span></a><span> </span><a href="#local-6989586621679151818"><span class="hs-identifier hs-var">xs</span></a><span>
</span><a name="line-429"></a><span class="hs-cpp">#endif
</span><span>
</span><a name="line-431"></a><span>
</span><a name="line-432"></a><span class="hs-comment">-- | 'delete' @x@ removes the first occurrence of @x@ from its list argument.</span><span>
</span><a name="line-433"></a><span class="hs-comment">-- For example,</span><span>
</span><a name="line-434"></a><span class="hs-comment">--</span><span>
</span><a name="line-435"></a><span class="hs-comment">-- &gt;&gt;&gt; delete 'a' &quot;banana&quot;</span><span>
</span><a name="line-436"></a><span class="hs-comment">-- &quot;bnana&quot;</span><span>
</span><a name="line-437"></a><span class="hs-comment">--</span><span>
</span><a name="line-438"></a><span class="hs-comment">-- It is a special case of 'deleteBy', which allows the programmer to</span><span>
</span><a name="line-439"></a><span class="hs-comment">-- supply their own equality test.</span><span>
</span><a name="line-440"></a><span class="hs-identifier">delete</span><span>                  </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><a href="../ghc-prim-0.5.2.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Classes.html#Eq"><span class="hs-identifier hs-type">Eq</span></a><span> </span><a href="#local-6989586621679151756"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="#local-6989586621679151756"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679151756"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679151756"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">]</span><span>
</span><a name="line-441"></a><a name="delete"><a href="Data.OldList.html#delete"><span class="hs-identifier">delete</span></a></a><span>                  </span><span class="hs-glyph">=</span><span>  </span><a href="Data.OldList.html#deleteBy"><span class="hs-identifier hs-var">deleteBy</span></a><span> </span><span class="hs-special">(</span><a href="../ghc-prim-0.5.2.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Classes.html#%3D%3D"><span class="hs-operator hs-var">==</span></a><span class="hs-special">)</span><span>
</span><a name="line-442"></a><span>
</span><a name="line-443"></a><span class="hs-comment">-- | The 'deleteBy' function behaves like 'delete', but takes a</span><span>
</span><a name="line-444"></a><span class="hs-comment">-- user-supplied equality predicate.</span><span>
</span><a name="line-445"></a><span class="hs-comment">--</span><span>
</span><a name="line-446"></a><span class="hs-comment">-- &gt;&gt;&gt; deleteBy (&lt;=) 4 [1..10]</span><span>
</span><a name="line-447"></a><span class="hs-comment">-- [1,2,3,5,6,7,8,9,10]</span><span>
</span><a name="line-448"></a><span class="hs-identifier">deleteBy</span><span>                </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679151755"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679151755"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../ghc-prim-0.5.2.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Types.html#Bool"><span class="hs-identifier hs-type">Bool</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679151755"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679151755"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679151755"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">]</span><span>
</span><a name="line-449"></a><a name="deleteBy"><a href="Data.OldList.html#deleteBy"><span class="hs-identifier">deleteBy</span></a></a><span> </span><span class="hs-identifier">_</span><span>  </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>        </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-450"></a><span class="hs-identifier">deleteBy</span><span> </span><a name="local-6989586621679151819"><a href="#local-6989586621679151819"><span class="hs-identifier">eq</span></a></a><span> </span><a name="local-6989586621679151820"><a href="#local-6989586621679151820"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-special">(</span><a name="local-6989586621679151821"><a href="#local-6989586621679151821"><span class="hs-identifier">y</span></a></a><span class="hs-glyph">:</span><a name="local-6989586621679151822"><a href="#local-6989586621679151822"><span class="hs-identifier">ys</span></a></a><span class="hs-special">)</span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">if</span><span> </span><a href="#local-6989586621679151820"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-special">`</span><a href="#local-6989586621679151819"><span class="hs-identifier hs-var">eq</span></a><span class="hs-special">`</span><span> </span><a href="#local-6989586621679151821"><span class="hs-identifier hs-var">y</span></a><span> </span><span class="hs-keyword">then</span><span> </span><a href="#local-6989586621679151822"><span class="hs-identifier hs-var">ys</span></a><span> </span><span class="hs-keyword">else</span><span> </span><a href="#local-6989586621679151821"><span class="hs-identifier hs-var">y</span></a><span> </span><span class="hs-glyph">:</span><span> </span><a href="Data.OldList.html#deleteBy"><span class="hs-identifier hs-var">deleteBy</span></a><span> </span><a href="#local-6989586621679151819"><span class="hs-identifier hs-var">eq</span></a><span> </span><a href="#local-6989586621679151820"><span class="hs-identifier hs-var">x</span></a><span> </span><a href="#local-6989586621679151822"><span class="hs-identifier hs-var">ys</span></a><span>
</span><a name="line-451"></a><span>
</span><a name="line-452"></a><span class="hs-comment">-- | The '\\' function is list difference (non-associative).</span><span>
</span><a name="line-453"></a><span class="hs-comment">-- In the result of @xs@ '\\' @ys@, the first occurrence of each element of</span><span>
</span><a name="line-454"></a><span class="hs-comment">-- @ys@ in turn (if any) has been removed from @xs@.  Thus</span><span>
</span><a name="line-455"></a><span class="hs-comment">--</span><span>
</span><a name="line-456"></a><span class="hs-comment">-- &gt; (xs ++ ys) \\ xs == ys.</span><span>
</span><a name="line-457"></a><span class="hs-comment">--</span><span>
</span><a name="line-458"></a><span class="hs-comment">-- &gt;&gt;&gt; &quot;Hello World!&quot; \\ &quot;ell W&quot;</span><span>
</span><a name="line-459"></a><span class="hs-comment">-- &quot;Hoorld!&quot;</span><span>
</span><a name="line-460"></a><span class="hs-comment">--</span><span>
</span><a name="line-461"></a><span class="hs-comment">-- It is a special case of 'deleteFirstsBy', which allows the programmer</span><span>
</span><a name="line-462"></a><span class="hs-comment">-- to supply their own equality test.</span><span>
</span><a name="line-463"></a><span>
</span><a name="line-464"></a><span class="hs-special">(</span><span class="hs-operator">\\</span><span class="hs-special">)</span><span>                    </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><a href="../ghc-prim-0.5.2.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Classes.html#Eq"><span class="hs-identifier hs-type">Eq</span></a><span> </span><a href="#local-6989586621679151754"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679151754"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679151754"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679151754"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">]</span><span>
</span><a name="line-465"></a><span class="hs-special">(</span><a name="%5C%5C"><a href="Data.OldList.html#%5C%5C"><span class="hs-operator">\\</span></a></a><span class="hs-special">)</span><span>                    </span><span class="hs-glyph">=</span><span>  </span><a href="GHC.List.html#foldl"><span class="hs-identifier hs-var">foldl</span></a><span> </span><span class="hs-special">(</span><a href="GHC.Base.html#flip"><span class="hs-identifier hs-var">flip</span></a><span> </span><a href="Data.OldList.html#delete"><span class="hs-identifier hs-var">delete</span></a><span class="hs-special">)</span><span>
</span><a name="line-466"></a><span>
</span><a name="line-467"></a><span class="hs-comment">-- | The 'union' function returns the list union of the two lists.</span><span>
</span><a name="line-468"></a><span class="hs-comment">-- For example,</span><span>
</span><a name="line-469"></a><span class="hs-comment">--</span><span>
</span><a name="line-470"></a><span class="hs-comment">-- &gt;&gt;&gt; &quot;dog&quot; `union` &quot;cow&quot;</span><span>
</span><a name="line-471"></a><span class="hs-comment">-- &quot;dogcw&quot;</span><span>
</span><a name="line-472"></a><span class="hs-comment">--</span><span>
</span><a name="line-473"></a><span class="hs-comment">-- Duplicates, and elements of the first list, are removed from the</span><span>
</span><a name="line-474"></a><span class="hs-comment">-- the second list, but if the first list contains duplicates, so will</span><span>
</span><a name="line-475"></a><span class="hs-comment">-- the result.</span><span>
</span><a name="line-476"></a><span class="hs-comment">-- It is a special case of 'unionBy', which allows the programmer to supply</span><span>
</span><a name="line-477"></a><span class="hs-comment">-- their own equality test.</span><span>
</span><a name="line-478"></a><span>
</span><a name="line-479"></a><span class="hs-identifier">union</span><span>                   </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><a href="../ghc-prim-0.5.2.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Classes.html#Eq"><span class="hs-identifier hs-type">Eq</span></a><span> </span><a href="#local-6989586621679151753"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679151753"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679151753"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679151753"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">]</span><span>
</span><a name="line-480"></a><a name="union"><a href="Data.OldList.html#union"><span class="hs-identifier">union</span></a></a><span>                   </span><span class="hs-glyph">=</span><span> </span><a href="Data.OldList.html#unionBy"><span class="hs-identifier hs-var">unionBy</span></a><span> </span><span class="hs-special">(</span><a href="../ghc-prim-0.5.2.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Classes.html#%3D%3D"><span class="hs-operator hs-var">==</span></a><span class="hs-special">)</span><span>
</span><a name="line-481"></a><span>
</span><a name="line-482"></a><span class="hs-comment">-- | The 'unionBy' function is the non-overloaded version of 'union'.</span><span>
</span><a name="line-483"></a><span class="hs-identifier">unionBy</span><span>                 </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679151752"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679151752"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../ghc-prim-0.5.2.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Types.html#Bool"><span class="hs-identifier hs-type">Bool</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679151752"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679151752"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679151752"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">]</span><span>
</span><a name="line-484"></a><a name="unionBy"><a href="Data.OldList.html#unionBy"><span class="hs-identifier">unionBy</span></a></a><span> </span><a name="local-6989586621679151823"><a href="#local-6989586621679151823"><span class="hs-identifier">eq</span></a></a><span> </span><a name="local-6989586621679151824"><a href="#local-6989586621679151824"><span class="hs-identifier">xs</span></a></a><span> </span><a name="local-6989586621679151825"><a href="#local-6989586621679151825"><span class="hs-identifier">ys</span></a></a><span>        </span><span class="hs-glyph">=</span><span>  </span><a href="#local-6989586621679151824"><span class="hs-identifier hs-var">xs</span></a><span> </span><a href="GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a><span> </span><a href="GHC.List.html#foldl"><span class="hs-identifier hs-var">foldl</span></a><span> </span><span class="hs-special">(</span><a href="GHC.Base.html#flip"><span class="hs-identifier hs-var">flip</span></a><span> </span><span class="hs-special">(</span><a href="Data.OldList.html#deleteBy"><span class="hs-identifier hs-var">deleteBy</span></a><span> </span><a href="#local-6989586621679151823"><span class="hs-identifier hs-var">eq</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Data.OldList.html#nubBy"><span class="hs-identifier hs-var">nubBy</span></a><span> </span><a href="#local-6989586621679151823"><span class="hs-identifier hs-var">eq</span></a><span> </span><a href="#local-6989586621679151825"><span class="hs-identifier hs-var">ys</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679151824"><span class="hs-identifier hs-var">xs</span></a><span>
</span><a name="line-485"></a><span>
</span><a name="line-486"></a><span class="hs-comment">-- | The 'intersect' function takes the list intersection of two lists.</span><span>
</span><a name="line-487"></a><span class="hs-comment">-- For example,</span><span>
</span><a name="line-488"></a><span class="hs-comment">--</span><span>
</span><a name="line-489"></a><span class="hs-comment">-- &gt;&gt;&gt; [1,2,3,4] `intersect` [2,4,6,8]</span><span>
</span><a name="line-490"></a><span class="hs-comment">-- [2,4]</span><span>
</span><a name="line-491"></a><span class="hs-comment">--</span><span>
</span><a name="line-492"></a><span class="hs-comment">-- If the first list contains duplicates, so will the result.</span><span>
</span><a name="line-493"></a><span class="hs-comment">--</span><span>
</span><a name="line-494"></a><span class="hs-comment">-- &gt;&gt;&gt; [1,2,2,3,4] `intersect` [6,4,4,2]</span><span>
</span><a name="line-495"></a><span class="hs-comment">-- [2,2,4]</span><span>
</span><a name="line-496"></a><span class="hs-comment">--</span><span>
</span><a name="line-497"></a><span class="hs-comment">-- It is a special case of 'intersectBy', which allows the programmer to</span><span>
</span><a name="line-498"></a><span class="hs-comment">-- supply their own equality test. If the element is found in both the first</span><span>
</span><a name="line-499"></a><span class="hs-comment">-- and the second list, the element from the first list will be used.</span><span>
</span><a name="line-500"></a><span>
</span><a name="line-501"></a><span class="hs-identifier">intersect</span><span>               </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><a href="../ghc-prim-0.5.2.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Classes.html#Eq"><span class="hs-identifier hs-type">Eq</span></a><span> </span><a href="#local-6989586621679151751"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679151751"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679151751"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679151751"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">]</span><span>
</span><a name="line-502"></a><a name="intersect"><a href="Data.OldList.html#intersect"><span class="hs-identifier">intersect</span></a></a><span>               </span><span class="hs-glyph">=</span><span>  </span><a href="Data.OldList.html#intersectBy"><span class="hs-identifier hs-var">intersectBy</span></a><span> </span><span class="hs-special">(</span><a href="../ghc-prim-0.5.2.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Classes.html#%3D%3D"><span class="hs-operator hs-var">==</span></a><span class="hs-special">)</span><span>
</span><a name="line-503"></a><span>
</span><a name="line-504"></a><span class="hs-comment">-- | The 'intersectBy' function is the non-overloaded version of 'intersect'.</span><span>
</span><a name="line-505"></a><span class="hs-identifier">intersectBy</span><span>             </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679151750"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679151750"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../ghc-prim-0.5.2.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Types.html#Bool"><span class="hs-identifier hs-type">Bool</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679151750"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679151750"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679151750"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">]</span><span>
</span><a name="line-506"></a><a name="intersectBy"><a href="Data.OldList.html#intersectBy"><span class="hs-identifier">intersectBy</span></a></a><span> </span><span class="hs-identifier">_</span><span>  </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-identifier">_</span><span>     </span><span class="hs-glyph">=</span><span>  </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-507"></a><span class="hs-identifier">intersectBy</span><span> </span><span class="hs-identifier">_</span><span>  </span><span class="hs-identifier">_</span><span>  </span><span class="hs-special">[</span><span class="hs-special">]</span><span>    </span><span class="hs-glyph">=</span><span>  </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-508"></a><span class="hs-identifier">intersectBy</span><span> </span><a name="local-6989586621679151826"><a href="#local-6989586621679151826"><span class="hs-identifier">eq</span></a></a><span> </span><a name="local-6989586621679151827"><a href="#local-6989586621679151827"><span class="hs-identifier">xs</span></a></a><span> </span><a name="local-6989586621679151828"><a href="#local-6989586621679151828"><span class="hs-identifier">ys</span></a></a><span>    </span><span class="hs-glyph">=</span><span>  </span><span class="hs-special">[</span><a href="#local-6989586621679151829"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-glyph">|</span><span> </span><a name="local-6989586621679151829"><a href="#local-6989586621679151829"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-6989586621679151827"><span class="hs-identifier hs-var">xs</span></a><span class="hs-special">,</span><span> </span><a href="GHC.List.html#any"><span class="hs-identifier hs-var">any</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679151826"><span class="hs-identifier hs-var">eq</span></a><span> </span><a href="#local-6989586621679151829"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679151828"><span class="hs-identifier hs-var">ys</span></a><span class="hs-special">]</span><span>
</span><a name="line-509"></a><span>
</span><a name="line-510"></a><span class="hs-comment">-- | The 'intersperse' function takes an element and a list and</span><span>
</span><a name="line-511"></a><span class="hs-comment">-- \`intersperses\' that element between the elements of the list.</span><span>
</span><a name="line-512"></a><span class="hs-comment">-- For example,</span><span>
</span><a name="line-513"></a><span class="hs-comment">--</span><span>
</span><a name="line-514"></a><span class="hs-comment">-- &gt;&gt;&gt; intersperse ',' &quot;abcde&quot;</span><span>
</span><a name="line-515"></a><span class="hs-comment">-- &quot;a,b,c,d,e&quot;</span><span>
</span><a name="line-516"></a><span class="hs-identifier">intersperse</span><span>             </span><span class="hs-glyph">::</span><span> </span><a href="#local-6989586621679151749"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679151749"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679151749"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">]</span><span>
</span><a name="line-517"></a><a name="intersperse"><a href="Data.OldList.html#intersperse"><span class="hs-identifier">intersperse</span></a></a><span> </span><span class="hs-identifier">_</span><span>   </span><span class="hs-special">[</span><span class="hs-special">]</span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-518"></a><span class="hs-identifier">intersperse</span><span> </span><a name="local-6989586621679151830"><a href="#local-6989586621679151830"><span class="hs-identifier">sep</span></a></a><span> </span><span class="hs-special">(</span><a name="local-6989586621679151831"><a href="#local-6989586621679151831"><span class="hs-identifier">x</span></a></a><span class="hs-glyph">:</span><a name="local-6989586621679151832"><a href="#local-6989586621679151832"><span class="hs-identifier">xs</span></a></a><span class="hs-special">)</span><span>  </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679151831"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-glyph">:</span><span> </span><a href="Data.OldList.html#prependToAll"><span class="hs-identifier hs-var">prependToAll</span></a><span> </span><a href="#local-6989586621679151830"><span class="hs-identifier hs-var">sep</span></a><span> </span><a href="#local-6989586621679151832"><span class="hs-identifier hs-var">xs</span></a><span>
</span><a name="line-519"></a><span>
</span><a name="line-520"></a><span>
</span><a name="line-521"></a><span class="hs-comment">-- Not exported:</span><span>
</span><a name="line-522"></a><span class="hs-comment">-- We want to make every element in the 'intersperse'd list available</span><span>
</span><a name="line-523"></a><span class="hs-comment">-- as soon as possible to avoid space leaks. Experiments suggested that</span><span>
</span><a name="line-524"></a><span class="hs-comment">-- a separate top-level helper is more efficient than a local worker.</span><span>
</span><a name="line-525"></a><span class="hs-identifier">prependToAll</span><span>            </span><span class="hs-glyph">::</span><span> </span><a href="#local-6989586621679151748"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679151748"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679151748"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">]</span><span>
</span><a name="line-526"></a><a name="prependToAll"><a href="Data.OldList.html#prependToAll"><span class="hs-identifier">prependToAll</span></a></a><span> </span><span class="hs-identifier">_</span><span>   </span><span class="hs-special">[</span><span class="hs-special">]</span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-527"></a><span class="hs-identifier">prependToAll</span><span> </span><a name="local-6989586621679151833"><a href="#local-6989586621679151833"><span class="hs-identifier">sep</span></a></a><span> </span><span class="hs-special">(</span><a name="local-6989586621679151834"><a href="#local-6989586621679151834"><span class="hs-identifier">x</span></a></a><span class="hs-glyph">:</span><a name="local-6989586621679151835"><a href="#local-6989586621679151835"><span class="hs-identifier">xs</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679151833"><span class="hs-identifier hs-var">sep</span></a><span> </span><span class="hs-glyph">:</span><span> </span><a href="#local-6989586621679151834"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-glyph">:</span><span> </span><a href="Data.OldList.html#prependToAll"><span class="hs-identifier hs-var">prependToAll</span></a><span> </span><a href="#local-6989586621679151833"><span class="hs-identifier hs-var">sep</span></a><span> </span><a href="#local-6989586621679151835"><span class="hs-identifier hs-var">xs</span></a><span>
</span><a name="line-528"></a><span>
</span><a name="line-529"></a><span class="hs-comment">-- | 'intercalate' @xs xss@ is equivalent to @('concat' ('intersperse' xs xss))@.</span><span>
</span><a name="line-530"></a><span class="hs-comment">-- It inserts the list @xs@ in between the lists in @xss@ and concatenates the</span><span>
</span><a name="line-531"></a><span class="hs-comment">-- result.</span><span>
</span><a name="line-532"></a><span class="hs-comment">--</span><span>
</span><a name="line-533"></a><span class="hs-comment">-- &gt;&gt;&gt; intercalate &quot;, &quot; [&quot;Lorem&quot;, &quot;ipsum&quot;, &quot;dolor&quot;]</span><span>
</span><a name="line-534"></a><span class="hs-comment">-- &quot;Lorem, ipsum, dolor&quot;</span><span>
</span><a name="line-535"></a><span class="hs-identifier">intercalate</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679151747"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">[</span><a href="#local-6989586621679151747"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">]</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679151747"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">]</span><span>
</span><a name="line-536"></a><a name="intercalate"><a href="Data.OldList.html#intercalate"><span class="hs-identifier">intercalate</span></a></a><span> </span><a name="local-6989586621679151836"><a href="#local-6989586621679151836"><span class="hs-identifier">xs</span></a></a><span> </span><a name="local-6989586621679151837"><a href="#local-6989586621679151837"><span class="hs-identifier">xss</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="GHC.List.html#concat"><span class="hs-identifier hs-var">concat</span></a><span> </span><span class="hs-special">(</span><a href="Data.OldList.html#intersperse"><span class="hs-identifier hs-var">intersperse</span></a><span> </span><a href="#local-6989586621679151836"><span class="hs-identifier hs-var">xs</span></a><span> </span><a href="#local-6989586621679151837"><span class="hs-identifier hs-var">xss</span></a><span class="hs-special">)</span><span>
</span><a name="line-537"></a><span>
</span><a name="line-538"></a><span class="hs-comment">-- | The 'transpose' function transposes the rows and columns of its argument.</span><span>
</span><a name="line-539"></a><span class="hs-comment">-- For example,</span><span>
</span><a name="line-540"></a><span class="hs-comment">--</span><span>
</span><a name="line-541"></a><span class="hs-comment">-- &gt;&gt;&gt; transpose [[1,2,3],[4,5,6]]</span><span>
</span><a name="line-542"></a><span class="hs-comment">-- [[1,4],[2,5],[3,6]]</span><span>
</span><a name="line-543"></a><span class="hs-comment">--</span><span>
</span><a name="line-544"></a><span class="hs-comment">-- If some of the rows are shorter than the following rows, their elements are skipped:</span><span>
</span><a name="line-545"></a><span class="hs-comment">--</span><span>
</span><a name="line-546"></a><span class="hs-comment">-- &gt;&gt;&gt; transpose [[10,11],[20],[],[30,31,32]]</span><span>
</span><a name="line-547"></a><span class="hs-comment">-- [[10,20,30],[11,31],[32]]</span><span>
</span><a name="line-548"></a><span class="hs-identifier">transpose</span><span>               </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="hs-special">[</span><a href="#local-6989586621679151746"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">]</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">[</span><a href="#local-6989586621679151746"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">]</span><span class="hs-special">]</span><span>
</span><a name="line-549"></a><a name="transpose"><a href="Data.OldList.html#transpose"><span class="hs-identifier">transpose</span></a></a><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>             </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-550"></a><span class="hs-identifier">transpose</span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="hs-special">]</span><span>   </span><span class="hs-glyph">:</span><span> </span><a name="local-6989586621679151838"><a href="#local-6989586621679151838"><span class="hs-identifier">xss</span></a></a><span class="hs-special">)</span><span>   </span><span class="hs-glyph">=</span><span> </span><a href="Data.OldList.html#transpose"><span class="hs-identifier hs-var">transpose</span></a><span> </span><a href="#local-6989586621679151838"><span class="hs-identifier hs-var">xss</span></a><span>
</span><a name="line-551"></a><span class="hs-identifier">transpose</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><a name="local-6989586621679151839"><a href="#local-6989586621679151839"><span class="hs-identifier">x</span></a></a><span class="hs-glyph">:</span><a name="local-6989586621679151840"><a href="#local-6989586621679151840"><span class="hs-identifier">xs</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">:</span><span> </span><a name="local-6989586621679151841"><a href="#local-6989586621679151841"><span class="hs-identifier">xss</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679151839"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-glyph">:</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679151842"><span class="hs-identifier hs-var">h</span></a><span> </span><span class="hs-glyph">|</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679151842"><a href="#local-6989586621679151842"><span class="hs-identifier">h</span></a></a><span class="hs-glyph">:</span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-6989586621679151841"><span class="hs-identifier hs-var">xss</span></a><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">:</span><span> </span><a href="Data.OldList.html#transpose"><span class="hs-identifier hs-var">transpose</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679151840"><span class="hs-identifier hs-var">xs</span></a><span> </span><span class="hs-glyph">:</span><span> </span><span class="hs-special">[</span><span> </span><a href="#local-6989586621679151843"><span class="hs-identifier hs-var">t</span></a><span> </span><span class="hs-glyph">|</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">_</span><span class="hs-glyph">:</span><a name="local-6989586621679151843"><a href="#local-6989586621679151843"><span class="hs-identifier">t</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-6989586621679151841"><span class="hs-identifier hs-var">xss</span></a><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><a name="line-552"></a><span>
</span><a name="line-553"></a><span>
</span><a name="line-554"></a><span class="hs-comment">-- | The 'partition' function takes a predicate a list and returns</span><span>
</span><a name="line-555"></a><span class="hs-comment">-- the pair of lists of elements which do and do not satisfy the</span><span>
</span><a name="line-556"></a><span class="hs-comment">-- predicate, respectively; i.e.,</span><span>
</span><a name="line-557"></a><span class="hs-comment">--</span><span>
</span><a name="line-558"></a><span class="hs-comment">-- &gt; partition p xs == (filter p xs, filter (not . p) xs)</span><span>
</span><a name="line-559"></a><span class="hs-comment">--</span><span>
</span><a name="line-560"></a><span class="hs-comment">-- &gt;&gt;&gt; partition (`elem` &quot;aeiou&quot;) &quot;Hello World!&quot;</span><span>
</span><a name="line-561"></a><span class="hs-comment">-- (&quot;eoo&quot;,&quot;Hll Wrld!&quot;)</span><span>
</span><a name="line-562"></a><span class="hs-identifier">partition</span><span>               </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679151745"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../ghc-prim-0.5.2.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Types.html#Bool"><span class="hs-identifier hs-type">Bool</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679151745"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><a href="#local-6989586621679151745"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">]</span><span class="hs-special">,</span><span class="hs-special">[</span><a href="#local-6989586621679151745"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><a name="line-563"></a><span class="hs-pragma">{-# INLINE</span><span> </span><span class="hs-pragma">partition</span><span> </span><span class="hs-pragma">#-}</span><span>
</span><a name="line-564"></a><a name="partition"><a href="Data.OldList.html#partition"><span class="hs-identifier">partition</span></a></a><span> </span><a name="local-6989586621679151844"><a href="#local-6989586621679151844"><span class="hs-identifier">p</span></a></a><span> </span><a name="local-6989586621679151845"><a href="#local-6989586621679151845"><span class="hs-identifier">xs</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="GHC.Base.html#foldr"><span class="hs-identifier hs-var">foldr</span></a><span> </span><span class="hs-special">(</span><a href="Data.OldList.html#select"><span class="hs-identifier hs-var">select</span></a><span> </span><a href="#local-6989586621679151844"><span class="hs-identifier hs-var">p</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">,</span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679151845"><span class="hs-identifier hs-var">xs</span></a><span>
</span><a name="line-565"></a><span>
</span><a name="line-566"></a><span class="hs-identifier">select</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679151744"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../ghc-prim-0.5.2.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Types.html#Bool"><span class="hs-identifier hs-type">Bool</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679151744"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><a href="#local-6989586621679151744"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679151744"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><a href="#local-6989586621679151744"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679151744"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><a name="line-567"></a><a name="select"><a href="Data.OldList.html#select"><span class="hs-identifier">select</span></a></a><span> </span><a name="local-6989586621679151846"><a href="#local-6989586621679151846"><span class="hs-identifier">p</span></a></a><span> </span><a name="local-6989586621679151847"><a href="#local-6989586621679151847"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-glyph">~</span><span class="hs-special">(</span><a name="local-6989586621679151848"><a href="#local-6989586621679151848"><span class="hs-identifier">ts</span></a></a><span class="hs-special">,</span><a name="local-6989586621679151849"><a href="#local-6989586621679151849"><span class="hs-identifier">fs</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621679151846"><span class="hs-identifier hs-var">p</span></a><span> </span><a href="#local-6989586621679151847"><span class="hs-identifier hs-var">x</span></a><span>       </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679151847"><span class="hs-identifier hs-var">x</span></a><span class="hs-glyph">:</span><a href="#local-6989586621679151848"><span class="hs-identifier hs-var">ts</span></a><span class="hs-special">,</span><a href="#local-6989586621679151849"><span class="hs-identifier hs-var">fs</span></a><span class="hs-special">)</span><span>
</span><a name="line-568"></a><span>                    </span><span class="hs-glyph">|</span><span> </span><a href="GHC.Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679151848"><span class="hs-identifier hs-var">ts</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679151847"><span class="hs-identifier hs-var">x</span></a><span class="hs-glyph">:</span><a href="#local-6989586621679151849"><span class="hs-identifier hs-var">fs</span></a><span class="hs-special">)</span><span>
</span><a name="line-569"></a><span>
</span><a name="line-570"></a><span class="hs-comment">-- | The 'mapAccumL' function behaves like a combination of 'map' and</span><span>
</span><a name="line-571"></a><span class="hs-comment">-- 'foldl'; it applies a function to each element of a list, passing</span><span>
</span><a name="line-572"></a><span class="hs-comment">-- an accumulating parameter from left to right, and returning a final</span><span>
</span><a name="line-573"></a><span class="hs-comment">-- value of this accumulator together with the new list.</span><span>
</span><a name="line-574"></a><span class="hs-identifier">mapAccumL</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679151741"><span class="hs-identifier hs-type">acc</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679151742"><span class="hs-identifier hs-type">x</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679151741"><span class="hs-identifier hs-type">acc</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679151743"><span class="hs-identifier hs-type">y</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-comment">-- Function of elt of input list</span><span>
</span><a name="line-575"></a><span>                                    </span><span class="hs-comment">-- and accumulator, returning new</span><span>
</span><a name="line-576"></a><span>                                    </span><span class="hs-comment">-- accumulator and elt of result list</span><span>
</span><a name="line-577"></a><span>          </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679151741"><span class="hs-identifier hs-type">acc</span></a><span>            </span><span class="hs-comment">-- Initial accumulator</span><span>
</span><a name="line-578"></a><span>          </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679151742"><span class="hs-identifier hs-type">x</span></a><span class="hs-special">]</span><span>            </span><span class="hs-comment">-- Input list</span><span>
</span><a name="line-579"></a><span>          </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679151741"><span class="hs-identifier hs-type">acc</span></a><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679151743"><span class="hs-identifier hs-type">y</span></a><span class="hs-special">]</span><span class="hs-special">)</span><span>     </span><span class="hs-comment">-- Final accumulator and result list</span><span>
</span><a name="line-580"></a><span class="hs-pragma">{-# NOINLINE</span><span> </span><span class="hs-pragma">[</span><span class="hs-pragma">1</span><span class="hs-pragma">]</span><span> </span><span class="hs-pragma">mapAccumL</span><span> </span><span class="hs-pragma">#-}</span><span>
</span><a name="line-581"></a><a name="mapAccumL"><a href="Data.OldList.html#mapAccumL"><span class="hs-identifier">mapAccumL</span></a></a><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621679151850"><a href="#local-6989586621679151850"><span class="hs-identifier">s</span></a></a><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>        </span><span class="hs-glyph">=</span><span>  </span><span class="hs-special">(</span><a href="#local-6989586621679151850"><span class="hs-identifier hs-var">s</span></a><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><a name="line-582"></a><span class="hs-identifier">mapAccumL</span><span> </span><a name="local-6989586621679151851"><a href="#local-6989586621679151851"><span class="hs-identifier">f</span></a></a><span> </span><a name="local-6989586621679151852"><a href="#local-6989586621679151852"><span class="hs-identifier">s</span></a></a><span> </span><span class="hs-special">(</span><a name="local-6989586621679151853"><a href="#local-6989586621679151853"><span class="hs-identifier">x</span></a></a><span class="hs-glyph">:</span><a name="local-6989586621679151854"><a href="#local-6989586621679151854"><span class="hs-identifier">xs</span></a></a><span class="hs-special">)</span><span>    </span><span class="hs-glyph">=</span><span>  </span><span class="hs-special">(</span><a href="#local-6989586621679151857"><span class="hs-identifier hs-var">s''</span></a><span class="hs-special">,</span><a href="#local-6989586621679151856"><span class="hs-identifier hs-var">y</span></a><span class="hs-glyph">:</span><a href="#local-6989586621679151858"><span class="hs-identifier hs-var">ys</span></a><span class="hs-special">)</span><span>
</span><a name="line-583"></a><span>                           </span><span class="hs-keyword">where</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679151855"><a href="#local-6989586621679151855"><span class="hs-identifier">s'</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679151856"><a href="#local-6989586621679151856"><span class="hs-identifier">y</span></a></a><span> </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679151851"><span class="hs-identifier hs-var">f</span></a><span> </span><a href="#local-6989586621679151852"><span class="hs-identifier hs-var">s</span></a><span> </span><a href="#local-6989586621679151853"><span class="hs-identifier hs-var">x</span></a><span>
</span><a name="line-584"></a><span>                                 </span><span class="hs-special">(</span><a name="local-6989586621679151857"><a href="#local-6989586621679151857"><span class="hs-identifier">s''</span></a></a><span class="hs-special">,</span><a name="local-6989586621679151858"><a href="#local-6989586621679151858"><span class="hs-identifier">ys</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.OldList.html#mapAccumL"><span class="hs-identifier hs-var">mapAccumL</span></a><span> </span><a href="#local-6989586621679151851"><span class="hs-identifier hs-var">f</span></a><span> </span><a href="#local-6989586621679151855"><span class="hs-identifier hs-var">s'</span></a><span> </span><a href="#local-6989586621679151854"><span class="hs-identifier hs-var">xs</span></a><span>
</span><a name="line-585"></a><span>
</span><a name="line-586"></a><span class="hs-pragma">{-# RULES</span><span>
</span><a name="line-587"></a><span class="hs-pragma">&quot;mapAccumL&quot;</span><span> </span><span class="hs-pragma">[</span><span class="hs-pragma">~</span><span class="hs-pragma">1</span><span class="hs-pragma">]</span><span> </span><span class="hs-pragma">forall</span><span> </span><span class="hs-pragma">f</span><span> </span><span class="hs-pragma">s</span><span> </span><span class="hs-pragma">xs</span><span> </span><span class="hs-pragma">.</span><span> </span><span class="hs-pragma">mapAccumL</span><span> </span><span class="hs-pragma">f</span><span> </span><span class="hs-pragma">s</span><span> </span><span class="hs-pragma">xs</span><span> </span><span class="hs-pragma">=</span><span> </span><span class="hs-pragma">foldr</span><span> </span><span class="hs-pragma">(</span><span class="hs-pragma">mapAccumLF</span><span> </span><span class="hs-pragma">f</span><span class="hs-pragma">)</span><span> </span><span class="hs-pragma">pairWithNil</span><span> </span><span class="hs-pragma">xs</span><span> </span><span class="hs-pragma">s</span><span>
</span><a name="line-588"></a><span class="hs-pragma">&quot;mapAccumLList&quot;</span><span> </span><span class="hs-pragma">[</span><span class="hs-pragma">1</span><span class="hs-pragma">]</span><span> </span><span class="hs-pragma">forall</span><span> </span><span class="hs-pragma">f</span><span> </span><span class="hs-pragma">s</span><span> </span><span class="hs-pragma">xs</span><span> </span><span class="hs-pragma">.</span><span> </span><span class="hs-pragma">foldr</span><span> </span><span class="hs-pragma">(</span><span class="hs-pragma">mapAccumLF</span><span> </span><span class="hs-pragma">f</span><span class="hs-pragma">)</span><span> </span><span class="hs-pragma">pairWithNil</span><span> </span><span class="hs-pragma">xs</span><span> </span><span class="hs-pragma">s</span><span> </span><span class="hs-pragma">=</span><span> </span><span class="hs-pragma">mapAccumL</span><span> </span><span class="hs-pragma">f</span><span> </span><span class="hs-pragma">s</span><span> </span><span class="hs-pragma">xs</span><span>
</span><a name="line-589"></a><span> </span><span class="hs-pragma">#-}</span><span>
</span><a name="line-590"></a><span>
</span><a name="line-591"></a><span class="hs-identifier">pairWithNil</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="#local-6989586621679151739"><span class="hs-identifier hs-type">acc</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679151739"><span class="hs-identifier hs-type">acc</span></a><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679151740"><span class="hs-identifier hs-type">y</span></a><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><a name="line-592"></a><span class="hs-pragma">{-# INLINE</span><span> </span><span class="hs-pragma">[</span><span class="hs-pragma">0</span><span class="hs-pragma">]</span><span> </span><span class="hs-pragma">pairWithNil</span><span> </span><span class="hs-pragma">#-}</span><span>
</span><a name="line-593"></a><a name="pairWithNil"><a href="Data.OldList.html#pairWithNil"><span class="hs-identifier">pairWithNil</span></a></a><span> </span><a name="local-6989586621679151859"><a href="#local-6989586621679151859"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679151859"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><a name="line-594"></a><span>
</span><a name="line-595"></a><span class="hs-identifier">mapAccumLF</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679151736"><span class="hs-identifier hs-type">acc</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679151737"><span class="hs-identifier hs-type">x</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679151736"><span class="hs-identifier hs-type">acc</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679151738"><span class="hs-identifier hs-type">y</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679151737"><span class="hs-identifier hs-type">x</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679151736"><span class="hs-identifier hs-type">acc</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679151736"><span class="hs-identifier hs-type">acc</span></a><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679151738"><span class="hs-identifier hs-type">y</span></a><span class="hs-special">]</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679151736"><span class="hs-identifier hs-type">acc</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679151736"><span class="hs-identifier hs-type">acc</span></a><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679151738"><span class="hs-identifier hs-type">y</span></a><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><a name="line-596"></a><span class="hs-pragma">{-# INLINE</span><span> </span><span class="hs-pragma">[</span><span class="hs-pragma">0</span><span class="hs-pragma">]</span><span> </span><span class="hs-pragma">mapAccumLF</span><span> </span><span class="hs-pragma">#-}</span><span>
</span><a name="line-597"></a><a name="mapAccumLF"><a href="Data.OldList.html#mapAccumLF"><span class="hs-identifier">mapAccumLF</span></a></a><span> </span><a name="local-6989586621679151860"><a href="#local-6989586621679151860"><span class="hs-identifier">f</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">\</span><a name="local-6989586621679151861"><a href="#local-6989586621679151861"><span class="hs-identifier">x</span></a></a><span> </span><a name="local-6989586621679151862"><a href="#local-6989586621679151862"><span class="hs-identifier">r</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../ghc-prim-0.5.2.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Magic.html#oneShot"><span class="hs-identifier hs-var">oneShot</span></a><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><a name="local-6989586621679151863"><a href="#local-6989586621679151863"><span class="hs-identifier">s</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-598"></a><span>                         </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679151864"><a href="#local-6989586621679151864"><span class="hs-identifier">s'</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679151865"><a href="#local-6989586621679151865"><span class="hs-identifier">y</span></a></a><span class="hs-special">)</span><span>   </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679151860"><span class="hs-identifier hs-var">f</span></a><span> </span><a href="#local-6989586621679151863"><span class="hs-identifier hs-var">s</span></a><span> </span><a href="#local-6989586621679151861"><span class="hs-identifier hs-var">x</span></a><span>
</span><a name="line-599"></a><span>                             </span><span class="hs-special">(</span><a name="local-6989586621679151866"><a href="#local-6989586621679151866"><span class="hs-identifier">s''</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679151867"><a href="#local-6989586621679151867"><span class="hs-identifier">ys</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679151862"><span class="hs-identifier hs-var">r</span></a><span> </span><a href="#local-6989586621679151864"><span class="hs-identifier hs-var">s'</span></a><span>
</span><a name="line-600"></a><span>                         </span><span class="hs-keyword">in</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679151866"><span class="hs-identifier hs-var">s''</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679151865"><span class="hs-identifier hs-var">y</span></a><span class="hs-glyph">:</span><a href="#local-6989586621679151867"><span class="hs-identifier hs-var">ys</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-601"></a><span>  </span><span class="hs-comment">-- See Note [Left folds via right fold]</span><span>
</span><a name="line-602"></a><span>
</span><a name="line-603"></a><span>
</span><a name="line-604"></a><span class="hs-comment">-- | The 'mapAccumR' function behaves like a combination of 'map' and</span><span>
</span><a name="line-605"></a><span class="hs-comment">-- 'foldr'; it applies a function to each element of a list, passing</span><span>
</span><a name="line-606"></a><span class="hs-comment">-- an accumulating parameter from right to left, and returning a final</span><span>
</span><a name="line-607"></a><span class="hs-comment">-- value of this accumulator together with the new list.</span><span>
</span><a name="line-608"></a><span class="hs-identifier">mapAccumR</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679151733"><span class="hs-identifier hs-type">acc</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679151734"><span class="hs-identifier hs-type">x</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679151733"><span class="hs-identifier hs-type">acc</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679151735"><span class="hs-identifier hs-type">y</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>     </span><span class="hs-comment">-- Function of elt of input list</span><span>
</span><a name="line-609"></a><span>                                        </span><span class="hs-comment">-- and accumulator, returning new</span><span>
</span><a name="line-610"></a><span>                                        </span><span class="hs-comment">-- accumulator and elt of result list</span><span>
</span><a name="line-611"></a><span>            </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679151733"><span class="hs-identifier hs-type">acc</span></a><span>              </span><span class="hs-comment">-- Initial accumulator</span><span>
</span><a name="line-612"></a><span>            </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679151734"><span class="hs-identifier hs-type">x</span></a><span class="hs-special">]</span><span>              </span><span class="hs-comment">-- Input list</span><span>
</span><a name="line-613"></a><span>            </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679151733"><span class="hs-identifier hs-type">acc</span></a><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679151735"><span class="hs-identifier hs-type">y</span></a><span class="hs-special">]</span><span class="hs-special">)</span><span>               </span><span class="hs-comment">-- Final accumulator and result list</span><span>
</span><a name="line-614"></a><a name="mapAccumR"><a href="Data.OldList.html#mapAccumR"><span class="hs-identifier">mapAccumR</span></a></a><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621679151868"><a href="#local-6989586621679151868"><span class="hs-identifier">s</span></a></a><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>        </span><span class="hs-glyph">=</span><span>  </span><span class="hs-special">(</span><a href="#local-6989586621679151868"><span class="hs-identifier hs-var">s</span></a><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><a name="line-615"></a><span class="hs-identifier">mapAccumR</span><span> </span><a name="local-6989586621679151869"><a href="#local-6989586621679151869"><span class="hs-identifier">f</span></a></a><span> </span><a name="local-6989586621679151870"><a href="#local-6989586621679151870"><span class="hs-identifier">s</span></a></a><span> </span><span class="hs-special">(</span><a name="local-6989586621679151871"><a href="#local-6989586621679151871"><span class="hs-identifier">x</span></a></a><span class="hs-glyph">:</span><a name="local-6989586621679151872"><a href="#local-6989586621679151872"><span class="hs-identifier">xs</span></a></a><span class="hs-special">)</span><span>    </span><span class="hs-glyph">=</span><span>  </span><span class="hs-special">(</span><a href="#local-6989586621679151873"><span class="hs-identifier hs-var">s''</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679151874"><span class="hs-identifier hs-var">y</span></a><span class="hs-glyph">:</span><a href="#local-6989586621679151876"><span class="hs-identifier hs-var">ys</span></a><span class="hs-special">)</span><span>
</span><a name="line-616"></a><span>                           </span><span class="hs-keyword">where</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679151873"><a href="#local-6989586621679151873"><span class="hs-identifier">s''</span></a></a><span class="hs-special">,</span><a name="local-6989586621679151874"><a href="#local-6989586621679151874"><span class="hs-identifier">y</span></a></a><span> </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679151869"><span class="hs-identifier hs-var">f</span></a><span> </span><a href="#local-6989586621679151875"><span class="hs-identifier hs-var">s'</span></a><span> </span><a href="#local-6989586621679151871"><span class="hs-identifier hs-var">x</span></a><span>
</span><a name="line-617"></a><span>                                 </span><span class="hs-special">(</span><a name="local-6989586621679151875"><a href="#local-6989586621679151875"><span class="hs-identifier">s'</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679151876"><a href="#local-6989586621679151876"><span class="hs-identifier">ys</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.OldList.html#mapAccumR"><span class="hs-identifier hs-var">mapAccumR</span></a><span> </span><a href="#local-6989586621679151869"><span class="hs-identifier hs-var">f</span></a><span> </span><a href="#local-6989586621679151870"><span class="hs-identifier hs-var">s</span></a><span> </span><a href="#local-6989586621679151872"><span class="hs-identifier hs-var">xs</span></a><span>
</span><a name="line-618"></a><span>
</span><a name="line-619"></a><span class="hs-comment">-- | The 'insert' function takes an element and a list and inserts the</span><span>
</span><a name="line-620"></a><span class="hs-comment">-- element into the list at the first position where it is less</span><span>
</span><a name="line-621"></a><span class="hs-comment">-- than or equal to the next element.  In particular, if the list</span><span>
</span><a name="line-622"></a><span class="hs-comment">-- is sorted before the call, the result will also be sorted.</span><span>
</span><a name="line-623"></a><span class="hs-comment">-- It is a special case of 'insertBy', which allows the programmer to</span><span>
</span><a name="line-624"></a><span class="hs-comment">-- supply their own comparison function.</span><span>
</span><a name="line-625"></a><span class="hs-comment">--</span><span>
</span><a name="line-626"></a><span class="hs-comment">-- &gt;&gt;&gt; insert 4 [1,2,3,5,6,7]</span><span>
</span><a name="line-627"></a><span class="hs-comment">-- [1,2,3,4,5,6,7]</span><span>
</span><a name="line-628"></a><span class="hs-identifier">insert</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="../ghc-prim-0.5.2.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Classes.html#Ord"><span class="hs-identifier hs-type">Ord</span></a><span> </span><a href="#local-6989586621679151732"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="#local-6989586621679151732"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679151732"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679151732"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">]</span><span>
</span><a name="line-629"></a><a name="insert"><a href="Data.OldList.html#insert"><span class="hs-identifier">insert</span></a></a><span> </span><a name="local-6989586621679151877"><a href="#local-6989586621679151877"><span class="hs-identifier">e</span></a></a><span> </span><a name="local-6989586621679151878"><a href="#local-6989586621679151878"><span class="hs-identifier">ls</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.OldList.html#insertBy"><span class="hs-identifier hs-var">insertBy</span></a><span> </span><span class="hs-special">(</span><a href="../ghc-prim-0.5.2.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Classes.html#compare"><span class="hs-identifier hs-var">compare</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679151877"><span class="hs-identifier hs-var">e</span></a><span> </span><a href="#local-6989586621679151878"><span class="hs-identifier hs-var">ls</span></a><span>
</span><a name="line-630"></a><span>
</span><a name="line-631"></a><span class="hs-comment">-- | The non-overloaded version of 'insert'.</span><span>
</span><a name="line-632"></a><span class="hs-identifier">insertBy</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679151731"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679151731"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../ghc-prim-0.5.2.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Types.html#Ordering"><span class="hs-identifier hs-type">Ordering</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679151731"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679151731"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679151731"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">]</span><span>
</span><a name="line-633"></a><a name="insertBy"><a href="Data.OldList.html#insertBy"><span class="hs-identifier">insertBy</span></a></a><span> </span><span class="hs-identifier">_</span><span>   </span><a name="local-6989586621679151879"><a href="#local-6989586621679151879"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679151879"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">]</span><span>
</span><a name="line-634"></a><span class="hs-identifier">insertBy</span><span> </span><a name="local-6989586621679151880"><a href="#local-6989586621679151880"><span class="hs-identifier">cmp</span></a></a><span> </span><a name="local-6989586621679151881"><a href="#local-6989586621679151881"><span class="hs-identifier">x</span></a></a><span> </span><a name="local-6989586621679151882"><a href="#local-6989586621679151882"><span class="hs-identifier">ys</span></a></a><span class="hs-glyph">@</span><span class="hs-special">(</span><a name="local-6989586621679151883"><a href="#local-6989586621679151883"><span class="hs-identifier">y</span></a></a><span class="hs-glyph">:</span><a name="local-6989586621679151884"><a href="#local-6989586621679151884"><span class="hs-identifier">ys'</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-635"></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621679151880"><span class="hs-identifier hs-var">cmp</span></a><span> </span><a href="#local-6989586621679151881"><span class="hs-identifier hs-var">x</span></a><span> </span><a href="#local-6989586621679151883"><span class="hs-identifier hs-var">y</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-636"></a><span>     </span><a href="../ghc-prim-0.5.2.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Types.html#GT"><span class="hs-identifier hs-var">GT</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679151883"><span class="hs-identifier hs-var">y</span></a><span> </span><span class="hs-glyph">:</span><span> </span><a href="Data.OldList.html#insertBy"><span class="hs-identifier hs-var">insertBy</span></a><span> </span><a href="#local-6989586621679151880"><span class="hs-identifier hs-var">cmp</span></a><span> </span><a href="#local-6989586621679151881"><span class="hs-identifier hs-var">x</span></a><span> </span><a href="#local-6989586621679151884"><span class="hs-identifier hs-var">ys'</span></a><span>
</span><a name="line-637"></a><span>     </span><span class="hs-identifier">_</span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679151881"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-glyph">:</span><span> </span><a href="#local-6989586621679151882"><span class="hs-identifier hs-var">ys</span></a><span>
</span><a name="line-638"></a><span>
</span><a name="line-639"></a><span class="hs-comment">-- | The 'maximumBy' function takes a comparison function and a list</span><span>
</span><a name="line-640"></a><span class="hs-comment">-- and returns the greatest element of the list by the comparison function.</span><span>
</span><a name="line-641"></a><span class="hs-comment">-- The list must be finite and non-empty.</span><span>
</span><a name="line-642"></a><span class="hs-comment">--</span><span>
</span><a name="line-643"></a><span class="hs-comment">-- We can use this to find the longest entry of a list:</span><span>
</span><a name="line-644"></a><span class="hs-comment">--</span><span>
</span><a name="line-645"></a><span class="hs-comment">-- &gt;&gt;&gt; maximumBy (\x y -&gt; compare (length x) (length y)) [&quot;Hello&quot;, &quot;World&quot;, &quot;!&quot;, &quot;Longest&quot;, &quot;bar&quot;]</span><span>
</span><a name="line-646"></a><span class="hs-comment">-- &quot;Longest&quot;</span><span>
</span><a name="line-647"></a><span class="hs-identifier">maximumBy</span><span>               </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679151730"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679151730"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../ghc-prim-0.5.2.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Types.html#Ordering"><span class="hs-identifier hs-type">Ordering</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679151730"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679151730"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-648"></a><a name="maximumBy"><a href="Data.OldList.html#maximumBy"><span class="hs-identifier">maximumBy</span></a></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>          </span><span class="hs-glyph">=</span><span>  </span><a href="GHC.Err.html#errorWithoutStackTrace"><span class="hs-identifier hs-var">errorWithoutStackTrace</span></a><span> </span><span class="hs-string">&quot;List.maximumBy: empty list&quot;</span><span>
</span><a name="line-649"></a><span class="hs-identifier">maximumBy</span><span> </span><a name="local-6989586621679151885"><a href="#local-6989586621679151885"><span class="hs-identifier">cmp</span></a></a><span> </span><a name="local-6989586621679151886"><a href="#local-6989586621679151886"><span class="hs-identifier">xs</span></a></a><span>        </span><span class="hs-glyph">=</span><span>  </span><a href="GHC.List.html#foldl1"><span class="hs-identifier hs-var">foldl1</span></a><span> </span><a href="#local-6989586621679151887"><span class="hs-identifier hs-var">maxBy</span></a><span> </span><a href="#local-6989586621679151886"><span class="hs-identifier hs-var">xs</span></a><span>
</span><a name="line-650"></a><span>                        </span><span class="hs-keyword">where</span><span>
</span><a name="line-651"></a><span>                           </span><a name="local-6989586621679151887"><a href="#local-6989586621679151887"><span class="hs-identifier">maxBy</span></a></a><span> </span><a name="local-6989586621679151888"><a href="#local-6989586621679151888"><span class="hs-identifier">x</span></a></a><span> </span><a name="local-6989586621679151889"><a href="#local-6989586621679151889"><span class="hs-identifier">y</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621679151885"><span class="hs-identifier hs-var">cmp</span></a><span> </span><a href="#local-6989586621679151888"><span class="hs-identifier hs-var">x</span></a><span> </span><a href="#local-6989586621679151889"><span class="hs-identifier hs-var">y</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-652"></a><span>                                       </span><a href="../ghc-prim-0.5.2.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Types.html#GT"><span class="hs-identifier hs-var">GT</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679151888"><span class="hs-identifier hs-var">x</span></a><span>
</span><a name="line-653"></a><span>                                       </span><span class="hs-identifier">_</span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679151889"><span class="hs-identifier hs-var">y</span></a><span>
</span><a name="line-654"></a><span>
</span><a name="line-655"></a><span class="hs-comment">-- | The 'minimumBy' function takes a comparison function and a list</span><span>
</span><a name="line-656"></a><span class="hs-comment">-- and returns the least element of the list by the comparison function.</span><span>
</span><a name="line-657"></a><span class="hs-comment">-- The list must be finite and non-empty.</span><span>
</span><a name="line-658"></a><span class="hs-comment">--</span><span>
</span><a name="line-659"></a><span class="hs-comment">-- We can use this to find the shortest entry of a list:</span><span>
</span><a name="line-660"></a><span class="hs-comment">--</span><span>
</span><a name="line-661"></a><span class="hs-comment">-- &gt;&gt;&gt; minimumBy (\x y -&gt; compare (length x) (length y)) [&quot;Hello&quot;, &quot;World&quot;, &quot;!&quot;, &quot;Longest&quot;, &quot;bar&quot;]</span><span>
</span><a name="line-662"></a><span class="hs-comment">-- &quot;!&quot;</span><span>
</span><a name="line-663"></a><span class="hs-identifier">minimumBy</span><span>               </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679151729"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679151729"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../ghc-prim-0.5.2.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Types.html#Ordering"><span class="hs-identifier hs-type">Ordering</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679151729"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679151729"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-664"></a><a name="minimumBy"><a href="Data.OldList.html#minimumBy"><span class="hs-identifier">minimumBy</span></a></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>          </span><span class="hs-glyph">=</span><span>  </span><a href="GHC.Err.html#errorWithoutStackTrace"><span class="hs-identifier hs-var">errorWithoutStackTrace</span></a><span> </span><span class="hs-string">&quot;List.minimumBy: empty list&quot;</span><span>
</span><a name="line-665"></a><span class="hs-identifier">minimumBy</span><span> </span><a name="local-6989586621679151890"><a href="#local-6989586621679151890"><span class="hs-identifier">cmp</span></a></a><span> </span><a name="local-6989586621679151891"><a href="#local-6989586621679151891"><span class="hs-identifier">xs</span></a></a><span>        </span><span class="hs-glyph">=</span><span>  </span><a href="GHC.List.html#foldl1"><span class="hs-identifier hs-var">foldl1</span></a><span> </span><a href="#local-6989586621679151892"><span class="hs-identifier hs-var">minBy</span></a><span> </span><a href="#local-6989586621679151891"><span class="hs-identifier hs-var">xs</span></a><span>
</span><a name="line-666"></a><span>                        </span><span class="hs-keyword">where</span><span>
</span><a name="line-667"></a><span>                           </span><a name="local-6989586621679151892"><a href="#local-6989586621679151892"><span class="hs-identifier">minBy</span></a></a><span> </span><a name="local-6989586621679151893"><a href="#local-6989586621679151893"><span class="hs-identifier">x</span></a></a><span> </span><a name="local-6989586621679151894"><a href="#local-6989586621679151894"><span class="hs-identifier">y</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621679151890"><span class="hs-identifier hs-var">cmp</span></a><span> </span><a href="#local-6989586621679151893"><span class="hs-identifier hs-var">x</span></a><span> </span><a href="#local-6989586621679151894"><span class="hs-identifier hs-var">y</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-668"></a><span>                                       </span><a href="../ghc-prim-0.5.2.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Types.html#GT"><span class="hs-identifier hs-var">GT</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679151894"><span class="hs-identifier hs-var">y</span></a><span>
</span><a name="line-669"></a><span>                                       </span><span class="hs-identifier">_</span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679151893"><span class="hs-identifier hs-var">x</span></a><span>
</span><a name="line-670"></a><span>
</span><a name="line-671"></a><span class="hs-comment">-- | The 'genericLength' function is an overloaded version of 'length'.  In</span><span>
</span><a name="line-672"></a><span class="hs-comment">-- particular, instead of returning an 'Int', it returns any type which is</span><span>
</span><a name="line-673"></a><span class="hs-comment">-- an instance of 'Num'.  It is, however, less efficient than 'length'.</span><span>
</span><a name="line-674"></a><span class="hs-identifier">genericLength</span><span>           </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><a href="GHC.Num.html#Num"><span class="hs-identifier hs-type">Num</span></a><span> </span><a href="#local-6989586621679151727"><span class="hs-identifier hs-type">i</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679151728"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679151727"><span class="hs-identifier hs-type">i</span></a><span>
</span><a name="line-675"></a><span class="hs-pragma">{-# NOINLINE</span><span> </span><span class="hs-pragma">[</span><span class="hs-pragma">1</span><span class="hs-pragma">]</span><span> </span><span class="hs-pragma">genericLength</span><span> </span><span class="hs-pragma">#-}</span><span>
</span><a name="line-676"></a><a name="genericLength"><a href="Data.OldList.html#genericLength"><span class="hs-identifier">genericLength</span></a></a><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>        </span><span class="hs-glyph">=</span><span>  </span><span class="hs-number">0</span><span>
</span><a name="line-677"></a><span class="hs-identifier">genericLength</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">_</span><span class="hs-glyph">:</span><a name="local-6989586621679151895"><a href="#local-6989586621679151895"><span class="hs-identifier">l</span></a></a><span class="hs-special">)</span><span>     </span><span class="hs-glyph">=</span><span>  </span><span class="hs-number">1</span><span> </span><a href="GHC.Num.html#%2B"><span class="hs-operator hs-var">+</span></a><span> </span><a href="Data.OldList.html#genericLength"><span class="hs-identifier hs-var">genericLength</span></a><span> </span><a href="#local-6989586621679151895"><span class="hs-identifier hs-var">l</span></a><span>
</span><a name="line-678"></a><span>
</span><a name="line-679"></a><span class="hs-pragma">{-# RULES</span><span>
</span><a name="line-680"></a><span>  </span><span class="hs-pragma">&quot;genericLengthInt&quot;</span><span>     </span><span class="hs-pragma">genericLength</span><span> </span><span class="hs-pragma">=</span><span> </span><span class="hs-pragma">(</span><span class="hs-pragma">strictGenericLength</span><span> </span><span class="hs-pragma">::</span><span> </span><span class="hs-pragma">[</span><span class="hs-pragma">a</span><span class="hs-pragma">]</span><span> </span><span class="hs-pragma">-&gt;</span><span> </span><span class="hs-pragma">Int</span><span class="hs-pragma">)</span><span class="hs-pragma">;</span><span>
</span><a name="line-681"></a><span>  </span><span class="hs-pragma">&quot;genericLengthInteger&quot;</span><span> </span><span class="hs-pragma">genericLength</span><span> </span><span class="hs-pragma">=</span><span> </span><span class="hs-pragma">(</span><span class="hs-pragma">strictGenericLength</span><span> </span><span class="hs-pragma">::</span><span> </span><span class="hs-pragma">[</span><span class="hs-pragma">a</span><span class="hs-pragma">]</span><span> </span><span class="hs-pragma">-&gt;</span><span> </span><span class="hs-pragma">Integer</span><span class="hs-pragma">)</span><span class="hs-pragma">;</span><span>
</span><a name="line-682"></a><span> </span><span class="hs-pragma">#-}</span><span>
</span><a name="line-683"></a><span>
</span><a name="line-684"></a><span class="hs-identifier">strictGenericLength</span><span>     </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><a href="GHC.Num.html#Num"><span class="hs-identifier hs-type">Num</span></a><span> </span><a href="#local-6989586621679151725"><span class="hs-identifier hs-type">i</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679151726"><span class="hs-identifier hs-type">b</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679151725"><span class="hs-identifier hs-type">i</span></a><span>
</span><a name="line-685"></a><a name="strictGenericLength"><a href="Data.OldList.html#strictGenericLength"><span class="hs-identifier">strictGenericLength</span></a></a><span> </span><a name="local-6989586621679151896"><a href="#local-6989586621679151896"><span class="hs-identifier">l</span></a></a><span>   </span><span class="hs-glyph">=</span><span>  </span><a href="#local-6989586621679151897"><span class="hs-identifier hs-var">gl</span></a><span> </span><a href="#local-6989586621679151896"><span class="hs-identifier hs-var">l</span></a><span> </span><span class="hs-number">0</span><span>
</span><a name="line-686"></a><span>                        </span><span class="hs-keyword">where</span><span>
</span><a name="line-687"></a><span>                           </span><a name="local-6989586621679151897"><a href="#local-6989586621679151897"><span class="hs-identifier">gl</span></a></a><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><a name="local-6989586621679151898"><a href="#local-6989586621679151898"><span class="hs-identifier">a</span></a></a><span>     </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679151898"><span class="hs-identifier hs-var">a</span></a><span>
</span><a name="line-688"></a><span>                           </span><span class="hs-identifier">gl</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">_</span><span class="hs-glyph">:</span><a name="local-6989586621679151899"><a href="#local-6989586621679151899"><span class="hs-identifier">xs</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621679151900"><a href="#local-6989586621679151900"><span class="hs-identifier">a</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679151901"><a href="#local-6989586621679151901"><span class="hs-identifier">a'</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679151900"><span class="hs-identifier hs-var">a</span></a><span> </span><a href="GHC.Num.html#%2B"><span class="hs-operator hs-var">+</span></a><span> </span><span class="hs-number">1</span><span> </span><span class="hs-keyword">in</span><span> </span><a href="#local-6989586621679151901"><span class="hs-identifier hs-var">a'</span></a><span> </span><span class="hs-special">`</span><a href="../ghc-prim-0.5.2.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Prim.html#seq"><span class="hs-identifier hs-var">seq</span></a><span class="hs-special">`</span><span> </span><a href="#local-6989586621679151897"><span class="hs-identifier hs-var">gl</span></a><span> </span><a href="#local-6989586621679151899"><span class="hs-identifier hs-var">xs</span></a><span> </span><a href="#local-6989586621679151901"><span class="hs-identifier hs-var">a'</span></a><span>
</span><a name="line-689"></a><span>
</span><a name="line-690"></a><span class="hs-comment">-- | The 'genericTake' function is an overloaded version of 'take', which</span><span>
</span><a name="line-691"></a><span class="hs-comment">-- accepts any 'Integral' value as the number of elements to take.</span><span>
</span><a name="line-692"></a><span class="hs-identifier">genericTake</span><span>             </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><a href="GHC.Real.html#Integral"><span class="hs-identifier hs-type">Integral</span></a><span> </span><a href="#local-6989586621679151723"><span class="hs-identifier hs-type">i</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="#local-6989586621679151723"><span class="hs-identifier hs-type">i</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679151724"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679151724"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">]</span><span>
</span><a name="line-693"></a><a name="genericTake"><a href="Data.OldList.html#genericTake"><span class="hs-identifier">genericTake</span></a></a><span> </span><a name="local-6989586621679151902"><a href="#local-6989586621679151902"><span class="hs-identifier">n</span></a></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621679151902"><span class="hs-identifier hs-var">n</span></a><span> </span><a href="../ghc-prim-0.5.2.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Classes.html#%3C%3D"><span class="hs-operator hs-var">&lt;=</span></a><span> </span><span class="hs-number">0</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-694"></a><span class="hs-identifier">genericTake</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>        </span><span class="hs-glyph">=</span><span>  </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-695"></a><span class="hs-identifier">genericTake</span><span> </span><a name="local-6989586621679151903"><a href="#local-6989586621679151903"><span class="hs-identifier">n</span></a></a><span> </span><span class="hs-special">(</span><a name="local-6989586621679151904"><a href="#local-6989586621679151904"><span class="hs-identifier">x</span></a></a><span class="hs-glyph">:</span><a name="local-6989586621679151905"><a href="#local-6989586621679151905"><span class="hs-identifier">xs</span></a></a><span class="hs-special">)</span><span>    </span><span class="hs-glyph">=</span><span>  </span><a href="#local-6989586621679151904"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-glyph">:</span><span> </span><a href="Data.OldList.html#genericTake"><span class="hs-identifier hs-var">genericTake</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679151903"><span class="hs-identifier hs-var">n</span></a><span class="hs-glyph">-</span><span class="hs-number">1</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679151905"><span class="hs-identifier hs-var">xs</span></a><span>
</span><a name="line-696"></a><span>
</span><a name="line-697"></a><span class="hs-comment">-- | The 'genericDrop' function is an overloaded version of 'drop', which</span><span>
</span><a name="line-698"></a><span class="hs-comment">-- accepts any 'Integral' value as the number of elements to drop.</span><span>
</span><a name="line-699"></a><span class="hs-identifier">genericDrop</span><span>             </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><a href="GHC.Real.html#Integral"><span class="hs-identifier hs-type">Integral</span></a><span> </span><a href="#local-6989586621679151721"><span class="hs-identifier hs-type">i</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="#local-6989586621679151721"><span class="hs-identifier hs-type">i</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679151722"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679151722"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">]</span><span>
</span><a name="line-700"></a><a name="genericDrop"><a href="Data.OldList.html#genericDrop"><span class="hs-identifier">genericDrop</span></a></a><span> </span><a name="local-6989586621679151906"><a href="#local-6989586621679151906"><span class="hs-identifier">n</span></a></a><span> </span><a name="local-6989586621679151907"><a href="#local-6989586621679151907"><span class="hs-identifier">xs</span></a></a><span> </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621679151906"><span class="hs-identifier hs-var">n</span></a><span> </span><a href="../ghc-prim-0.5.2.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Classes.html#%3C%3D"><span class="hs-operator hs-var">&lt;=</span></a><span> </span><span class="hs-number">0</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679151907"><span class="hs-identifier hs-var">xs</span></a><span>
</span><a name="line-701"></a><span class="hs-identifier">genericDrop</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>        </span><span class="hs-glyph">=</span><span>  </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-702"></a><span class="hs-identifier">genericDrop</span><span> </span><a name="local-6989586621679151908"><a href="#local-6989586621679151908"><span class="hs-identifier">n</span></a></a><span> </span><span class="hs-special">(</span><span class="hs-identifier">_</span><span class="hs-glyph">:</span><a name="local-6989586621679151909"><a href="#local-6989586621679151909"><span class="hs-identifier">xs</span></a></a><span class="hs-special">)</span><span>    </span><span class="hs-glyph">=</span><span>  </span><a href="Data.OldList.html#genericDrop"><span class="hs-identifier hs-var">genericDrop</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679151908"><span class="hs-identifier hs-var">n</span></a><span class="hs-glyph">-</span><span class="hs-number">1</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679151909"><span class="hs-identifier hs-var">xs</span></a><span>
</span><a name="line-703"></a><span>
</span><a name="line-704"></a><span>
</span><a name="line-705"></a><span class="hs-comment">-- | The 'genericSplitAt' function is an overloaded version of 'splitAt', which</span><span>
</span><a name="line-706"></a><span class="hs-comment">-- accepts any 'Integral' value as the position at which to split.</span><span>
</span><a name="line-707"></a><span class="hs-identifier">genericSplitAt</span><span>          </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><a href="GHC.Real.html#Integral"><span class="hs-identifier hs-type">Integral</span></a><span> </span><a href="#local-6989586621679151719"><span class="hs-identifier hs-type">i</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="#local-6989586621679151719"><span class="hs-identifier hs-type">i</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679151720"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><a href="#local-6989586621679151720"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679151720"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><a name="line-708"></a><a name="genericSplitAt"><a href="Data.OldList.html#genericSplitAt"><span class="hs-identifier">genericSplitAt</span></a></a><span> </span><a name="local-6989586621679151910"><a href="#local-6989586621679151910"><span class="hs-identifier">n</span></a></a><span> </span><a name="local-6989586621679151911"><a href="#local-6989586621679151911"><span class="hs-identifier">xs</span></a></a><span> </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621679151910"><span class="hs-identifier hs-var">n</span></a><span> </span><a href="../ghc-prim-0.5.2.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Classes.html#%3C%3D"><span class="hs-operator hs-var">&lt;=</span></a><span> </span><span class="hs-number">0</span><span> </span><span class="hs-glyph">=</span><span>  </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">,</span><a href="#local-6989586621679151911"><span class="hs-identifier hs-var">xs</span></a><span class="hs-special">)</span><span>
</span><a name="line-709"></a><span class="hs-identifier">genericSplitAt</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>     </span><span class="hs-glyph">=</span><span>  </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">,</span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><a name="line-710"></a><span class="hs-identifier">genericSplitAt</span><span> </span><a name="local-6989586621679151912"><a href="#local-6989586621679151912"><span class="hs-identifier">n</span></a></a><span> </span><span class="hs-special">(</span><a name="local-6989586621679151913"><a href="#local-6989586621679151913"><span class="hs-identifier">x</span></a></a><span class="hs-glyph">:</span><a name="local-6989586621679151914"><a href="#local-6989586621679151914"><span class="hs-identifier">xs</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>  </span><span class="hs-special">(</span><a href="#local-6989586621679151913"><span class="hs-identifier hs-var">x</span></a><span class="hs-glyph">:</span><a href="#local-6989586621679151915"><span class="hs-identifier hs-var">xs'</span></a><span class="hs-special">,</span><a href="#local-6989586621679151916"><span class="hs-identifier hs-var">xs''</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-711"></a><span>    </span><span class="hs-special">(</span><a name="local-6989586621679151915"><a href="#local-6989586621679151915"><span class="hs-identifier">xs'</span></a></a><span class="hs-special">,</span><a name="local-6989586621679151916"><a href="#local-6989586621679151916"><span class="hs-identifier">xs''</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.OldList.html#genericSplitAt"><span class="hs-identifier hs-var">genericSplitAt</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679151912"><span class="hs-identifier hs-var">n</span></a><span class="hs-glyph">-</span><span class="hs-number">1</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679151914"><span class="hs-identifier hs-var">xs</span></a><span>
</span><a name="line-712"></a><span>
</span><a name="line-713"></a><span class="hs-comment">-- | The 'genericIndex' function is an overloaded version of '!!', which</span><span>
</span><a name="line-714"></a><span class="hs-comment">-- accepts any 'Integral' value as the index.</span><span>
</span><a name="line-715"></a><span class="hs-identifier">genericIndex</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><a href="GHC.Real.html#Integral"><span class="hs-identifier hs-type">Integral</span></a><span> </span><a href="#local-6989586621679151717"><span class="hs-identifier hs-type">i</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679151718"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679151717"><span class="hs-identifier hs-type">i</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679151718"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-716"></a><a name="genericIndex"><a href="Data.OldList.html#genericIndex"><span class="hs-identifier">genericIndex</span></a></a><span> </span><span class="hs-special">(</span><a name="local-6989586621679151917"><a href="#local-6989586621679151917"><span class="hs-identifier">x</span></a></a><span class="hs-glyph">:</span><span class="hs-identifier">_</span><span class="hs-special">)</span><span>  </span><span class="hs-number">0</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679151917"><span class="hs-identifier hs-var">x</span></a><span>
</span><a name="line-717"></a><span class="hs-identifier">genericIndex</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">_</span><span class="hs-glyph">:</span><a name="local-6989586621679151918"><a href="#local-6989586621679151918"><span class="hs-identifier">xs</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621679151919"><a href="#local-6989586621679151919"><span class="hs-identifier">n</span></a></a><span>
</span><a name="line-718"></a><span> </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621679151919"><span class="hs-identifier hs-var">n</span></a><span> </span><a href="../ghc-prim-0.5.2.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Classes.html#%3E"><span class="hs-operator hs-var">&gt;</span></a><span> </span><span class="hs-number">0</span><span>     </span><span class="hs-glyph">=</span><span> </span><a href="Data.OldList.html#genericIndex"><span class="hs-identifier hs-var">genericIndex</span></a><span> </span><a href="#local-6989586621679151918"><span class="hs-identifier hs-var">xs</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679151919"><span class="hs-identifier hs-var">n</span></a><span class="hs-glyph">-</span><span class="hs-number">1</span><span class="hs-special">)</span><span>
</span><a name="line-719"></a><span> </span><span class="hs-glyph">|</span><span> </span><a href="GHC.Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="GHC.Err.html#errorWithoutStackTrace"><span class="hs-identifier hs-var">errorWithoutStackTrace</span></a><span> </span><span class="hs-string">&quot;List.genericIndex: negative argument.&quot;</span><span>
</span><a name="line-720"></a><span class="hs-identifier">genericIndex</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span>      </span><span class="hs-glyph">=</span><span> </span><a href="GHC.Err.html#errorWithoutStackTrace"><span class="hs-identifier hs-var">errorWithoutStackTrace</span></a><span> </span><span class="hs-string">&quot;List.genericIndex: index too large.&quot;</span><span>
</span><a name="line-721"></a><span>
</span><a name="line-722"></a><span class="hs-comment">-- | The 'genericReplicate' function is an overloaded version of 'replicate',</span><span>
</span><a name="line-723"></a><span class="hs-comment">-- which accepts any 'Integral' value as the number of repetitions to make.</span><span>
</span><a name="line-724"></a><span class="hs-identifier">genericReplicate</span><span>        </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><a href="GHC.Real.html#Integral"><span class="hs-identifier hs-type">Integral</span></a><span> </span><a href="#local-6989586621679151715"><span class="hs-identifier hs-type">i</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="#local-6989586621679151715"><span class="hs-identifier hs-type">i</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679151716"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679151716"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">]</span><span>
</span><a name="line-725"></a><a name="genericReplicate"><a href="Data.OldList.html#genericReplicate"><span class="hs-identifier">genericReplicate</span></a></a><span> </span><a name="local-6989586621679151920"><a href="#local-6989586621679151920"><span class="hs-identifier">n</span></a></a><span> </span><a name="local-6989586621679151921"><a href="#local-6989586621679151921"><span class="hs-identifier">x</span></a></a><span>    </span><span class="hs-glyph">=</span><span>  </span><a href="Data.OldList.html#genericTake"><span class="hs-identifier hs-var">genericTake</span></a><span> </span><a href="#local-6989586621679151920"><span class="hs-identifier hs-var">n</span></a><span> </span><span class="hs-special">(</span><a href="GHC.List.html#repeat"><span class="hs-identifier hs-var">repeat</span></a><span> </span><a href="#local-6989586621679151921"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">)</span><span>
</span><a name="line-726"></a><span>
</span><a name="line-727"></a><span class="hs-comment">-- | The 'zip4' function takes four lists and returns a list of</span><span>
</span><a name="line-728"></a><span class="hs-comment">-- quadruples, analogous to 'zip'.</span><span>
</span><a name="line-729"></a><span class="hs-identifier">zip4</span><span>                    </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679151711"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679151712"><span class="hs-identifier hs-type">b</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679151713"><span class="hs-identifier hs-type">c</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679151714"><span class="hs-identifier hs-type">d</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><a href="#local-6989586621679151711"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">,</span><a href="#local-6989586621679151712"><span class="hs-identifier hs-type">b</span></a><span class="hs-special">,</span><a href="#local-6989586621679151713"><span class="hs-identifier hs-type">c</span></a><span class="hs-special">,</span><a href="#local-6989586621679151714"><span class="hs-identifier hs-type">d</span></a><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><a name="line-730"></a><a name="zip4"><a href="Data.OldList.html#zip4"><span class="hs-identifier">zip4</span></a></a><span>                    </span><span class="hs-glyph">=</span><span>  </span><a href="Data.OldList.html#zipWith4"><span class="hs-identifier hs-var">zipWith4</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">,</span><span class="hs-special">,</span><span class="hs-special">,</span><span class="hs-special">)</span><span>
</span><a name="line-731"></a><span>
</span><a name="line-732"></a><span class="hs-comment">-- | The 'zip5' function takes five lists and returns a list of</span><span>
</span><a name="line-733"></a><span class="hs-comment">-- five-tuples, analogous to 'zip'.</span><span>
</span><a name="line-734"></a><span class="hs-identifier">zip5</span><span>                    </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679151706"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679151707"><span class="hs-identifier hs-type">b</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679151708"><span class="hs-identifier hs-type">c</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679151709"><span class="hs-identifier hs-type">d</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679151710"><span class="hs-identifier hs-type">e</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><a href="#local-6989586621679151706"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">,</span><a href="#local-6989586621679151707"><span class="hs-identifier hs-type">b</span></a><span class="hs-special">,</span><a href="#local-6989586621679151708"><span class="hs-identifier hs-type">c</span></a><span class="hs-special">,</span><a href="#local-6989586621679151709"><span class="hs-identifier hs-type">d</span></a><span class="hs-special">,</span><a href="#local-6989586621679151710"><span class="hs-identifier hs-type">e</span></a><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><a name="line-735"></a><a name="zip5"><a href="Data.OldList.html#zip5"><span class="hs-identifier">zip5</span></a></a><span>                    </span><span class="hs-glyph">=</span><span>  </span><a href="Data.OldList.html#zipWith5"><span class="hs-identifier hs-var">zipWith5</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">,</span><span class="hs-special">,</span><span class="hs-special">,</span><span class="hs-special">,</span><span class="hs-special">)</span><span>
</span><a name="line-736"></a><span>
</span><a name="line-737"></a><span class="hs-comment">-- | The 'zip6' function takes six lists and returns a list of six-tuples,</span><span>
</span><a name="line-738"></a><span class="hs-comment">-- analogous to 'zip'.</span><span>
</span><a name="line-739"></a><span class="hs-identifier">zip6</span><span>                    </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679151700"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679151701"><span class="hs-identifier hs-type">b</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679151702"><span class="hs-identifier hs-type">c</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679151703"><span class="hs-identifier hs-type">d</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679151704"><span class="hs-identifier hs-type">e</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679151705"><span class="hs-identifier hs-type">f</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-740"></a><span>                              </span><span class="hs-special">[</span><span class="hs-special">(</span><a href="#local-6989586621679151700"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">,</span><a href="#local-6989586621679151701"><span class="hs-identifier hs-type">b</span></a><span class="hs-special">,</span><a href="#local-6989586621679151702"><span class="hs-identifier hs-type">c</span></a><span class="hs-special">,</span><a href="#local-6989586621679151703"><span class="hs-identifier hs-type">d</span></a><span class="hs-special">,</span><a href="#local-6989586621679151704"><span class="hs-identifier hs-type">e</span></a><span class="hs-special">,</span><a href="#local-6989586621679151705"><span class="hs-identifier hs-type">f</span></a><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><a name="line-741"></a><a name="zip6"><a href="Data.OldList.html#zip6"><span class="hs-identifier">zip6</span></a></a><span>                    </span><span class="hs-glyph">=</span><span>  </span><a href="Data.OldList.html#zipWith6"><span class="hs-identifier hs-var">zipWith6</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">,</span><span class="hs-special">,</span><span class="hs-special">,</span><span class="hs-special">,</span><span class="hs-special">,</span><span class="hs-special">)</span><span>
</span><a name="line-742"></a><span>
</span><a name="line-743"></a><span class="hs-comment">-- | The 'zip7' function takes seven lists and returns a list of</span><span>
</span><a name="line-744"></a><span class="hs-comment">-- seven-tuples, analogous to 'zip'.</span><span>
</span><a name="line-745"></a><span class="hs-identifier">zip7</span><span>                    </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679151693"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679151694"><span class="hs-identifier hs-type">b</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679151695"><span class="hs-identifier hs-type">c</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679151696"><span class="hs-identifier hs-type">d</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679151697"><span class="hs-identifier hs-type">e</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679151698"><span class="hs-identifier hs-type">f</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-746"></a><span>                              </span><span class="hs-special">[</span><a href="#local-6989586621679151699"><span class="hs-identifier hs-type">g</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><a href="#local-6989586621679151693"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">,</span><a href="#local-6989586621679151694"><span class="hs-identifier hs-type">b</span></a><span class="hs-special">,</span><a href="#local-6989586621679151695"><span class="hs-identifier hs-type">c</span></a><span class="hs-special">,</span><a href="#local-6989586621679151696"><span class="hs-identifier hs-type">d</span></a><span class="hs-special">,</span><a href="#local-6989586621679151697"><span class="hs-identifier hs-type">e</span></a><span class="hs-special">,</span><a href="#local-6989586621679151698"><span class="hs-identifier hs-type">f</span></a><span class="hs-special">,</span><a href="#local-6989586621679151699"><span class="hs-identifier hs-type">g</span></a><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><a name="line-747"></a><a name="zip7"><a href="Data.OldList.html#zip7"><span class="hs-identifier">zip7</span></a></a><span>                    </span><span class="hs-glyph">=</span><span>  </span><a href="Data.OldList.html#zipWith7"><span class="hs-identifier hs-var">zipWith7</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">,</span><span class="hs-special">,</span><span class="hs-special">,</span><span class="hs-special">,</span><span class="hs-special">,</span><span class="hs-special">,</span><span class="hs-special">)</span><span>
</span><a name="line-748"></a><span>
</span><a name="line-749"></a><span class="hs-comment">-- | The 'zipWith4' function takes a function which combines four</span><span>
</span><a name="line-750"></a><span class="hs-comment">-- elements, as well as four lists and returns a list of their point-wise</span><span>
</span><a name="line-751"></a><span class="hs-comment">-- combination, analogous to 'zipWith'.</span><span>
</span><a name="line-752"></a><span class="hs-identifier">zipWith4</span><span>                </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679151688"><span class="hs-identifier hs-type">a</span></a><span class="hs-glyph">-&gt;</span><a href="#local-6989586621679151689"><span class="hs-identifier hs-type">b</span></a><span class="hs-glyph">-&gt;</span><a href="#local-6989586621679151690"><span class="hs-identifier hs-type">c</span></a><span class="hs-glyph">-&gt;</span><a href="#local-6989586621679151691"><span class="hs-identifier hs-type">d</span></a><span class="hs-glyph">-&gt;</span><a href="#local-6989586621679151692"><span class="hs-identifier hs-type">e</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679151688"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">]</span><span class="hs-glyph">-&gt;</span><span class="hs-special">[</span><a href="#local-6989586621679151689"><span class="hs-identifier hs-type">b</span></a><span class="hs-special">]</span><span class="hs-glyph">-&gt;</span><span class="hs-special">[</span><a href="#local-6989586621679151690"><span class="hs-identifier hs-type">c</span></a><span class="hs-special">]</span><span class="hs-glyph">-&gt;</span><span class="hs-special">[</span><a href="#local-6989586621679151691"><span class="hs-identifier hs-type">d</span></a><span class="hs-special">]</span><span class="hs-glyph">-&gt;</span><span class="hs-special">[</span><a href="#local-6989586621679151692"><span class="hs-identifier hs-type">e</span></a><span class="hs-special">]</span><span>
</span><a name="line-753"></a><a name="zipWith4"><a href="Data.OldList.html#zipWith4"><span class="hs-identifier">zipWith4</span></a></a><span> </span><a name="local-6989586621679151922"><a href="#local-6989586621679151922"><span class="hs-identifier">z</span></a></a><span> </span><span class="hs-special">(</span><a name="local-6989586621679151923"><a href="#local-6989586621679151923"><span class="hs-identifier">a</span></a></a><span class="hs-glyph">:</span><span class="hs-keyword">as</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679151925"><a href="#local-6989586621679151925"><span class="hs-identifier">b</span></a></a><span class="hs-glyph">:</span><a name="local-6989586621679151926"><a href="#local-6989586621679151926"><span class="hs-identifier">bs</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679151927"><a href="#local-6989586621679151927"><span class="hs-identifier">c</span></a></a><span class="hs-glyph">:</span><a name="local-6989586621679151928"><a href="#local-6989586621679151928"><span class="hs-identifier">cs</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679151929"><a href="#local-6989586621679151929"><span class="hs-identifier">d</span></a></a><span class="hs-glyph">:</span><a name="local-6989586621679151930"><a href="#local-6989586621679151930"><span class="hs-identifier">ds</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-754"></a><span>                        </span><span class="hs-glyph">=</span><span>  </span><a href="#local-6989586621679151922"><span class="hs-identifier hs-var">z</span></a><span> </span><a href="#local-6989586621679151923"><span class="hs-identifier hs-var">a</span></a><span> </span><a href="#local-6989586621679151925"><span class="hs-identifier hs-var">b</span></a><span> </span><a href="#local-6989586621679151927"><span class="hs-identifier hs-var">c</span></a><span> </span><a href="#local-6989586621679151929"><span class="hs-identifier hs-var">d</span></a><span> </span><span class="hs-glyph">:</span><span> </span><a href="Data.OldList.html#zipWith4"><span class="hs-identifier hs-var">zipWith4</span></a><span> </span><a href="#local-6989586621679151922"><span class="hs-identifier hs-var">z</span></a><span> </span><span class="hs-keyword">as</span><span> </span><a href="#local-6989586621679151926"><span class="hs-identifier hs-var">bs</span></a><span> </span><a href="#local-6989586621679151928"><span class="hs-identifier hs-var">cs</span></a><span> </span><a href="#local-6989586621679151930"><span class="hs-identifier hs-var">ds</span></a><span>
</span><a name="line-755"></a><span class="hs-identifier">zipWith4</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span>      </span><span class="hs-glyph">=</span><span>  </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-756"></a><span>
</span><a name="line-757"></a><span class="hs-comment">-- | The 'zipWith5' function takes a function which combines five</span><span>
</span><a name="line-758"></a><span class="hs-comment">-- elements, as well as five lists and returns a list of their point-wise</span><span>
</span><a name="line-759"></a><span class="hs-comment">-- combination, analogous to 'zipWith'.</span><span>
</span><a name="line-760"></a><span class="hs-identifier">zipWith5</span><span>                </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679151682"><span class="hs-identifier hs-type">a</span></a><span class="hs-glyph">-&gt;</span><a href="#local-6989586621679151683"><span class="hs-identifier hs-type">b</span></a><span class="hs-glyph">-&gt;</span><a href="#local-6989586621679151684"><span class="hs-identifier hs-type">c</span></a><span class="hs-glyph">-&gt;</span><a href="#local-6989586621679151685"><span class="hs-identifier hs-type">d</span></a><span class="hs-glyph">-&gt;</span><a href="#local-6989586621679151686"><span class="hs-identifier hs-type">e</span></a><span class="hs-glyph">-&gt;</span><a href="#local-6989586621679151687"><span class="hs-identifier hs-type">f</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-761"></a><span>                           </span><span class="hs-special">[</span><a href="#local-6989586621679151682"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">]</span><span class="hs-glyph">-&gt;</span><span class="hs-special">[</span><a href="#local-6989586621679151683"><span class="hs-identifier hs-type">b</span></a><span class="hs-special">]</span><span class="hs-glyph">-&gt;</span><span class="hs-special">[</span><a href="#local-6989586621679151684"><span class="hs-identifier hs-type">c</span></a><span class="hs-special">]</span><span class="hs-glyph">-&gt;</span><span class="hs-special">[</span><a href="#local-6989586621679151685"><span class="hs-identifier hs-type">d</span></a><span class="hs-special">]</span><span class="hs-glyph">-&gt;</span><span class="hs-special">[</span><a href="#local-6989586621679151686"><span class="hs-identifier hs-type">e</span></a><span class="hs-special">]</span><span class="hs-glyph">-&gt;</span><span class="hs-special">[</span><a href="#local-6989586621679151687"><span class="hs-identifier hs-type">f</span></a><span class="hs-special">]</span><span>
</span><a name="line-762"></a><a name="zipWith5"><a href="Data.OldList.html#zipWith5"><span class="hs-identifier">zipWith5</span></a></a><span> </span><a name="local-6989586621679151931"><a href="#local-6989586621679151931"><span class="hs-identifier">z</span></a></a><span> </span><span class="hs-special">(</span><a name="local-6989586621679151932"><a href="#local-6989586621679151932"><span class="hs-identifier">a</span></a></a><span class="hs-glyph">:</span><span class="hs-keyword">as</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679151934"><a href="#local-6989586621679151934"><span class="hs-identifier">b</span></a></a><span class="hs-glyph">:</span><a name="local-6989586621679151935"><a href="#local-6989586621679151935"><span class="hs-identifier">bs</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679151936"><a href="#local-6989586621679151936"><span class="hs-identifier">c</span></a></a><span class="hs-glyph">:</span><a name="local-6989586621679151937"><a href="#local-6989586621679151937"><span class="hs-identifier">cs</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679151938"><a href="#local-6989586621679151938"><span class="hs-identifier">d</span></a></a><span class="hs-glyph">:</span><a name="local-6989586621679151939"><a href="#local-6989586621679151939"><span class="hs-identifier">ds</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679151940"><a href="#local-6989586621679151940"><span class="hs-identifier">e</span></a></a><span class="hs-glyph">:</span><a name="local-6989586621679151941"><a href="#local-6989586621679151941"><span class="hs-identifier">es</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-763"></a><span>                        </span><span class="hs-glyph">=</span><span>  </span><a href="#local-6989586621679151931"><span class="hs-identifier hs-var">z</span></a><span> </span><a href="#local-6989586621679151932"><span class="hs-identifier hs-var">a</span></a><span> </span><a href="#local-6989586621679151934"><span class="hs-identifier hs-var">b</span></a><span> </span><a href="#local-6989586621679151936"><span class="hs-identifier hs-var">c</span></a><span> </span><a href="#local-6989586621679151938"><span class="hs-identifier hs-var">d</span></a><span> </span><a href="#local-6989586621679151940"><span class="hs-identifier hs-var">e</span></a><span> </span><span class="hs-glyph">:</span><span> </span><a href="Data.OldList.html#zipWith5"><span class="hs-identifier hs-var">zipWith5</span></a><span> </span><a href="#local-6989586621679151931"><span class="hs-identifier hs-var">z</span></a><span> </span><span class="hs-keyword">as</span><span> </span><a href="#local-6989586621679151935"><span class="hs-identifier hs-var">bs</span></a><span> </span><a href="#local-6989586621679151937"><span class="hs-identifier hs-var">cs</span></a><span> </span><a href="#local-6989586621679151939"><span class="hs-identifier hs-var">ds</span></a><span> </span><a href="#local-6989586621679151941"><span class="hs-identifier hs-var">es</span></a><span>
</span><a name="line-764"></a><span class="hs-identifier">zipWith5</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-765"></a><span>
</span><a name="line-766"></a><span class="hs-comment">-- | The 'zipWith6' function takes a function which combines six</span><span>
</span><a name="line-767"></a><span class="hs-comment">-- elements, as well as six lists and returns a list of their point-wise</span><span>
</span><a name="line-768"></a><span class="hs-comment">-- combination, analogous to 'zipWith'.</span><span>
</span><a name="line-769"></a><span class="hs-identifier">zipWith6</span><span>                </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679151675"><span class="hs-identifier hs-type">a</span></a><span class="hs-glyph">-&gt;</span><a href="#local-6989586621679151676"><span class="hs-identifier hs-type">b</span></a><span class="hs-glyph">-&gt;</span><a href="#local-6989586621679151677"><span class="hs-identifier hs-type">c</span></a><span class="hs-glyph">-&gt;</span><a href="#local-6989586621679151678"><span class="hs-identifier hs-type">d</span></a><span class="hs-glyph">-&gt;</span><a href="#local-6989586621679151679"><span class="hs-identifier hs-type">e</span></a><span class="hs-glyph">-&gt;</span><a href="#local-6989586621679151680"><span class="hs-identifier hs-type">f</span></a><span class="hs-glyph">-&gt;</span><a href="#local-6989586621679151681"><span class="hs-identifier hs-type">g</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-770"></a><span>                           </span><span class="hs-special">[</span><a href="#local-6989586621679151675"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">]</span><span class="hs-glyph">-&gt;</span><span class="hs-special">[</span><a href="#local-6989586621679151676"><span class="hs-identifier hs-type">b</span></a><span class="hs-special">]</span><span class="hs-glyph">-&gt;</span><span class="hs-special">[</span><a href="#local-6989586621679151677"><span class="hs-identifier hs-type">c</span></a><span class="hs-special">]</span><span class="hs-glyph">-&gt;</span><span class="hs-special">[</span><a href="#local-6989586621679151678"><span class="hs-identifier hs-type">d</span></a><span class="hs-special">]</span><span class="hs-glyph">-&gt;</span><span class="hs-special">[</span><a href="#local-6989586621679151679"><span class="hs-identifier hs-type">e</span></a><span class="hs-special">]</span><span class="hs-glyph">-&gt;</span><span class="hs-special">[</span><a href="#local-6989586621679151680"><span class="hs-identifier hs-type">f</span></a><span class="hs-special">]</span><span class="hs-glyph">-&gt;</span><span class="hs-special">[</span><a href="#local-6989586621679151681"><span class="hs-identifier hs-type">g</span></a><span class="hs-special">]</span><span>
</span><a name="line-771"></a><a name="zipWith6"><a href="Data.OldList.html#zipWith6"><span class="hs-identifier">zipWith6</span></a></a><span> </span><a name="local-6989586621679151942"><a href="#local-6989586621679151942"><span class="hs-identifier">z</span></a></a><span> </span><span class="hs-special">(</span><a name="local-6989586621679151943"><a href="#local-6989586621679151943"><span class="hs-identifier">a</span></a></a><span class="hs-glyph">:</span><span class="hs-keyword">as</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679151945"><a href="#local-6989586621679151945"><span class="hs-identifier">b</span></a></a><span class="hs-glyph">:</span><a name="local-6989586621679151946"><a href="#local-6989586621679151946"><span class="hs-identifier">bs</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679151947"><a href="#local-6989586621679151947"><span class="hs-identifier">c</span></a></a><span class="hs-glyph">:</span><a name="local-6989586621679151948"><a href="#local-6989586621679151948"><span class="hs-identifier">cs</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679151949"><a href="#local-6989586621679151949"><span class="hs-identifier">d</span></a></a><span class="hs-glyph">:</span><a name="local-6989586621679151950"><a href="#local-6989586621679151950"><span class="hs-identifier">ds</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679151951"><a href="#local-6989586621679151951"><span class="hs-identifier">e</span></a></a><span class="hs-glyph">:</span><a name="local-6989586621679151952"><a href="#local-6989586621679151952"><span class="hs-identifier">es</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679151953"><a href="#local-6989586621679151953"><span class="hs-identifier">f</span></a></a><span class="hs-glyph">:</span><a name="local-6989586621679151954"><a href="#local-6989586621679151954"><span class="hs-identifier">fs</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-772"></a><span>                        </span><span class="hs-glyph">=</span><span>  </span><a href="#local-6989586621679151942"><span class="hs-identifier hs-var">z</span></a><span> </span><a href="#local-6989586621679151943"><span class="hs-identifier hs-var">a</span></a><span> </span><a href="#local-6989586621679151945"><span class="hs-identifier hs-var">b</span></a><span> </span><a href="#local-6989586621679151947"><span class="hs-identifier hs-var">c</span></a><span> </span><a href="#local-6989586621679151949"><span class="hs-identifier hs-var">d</span></a><span> </span><a href="#local-6989586621679151951"><span class="hs-identifier hs-var">e</span></a><span> </span><a href="#local-6989586621679151953"><span class="hs-identifier hs-var">f</span></a><span> </span><span class="hs-glyph">:</span><span> </span><a href="Data.OldList.html#zipWith6"><span class="hs-identifier hs-var">zipWith6</span></a><span> </span><a href="#local-6989586621679151942"><span class="hs-identifier hs-var">z</span></a><span> </span><span class="hs-keyword">as</span><span> </span><a href="#local-6989586621679151946"><span class="hs-identifier hs-var">bs</span></a><span> </span><a href="#local-6989586621679151948"><span class="hs-identifier hs-var">cs</span></a><span> </span><a href="#local-6989586621679151950"><span class="hs-identifier hs-var">ds</span></a><span> </span><a href="#local-6989586621679151952"><span class="hs-identifier hs-var">es</span></a><span> </span><a href="#local-6989586621679151954"><span class="hs-identifier hs-var">fs</span></a><span>
</span><a name="line-773"></a><span class="hs-identifier">zipWith6</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-774"></a><span>
</span><a name="line-775"></a><span class="hs-comment">-- | The 'zipWith7' function takes a function which combines seven</span><span>
</span><a name="line-776"></a><span class="hs-comment">-- elements, as well as seven lists and returns a list of their point-wise</span><span>
</span><a name="line-777"></a><span class="hs-comment">-- combination, analogous to 'zipWith'.</span><span>
</span><a name="line-778"></a><span class="hs-identifier">zipWith7</span><span>                </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679151667"><span class="hs-identifier hs-type">a</span></a><span class="hs-glyph">-&gt;</span><a href="#local-6989586621679151668"><span class="hs-identifier hs-type">b</span></a><span class="hs-glyph">-&gt;</span><a href="#local-6989586621679151669"><span class="hs-identifier hs-type">c</span></a><span class="hs-glyph">-&gt;</span><a href="#local-6989586621679151670"><span class="hs-identifier hs-type">d</span></a><span class="hs-glyph">-&gt;</span><a href="#local-6989586621679151671"><span class="hs-identifier hs-type">e</span></a><span class="hs-glyph">-&gt;</span><a href="#local-6989586621679151672"><span class="hs-identifier hs-type">f</span></a><span class="hs-glyph">-&gt;</span><a href="#local-6989586621679151673"><span class="hs-identifier hs-type">g</span></a><span class="hs-glyph">-&gt;</span><a href="#local-6989586621679151674"><span class="hs-identifier hs-type">h</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-779"></a><span>                           </span><span class="hs-special">[</span><a href="#local-6989586621679151667"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">]</span><span class="hs-glyph">-&gt;</span><span class="hs-special">[</span><a href="#local-6989586621679151668"><span class="hs-identifier hs-type">b</span></a><span class="hs-special">]</span><span class="hs-glyph">-&gt;</span><span class="hs-special">[</span><a href="#local-6989586621679151669"><span class="hs-identifier hs-type">c</span></a><span class="hs-special">]</span><span class="hs-glyph">-&gt;</span><span class="hs-special">[</span><a href="#local-6989586621679151670"><span class="hs-identifier hs-type">d</span></a><span class="hs-special">]</span><span class="hs-glyph">-&gt;</span><span class="hs-special">[</span><a href="#local-6989586621679151671"><span class="hs-identifier hs-type">e</span></a><span class="hs-special">]</span><span class="hs-glyph">-&gt;</span><span class="hs-special">[</span><a href="#local-6989586621679151672"><span class="hs-identifier hs-type">f</span></a><span class="hs-special">]</span><span class="hs-glyph">-&gt;</span><span class="hs-special">[</span><a href="#local-6989586621679151673"><span class="hs-identifier hs-type">g</span></a><span class="hs-special">]</span><span class="hs-glyph">-&gt;</span><span class="hs-special">[</span><a href="#local-6989586621679151674"><span class="hs-identifier hs-type">h</span></a><span class="hs-special">]</span><span>
</span><a name="line-780"></a><a name="zipWith7"><a href="Data.OldList.html#zipWith7"><span class="hs-identifier">zipWith7</span></a></a><span> </span><a name="local-6989586621679151955"><a href="#local-6989586621679151955"><span class="hs-identifier">z</span></a></a><span> </span><span class="hs-special">(</span><a name="local-6989586621679151956"><a href="#local-6989586621679151956"><span class="hs-identifier">a</span></a></a><span class="hs-glyph">:</span><span class="hs-keyword">as</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679151958"><a href="#local-6989586621679151958"><span class="hs-identifier">b</span></a></a><span class="hs-glyph">:</span><a name="local-6989586621679151959"><a href="#local-6989586621679151959"><span class="hs-identifier">bs</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679151960"><a href="#local-6989586621679151960"><span class="hs-identifier">c</span></a></a><span class="hs-glyph">:</span><a name="local-6989586621679151961"><a href="#local-6989586621679151961"><span class="hs-identifier">cs</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679151962"><a href="#local-6989586621679151962"><span class="hs-identifier">d</span></a></a><span class="hs-glyph">:</span><a name="local-6989586621679151963"><a href="#local-6989586621679151963"><span class="hs-identifier">ds</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679151964"><a href="#local-6989586621679151964"><span class="hs-identifier">e</span></a></a><span class="hs-glyph">:</span><a name="local-6989586621679151965"><a href="#local-6989586621679151965"><span class="hs-identifier">es</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679151966"><a href="#local-6989586621679151966"><span class="hs-identifier">f</span></a></a><span class="hs-glyph">:</span><a name="local-6989586621679151967"><a href="#local-6989586621679151967"><span class="hs-identifier">fs</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679151968"><a href="#local-6989586621679151968"><span class="hs-identifier">g</span></a></a><span class="hs-glyph">:</span><a name="local-6989586621679151969"><a href="#local-6989586621679151969"><span class="hs-identifier">gs</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-781"></a><span>                   </span><span class="hs-glyph">=</span><span>  </span><a href="#local-6989586621679151955"><span class="hs-identifier hs-var">z</span></a><span> </span><a href="#local-6989586621679151956"><span class="hs-identifier hs-var">a</span></a><span> </span><a href="#local-6989586621679151958"><span class="hs-identifier hs-var">b</span></a><span> </span><a href="#local-6989586621679151960"><span class="hs-identifier hs-var">c</span></a><span> </span><a href="#local-6989586621679151962"><span class="hs-identifier hs-var">d</span></a><span> </span><a href="#local-6989586621679151964"><span class="hs-identifier hs-var">e</span></a><span> </span><a href="#local-6989586621679151966"><span class="hs-identifier hs-var">f</span></a><span> </span><a href="#local-6989586621679151968"><span class="hs-identifier hs-var">g</span></a><span> </span><span class="hs-glyph">:</span><span> </span><a href="Data.OldList.html#zipWith7"><span class="hs-identifier hs-var">zipWith7</span></a><span> </span><a href="#local-6989586621679151955"><span class="hs-identifier hs-var">z</span></a><span> </span><span class="hs-keyword">as</span><span> </span><a href="#local-6989586621679151959"><span class="hs-identifier hs-var">bs</span></a><span> </span><a href="#local-6989586621679151961"><span class="hs-identifier hs-var">cs</span></a><span> </span><a href="#local-6989586621679151963"><span class="hs-identifier hs-var">ds</span></a><span> </span><a href="#local-6989586621679151965"><span class="hs-identifier hs-var">es</span></a><span> </span><a href="#local-6989586621679151967"><span class="hs-identifier hs-var">fs</span></a><span> </span><a href="#local-6989586621679151969"><span class="hs-identifier hs-var">gs</span></a><span>
</span><a name="line-782"></a><span class="hs-identifier">zipWith7</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-783"></a><span>
</span><a name="line-784"></a><span class="hs-comment">-- | The 'unzip4' function takes a list of quadruples and returns four</span><span>
</span><a name="line-785"></a><span class="hs-comment">-- lists, analogous to 'unzip'.</span><span>
</span><a name="line-786"></a><span class="hs-identifier">unzip4</span><span>                  </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><a href="#local-6989586621679151663"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">,</span><a href="#local-6989586621679151664"><span class="hs-identifier hs-type">b</span></a><span class="hs-special">,</span><a href="#local-6989586621679151665"><span class="hs-identifier hs-type">c</span></a><span class="hs-special">,</span><a href="#local-6989586621679151666"><span class="hs-identifier hs-type">d</span></a><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><a href="#local-6989586621679151663"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">]</span><span class="hs-special">,</span><span class="hs-special">[</span><a href="#local-6989586621679151664"><span class="hs-identifier hs-type">b</span></a><span class="hs-special">]</span><span class="hs-special">,</span><span class="hs-special">[</span><a href="#local-6989586621679151665"><span class="hs-identifier hs-type">c</span></a><span class="hs-special">]</span><span class="hs-special">,</span><span class="hs-special">[</span><a href="#local-6989586621679151666"><span class="hs-identifier hs-type">d</span></a><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><a name="line-787"></a><a name="unzip4"><a href="Data.OldList.html#unzip4"><span class="hs-identifier">unzip4</span></a></a><span>                  </span><span class="hs-glyph">=</span><span>  </span><a href="GHC.Base.html#foldr"><span class="hs-identifier hs-var">foldr</span></a><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><a name="local-6989586621679151970"><a href="#local-6989586621679151970"><span class="hs-identifier">a</span></a></a><span class="hs-special">,</span><a name="local-6989586621679151971"><a href="#local-6989586621679151971"><span class="hs-identifier">b</span></a></a><span class="hs-special">,</span><a name="local-6989586621679151972"><a href="#local-6989586621679151972"><span class="hs-identifier">c</span></a></a><span class="hs-special">,</span><a name="local-6989586621679151973"><a href="#local-6989586621679151973"><span class="hs-identifier">d</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">~</span><span class="hs-special">(</span><span class="hs-keyword">as</span><span class="hs-special">,</span><a name="local-6989586621679151975"><a href="#local-6989586621679151975"><span class="hs-identifier">bs</span></a></a><span class="hs-special">,</span><a name="local-6989586621679151976"><a href="#local-6989586621679151976"><span class="hs-identifier">cs</span></a></a><span class="hs-special">,</span><a name="local-6989586621679151977"><a href="#local-6989586621679151977"><span class="hs-identifier">ds</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-788"></a><span>                                        </span><span class="hs-special">(</span><a href="#local-6989586621679151970"><span class="hs-identifier hs-var">a</span></a><span class="hs-glyph">:</span><span class="hs-keyword">as</span><span class="hs-special">,</span><a href="#local-6989586621679151971"><span class="hs-identifier hs-var">b</span></a><span class="hs-glyph">:</span><a href="#local-6989586621679151975"><span class="hs-identifier hs-var">bs</span></a><span class="hs-special">,</span><a href="#local-6989586621679151972"><span class="hs-identifier hs-var">c</span></a><span class="hs-glyph">:</span><a href="#local-6989586621679151976"><span class="hs-identifier hs-var">cs</span></a><span class="hs-special">,</span><a href="#local-6989586621679151973"><span class="hs-identifier hs-var">d</span></a><span class="hs-glyph">:</span><a href="#local-6989586621679151977"><span class="hs-identifier hs-var">ds</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-789"></a><span>                                 </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">,</span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">,</span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">,</span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><a name="line-790"></a><span>
</span><a name="line-791"></a><span class="hs-comment">-- | The 'unzip5' function takes a list of five-tuples and returns five</span><span>
</span><a name="line-792"></a><span class="hs-comment">-- lists, analogous to 'unzip'.</span><span>
</span><a name="line-793"></a><span class="hs-identifier">unzip5</span><span>                  </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><a href="#local-6989586621679151658"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">,</span><a href="#local-6989586621679151659"><span class="hs-identifier hs-type">b</span></a><span class="hs-special">,</span><a href="#local-6989586621679151660"><span class="hs-identifier hs-type">c</span></a><span class="hs-special">,</span><a href="#local-6989586621679151661"><span class="hs-identifier hs-type">d</span></a><span class="hs-special">,</span><a href="#local-6989586621679151662"><span class="hs-identifier hs-type">e</span></a><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><a href="#local-6989586621679151658"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">]</span><span class="hs-special">,</span><span class="hs-special">[</span><a href="#local-6989586621679151659"><span class="hs-identifier hs-type">b</span></a><span class="hs-special">]</span><span class="hs-special">,</span><span class="hs-special">[</span><a href="#local-6989586621679151660"><span class="hs-identifier hs-type">c</span></a><span class="hs-special">]</span><span class="hs-special">,</span><span class="hs-special">[</span><a href="#local-6989586621679151661"><span class="hs-identifier hs-type">d</span></a><span class="hs-special">]</span><span class="hs-special">,</span><span class="hs-special">[</span><a href="#local-6989586621679151662"><span class="hs-identifier hs-type">e</span></a><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><a name="line-794"></a><a name="unzip5"><a href="Data.OldList.html#unzip5"><span class="hs-identifier">unzip5</span></a></a><span>                  </span><span class="hs-glyph">=</span><span>  </span><a href="GHC.Base.html#foldr"><span class="hs-identifier hs-var">foldr</span></a><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><a name="local-6989586621679151978"><a href="#local-6989586621679151978"><span class="hs-identifier">a</span></a></a><span class="hs-special">,</span><a name="local-6989586621679151979"><a href="#local-6989586621679151979"><span class="hs-identifier">b</span></a></a><span class="hs-special">,</span><a name="local-6989586621679151980"><a href="#local-6989586621679151980"><span class="hs-identifier">c</span></a></a><span class="hs-special">,</span><a name="local-6989586621679151981"><a href="#local-6989586621679151981"><span class="hs-identifier">d</span></a></a><span class="hs-special">,</span><a name="local-6989586621679151982"><a href="#local-6989586621679151982"><span class="hs-identifier">e</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">~</span><span class="hs-special">(</span><span class="hs-keyword">as</span><span class="hs-special">,</span><a name="local-6989586621679151984"><a href="#local-6989586621679151984"><span class="hs-identifier">bs</span></a></a><span class="hs-special">,</span><a name="local-6989586621679151985"><a href="#local-6989586621679151985"><span class="hs-identifier">cs</span></a></a><span class="hs-special">,</span><a name="local-6989586621679151986"><a href="#local-6989586621679151986"><span class="hs-identifier">ds</span></a></a><span class="hs-special">,</span><a name="local-6989586621679151987"><a href="#local-6989586621679151987"><span class="hs-identifier">es</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-795"></a><span>                                        </span><span class="hs-special">(</span><a href="#local-6989586621679151978"><span class="hs-identifier hs-var">a</span></a><span class="hs-glyph">:</span><span class="hs-keyword">as</span><span class="hs-special">,</span><a href="#local-6989586621679151979"><span class="hs-identifier hs-var">b</span></a><span class="hs-glyph">:</span><a href="#local-6989586621679151984"><span class="hs-identifier hs-var">bs</span></a><span class="hs-special">,</span><a href="#local-6989586621679151980"><span class="hs-identifier hs-var">c</span></a><span class="hs-glyph">:</span><a href="#local-6989586621679151985"><span class="hs-identifier hs-var">cs</span></a><span class="hs-special">,</span><a href="#local-6989586621679151981"><span class="hs-identifier hs-var">d</span></a><span class="hs-glyph">:</span><a href="#local-6989586621679151986"><span class="hs-identifier hs-var">ds</span></a><span class="hs-special">,</span><a href="#local-6989586621679151982"><span class="hs-identifier hs-var">e</span></a><span class="hs-glyph">:</span><a href="#local-6989586621679151987"><span class="hs-identifier hs-var">es</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-796"></a><span>                                 </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">,</span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">,</span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">,</span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">,</span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><a name="line-797"></a><span>
</span><a name="line-798"></a><span class="hs-comment">-- | The 'unzip6' function takes a list of six-tuples and returns six</span><span>
</span><a name="line-799"></a><span class="hs-comment">-- lists, analogous to 'unzip'.</span><span>
</span><a name="line-800"></a><span class="hs-identifier">unzip6</span><span>                  </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><a href="#local-6989586621679151652"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">,</span><a href="#local-6989586621679151653"><span class="hs-identifier hs-type">b</span></a><span class="hs-special">,</span><a href="#local-6989586621679151654"><span class="hs-identifier hs-type">c</span></a><span class="hs-special">,</span><a href="#local-6989586621679151655"><span class="hs-identifier hs-type">d</span></a><span class="hs-special">,</span><a href="#local-6989586621679151656"><span class="hs-identifier hs-type">e</span></a><span class="hs-special">,</span><a href="#local-6989586621679151657"><span class="hs-identifier hs-type">f</span></a><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><a href="#local-6989586621679151652"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">]</span><span class="hs-special">,</span><span class="hs-special">[</span><a href="#local-6989586621679151653"><span class="hs-identifier hs-type">b</span></a><span class="hs-special">]</span><span class="hs-special">,</span><span class="hs-special">[</span><a href="#local-6989586621679151654"><span class="hs-identifier hs-type">c</span></a><span class="hs-special">]</span><span class="hs-special">,</span><span class="hs-special">[</span><a href="#local-6989586621679151655"><span class="hs-identifier hs-type">d</span></a><span class="hs-special">]</span><span class="hs-special">,</span><span class="hs-special">[</span><a href="#local-6989586621679151656"><span class="hs-identifier hs-type">e</span></a><span class="hs-special">]</span><span class="hs-special">,</span><span class="hs-special">[</span><a href="#local-6989586621679151657"><span class="hs-identifier hs-type">f</span></a><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><a name="line-801"></a><a name="unzip6"><a href="Data.OldList.html#unzip6"><span class="hs-identifier">unzip6</span></a></a><span>                  </span><span class="hs-glyph">=</span><span>  </span><a href="GHC.Base.html#foldr"><span class="hs-identifier hs-var">foldr</span></a><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><a name="local-6989586621679151988"><a href="#local-6989586621679151988"><span class="hs-identifier">a</span></a></a><span class="hs-special">,</span><a name="local-6989586621679151989"><a href="#local-6989586621679151989"><span class="hs-identifier">b</span></a></a><span class="hs-special">,</span><a name="local-6989586621679151990"><a href="#local-6989586621679151990"><span class="hs-identifier">c</span></a></a><span class="hs-special">,</span><a name="local-6989586621679151991"><a href="#local-6989586621679151991"><span class="hs-identifier">d</span></a></a><span class="hs-special">,</span><a name="local-6989586621679151992"><a href="#local-6989586621679151992"><span class="hs-identifier">e</span></a></a><span class="hs-special">,</span><a name="local-6989586621679151993"><a href="#local-6989586621679151993"><span class="hs-identifier">f</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">~</span><span class="hs-special">(</span><span class="hs-keyword">as</span><span class="hs-special">,</span><a name="local-6989586621679151995"><a href="#local-6989586621679151995"><span class="hs-identifier">bs</span></a></a><span class="hs-special">,</span><a name="local-6989586621679151996"><a href="#local-6989586621679151996"><span class="hs-identifier">cs</span></a></a><span class="hs-special">,</span><a name="local-6989586621679151997"><a href="#local-6989586621679151997"><span class="hs-identifier">ds</span></a></a><span class="hs-special">,</span><a name="local-6989586621679151998"><a href="#local-6989586621679151998"><span class="hs-identifier">es</span></a></a><span class="hs-special">,</span><a name="local-6989586621679151999"><a href="#local-6989586621679151999"><span class="hs-identifier">fs</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-802"></a><span>                                        </span><span class="hs-special">(</span><a href="#local-6989586621679151988"><span class="hs-identifier hs-var">a</span></a><span class="hs-glyph">:</span><span class="hs-keyword">as</span><span class="hs-special">,</span><a href="#local-6989586621679151989"><span class="hs-identifier hs-var">b</span></a><span class="hs-glyph">:</span><a href="#local-6989586621679151995"><span class="hs-identifier hs-var">bs</span></a><span class="hs-special">,</span><a href="#local-6989586621679151990"><span class="hs-identifier hs-var">c</span></a><span class="hs-glyph">:</span><a href="#local-6989586621679151996"><span class="hs-identifier hs-var">cs</span></a><span class="hs-special">,</span><a href="#local-6989586621679151991"><span class="hs-identifier hs-var">d</span></a><span class="hs-glyph">:</span><a href="#local-6989586621679151997"><span class="hs-identifier hs-var">ds</span></a><span class="hs-special">,</span><a href="#local-6989586621679151992"><span class="hs-identifier hs-var">e</span></a><span class="hs-glyph">:</span><a href="#local-6989586621679151998"><span class="hs-identifier hs-var">es</span></a><span class="hs-special">,</span><a href="#local-6989586621679151993"><span class="hs-identifier hs-var">f</span></a><span class="hs-glyph">:</span><a href="#local-6989586621679151999"><span class="hs-identifier hs-var">fs</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-803"></a><span>                                 </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">,</span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">,</span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">,</span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">,</span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">,</span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><a name="line-804"></a><span>
</span><a name="line-805"></a><span class="hs-comment">-- | The 'unzip7' function takes a list of seven-tuples and returns</span><span>
</span><a name="line-806"></a><span class="hs-comment">-- seven lists, analogous to 'unzip'.</span><span>
</span><a name="line-807"></a><span class="hs-identifier">unzip7</span><span>          </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><a href="#local-6989586621679151645"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">,</span><a href="#local-6989586621679151646"><span class="hs-identifier hs-type">b</span></a><span class="hs-special">,</span><a href="#local-6989586621679151647"><span class="hs-identifier hs-type">c</span></a><span class="hs-special">,</span><a href="#local-6989586621679151648"><span class="hs-identifier hs-type">d</span></a><span class="hs-special">,</span><a href="#local-6989586621679151649"><span class="hs-identifier hs-type">e</span></a><span class="hs-special">,</span><a href="#local-6989586621679151650"><span class="hs-identifier hs-type">f</span></a><span class="hs-special">,</span><a href="#local-6989586621679151651"><span class="hs-identifier hs-type">g</span></a><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><a href="#local-6989586621679151645"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">]</span><span class="hs-special">,</span><span class="hs-special">[</span><a href="#local-6989586621679151646"><span class="hs-identifier hs-type">b</span></a><span class="hs-special">]</span><span class="hs-special">,</span><span class="hs-special">[</span><a href="#local-6989586621679151647"><span class="hs-identifier hs-type">c</span></a><span class="hs-special">]</span><span class="hs-special">,</span><span class="hs-special">[</span><a href="#local-6989586621679151648"><span class="hs-identifier hs-type">d</span></a><span class="hs-special">]</span><span class="hs-special">,</span><span class="hs-special">[</span><a href="#local-6989586621679151649"><span class="hs-identifier hs-type">e</span></a><span class="hs-special">]</span><span class="hs-special">,</span><span class="hs-special">[</span><a href="#local-6989586621679151650"><span class="hs-identifier hs-type">f</span></a><span class="hs-special">]</span><span class="hs-special">,</span><span class="hs-special">[</span><a href="#local-6989586621679151651"><span class="hs-identifier hs-type">g</span></a><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><a name="line-808"></a><a name="unzip7"><a href="Data.OldList.html#unzip7"><span class="hs-identifier">unzip7</span></a></a><span>          </span><span class="hs-glyph">=</span><span>  </span><a href="GHC.Base.html#foldr"><span class="hs-identifier hs-var">foldr</span></a><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><a name="local-6989586621679152000"><a href="#local-6989586621679152000"><span class="hs-identifier">a</span></a></a><span class="hs-special">,</span><a name="local-6989586621679152001"><a href="#local-6989586621679152001"><span class="hs-identifier">b</span></a></a><span class="hs-special">,</span><a name="local-6989586621679152002"><a href="#local-6989586621679152002"><span class="hs-identifier">c</span></a></a><span class="hs-special">,</span><a name="local-6989586621679152003"><a href="#local-6989586621679152003"><span class="hs-identifier">d</span></a></a><span class="hs-special">,</span><a name="local-6989586621679152004"><a href="#local-6989586621679152004"><span class="hs-identifier">e</span></a></a><span class="hs-special">,</span><a name="local-6989586621679152005"><a href="#local-6989586621679152005"><span class="hs-identifier">f</span></a></a><span class="hs-special">,</span><a name="local-6989586621679152006"><a href="#local-6989586621679152006"><span class="hs-identifier">g</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">~</span><span class="hs-special">(</span><span class="hs-keyword">as</span><span class="hs-special">,</span><a name="local-6989586621679152008"><a href="#local-6989586621679152008"><span class="hs-identifier">bs</span></a></a><span class="hs-special">,</span><a name="local-6989586621679152009"><a href="#local-6989586621679152009"><span class="hs-identifier">cs</span></a></a><span class="hs-special">,</span><a name="local-6989586621679152010"><a href="#local-6989586621679152010"><span class="hs-identifier">ds</span></a></a><span class="hs-special">,</span><a name="local-6989586621679152011"><a href="#local-6989586621679152011"><span class="hs-identifier">es</span></a></a><span class="hs-special">,</span><a name="local-6989586621679152012"><a href="#local-6989586621679152012"><span class="hs-identifier">fs</span></a></a><span class="hs-special">,</span><a name="local-6989586621679152013"><a href="#local-6989586621679152013"><span class="hs-identifier">gs</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-809"></a><span>                                </span><span class="hs-special">(</span><a href="#local-6989586621679152000"><span class="hs-identifier hs-var">a</span></a><span class="hs-glyph">:</span><span class="hs-keyword">as</span><span class="hs-special">,</span><a href="#local-6989586621679152001"><span class="hs-identifier hs-var">b</span></a><span class="hs-glyph">:</span><a href="#local-6989586621679152008"><span class="hs-identifier hs-var">bs</span></a><span class="hs-special">,</span><a href="#local-6989586621679152002"><span class="hs-identifier hs-var">c</span></a><span class="hs-glyph">:</span><a href="#local-6989586621679152009"><span class="hs-identifier hs-var">cs</span></a><span class="hs-special">,</span><a href="#local-6989586621679152003"><span class="hs-identifier hs-var">d</span></a><span class="hs-glyph">:</span><a href="#local-6989586621679152010"><span class="hs-identifier hs-var">ds</span></a><span class="hs-special">,</span><a href="#local-6989586621679152004"><span class="hs-identifier hs-var">e</span></a><span class="hs-glyph">:</span><a href="#local-6989586621679152011"><span class="hs-identifier hs-var">es</span></a><span class="hs-special">,</span><a href="#local-6989586621679152005"><span class="hs-identifier hs-var">f</span></a><span class="hs-glyph">:</span><a href="#local-6989586621679152012"><span class="hs-identifier hs-var">fs</span></a><span class="hs-special">,</span><a href="#local-6989586621679152006"><span class="hs-identifier hs-var">g</span></a><span class="hs-glyph">:</span><a href="#local-6989586621679152013"><span class="hs-identifier hs-var">gs</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-810"></a><span>                         </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">,</span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">,</span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">,</span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">,</span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">,</span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">,</span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><a name="line-811"></a><span>
</span><a name="line-812"></a><span>
</span><a name="line-813"></a><span class="hs-comment">-- | The 'deleteFirstsBy' function takes a predicate and two lists and</span><span>
</span><a name="line-814"></a><span class="hs-comment">-- returns the first list with the first occurrence of each element of</span><span>
</span><a name="line-815"></a><span class="hs-comment">-- the second list removed.</span><span>
</span><a name="line-816"></a><span class="hs-identifier">deleteFirstsBy</span><span>          </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679151644"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679151644"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../ghc-prim-0.5.2.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Types.html#Bool"><span class="hs-identifier hs-type">Bool</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679151644"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679151644"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679151644"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">]</span><span>
</span><a name="line-817"></a><a name="deleteFirstsBy"><a href="Data.OldList.html#deleteFirstsBy"><span class="hs-identifier">deleteFirstsBy</span></a></a><span> </span><a name="local-6989586621679152014"><a href="#local-6989586621679152014"><span class="hs-identifier">eq</span></a></a><span>       </span><span class="hs-glyph">=</span><span>  </span><a href="GHC.List.html#foldl"><span class="hs-identifier hs-var">foldl</span></a><span> </span><span class="hs-special">(</span><a href="GHC.Base.html#flip"><span class="hs-identifier hs-var">flip</span></a><span> </span><span class="hs-special">(</span><a href="Data.OldList.html#deleteBy"><span class="hs-identifier hs-var">deleteBy</span></a><span> </span><a href="#local-6989586621679152014"><span class="hs-identifier hs-var">eq</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-818"></a><span>
</span><a name="line-819"></a><span class="hs-comment">-- | The 'group' function takes a list and returns a list of lists such</span><span>
</span><a name="line-820"></a><span class="hs-comment">-- that the concatenation of the result is equal to the argument.  Moreover,</span><span>
</span><a name="line-821"></a><span class="hs-comment">-- each sublist in the result contains only equal elements.  For example,</span><span>
</span><a name="line-822"></a><span class="hs-comment">--</span><span>
</span><a name="line-823"></a><span class="hs-comment">-- &gt;&gt;&gt; group &quot;Mississippi&quot;</span><span>
</span><a name="line-824"></a><span class="hs-comment">-- [&quot;M&quot;,&quot;i&quot;,&quot;ss&quot;,&quot;i&quot;,&quot;ss&quot;,&quot;i&quot;,&quot;pp&quot;,&quot;i&quot;]</span><span>
</span><a name="line-825"></a><span class="hs-comment">--</span><span>
</span><a name="line-826"></a><span class="hs-comment">-- It is a special case of 'groupBy', which allows the programmer to supply</span><span>
</span><a name="line-827"></a><span class="hs-comment">-- their own equality test.</span><span>
</span><a name="line-828"></a><span class="hs-identifier">group</span><span>                   </span><span class="hs-glyph">::</span><span> </span><a href="../ghc-prim-0.5.2.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Classes.html#Eq"><span class="hs-identifier hs-type">Eq</span></a><span> </span><a href="#local-6989586621679151643"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679151643"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">[</span><a href="#local-6989586621679151643"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">]</span><span class="hs-special">]</span><span>
</span><a name="line-829"></a><a name="group"><a href="Data.OldList.html#group"><span class="hs-identifier">group</span></a></a><span>                   </span><span class="hs-glyph">=</span><span>  </span><a href="Data.OldList.html#groupBy"><span class="hs-identifier hs-var">groupBy</span></a><span> </span><span class="hs-special">(</span><a href="../ghc-prim-0.5.2.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Classes.html#%3D%3D"><span class="hs-operator hs-var">==</span></a><span class="hs-special">)</span><span>
</span><a name="line-830"></a><span>
</span><a name="line-831"></a><span class="hs-comment">-- | The 'groupBy' function is the non-overloaded version of 'group'.</span><span>
</span><a name="line-832"></a><span class="hs-identifier">groupBy</span><span>                 </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679151642"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679151642"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../ghc-prim-0.5.2.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Types.html#Bool"><span class="hs-identifier hs-type">Bool</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679151642"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">[</span><a href="#local-6989586621679151642"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">]</span><span class="hs-special">]</span><span>
</span><a name="line-833"></a><a name="groupBy"><a href="Data.OldList.html#groupBy"><span class="hs-identifier">groupBy</span></a></a><span> </span><span class="hs-identifier">_</span><span>  </span><span class="hs-special">[</span><span class="hs-special">]</span><span>           </span><span class="hs-glyph">=</span><span>  </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-834"></a><span class="hs-identifier">groupBy</span><span> </span><a name="local-6989586621679152015"><a href="#local-6989586621679152015"><span class="hs-identifier">eq</span></a></a><span> </span><span class="hs-special">(</span><a name="local-6989586621679152016"><a href="#local-6989586621679152016"><span class="hs-identifier">x</span></a></a><span class="hs-glyph">:</span><a name="local-6989586621679152017"><a href="#local-6989586621679152017"><span class="hs-identifier">xs</span></a></a><span class="hs-special">)</span><span>       </span><span class="hs-glyph">=</span><span>  </span><span class="hs-special">(</span><a href="#local-6989586621679152016"><span class="hs-identifier hs-var">x</span></a><span class="hs-glyph">:</span><a href="#local-6989586621679152018"><span class="hs-identifier hs-var">ys</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">:</span><span> </span><a href="Data.OldList.html#groupBy"><span class="hs-identifier hs-var">groupBy</span></a><span> </span><a href="#local-6989586621679152015"><span class="hs-identifier hs-var">eq</span></a><span> </span><a href="#local-6989586621679152019"><span class="hs-identifier hs-var">zs</span></a><span>
</span><a name="line-835"></a><span>                           </span><span class="hs-keyword">where</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679152018"><a href="#local-6989586621679152018"><span class="hs-identifier">ys</span></a></a><span class="hs-special">,</span><a name="local-6989586621679152019"><a href="#local-6989586621679152019"><span class="hs-identifier">zs</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="GHC.List.html#span"><span class="hs-identifier hs-var">span</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679152015"><span class="hs-identifier hs-var">eq</span></a><span> </span><a href="#local-6989586621679152016"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679152017"><span class="hs-identifier hs-var">xs</span></a><span>
</span><a name="line-836"></a><span>
</span><a name="line-837"></a><span class="hs-comment">-- | The 'inits' function returns all initial segments of the argument,</span><span>
</span><a name="line-838"></a><span class="hs-comment">-- shortest first.  For example,</span><span>
</span><a name="line-839"></a><span class="hs-comment">--</span><span>
</span><a name="line-840"></a><span class="hs-comment">-- &gt;&gt;&gt; inits &quot;abc&quot;</span><span>
</span><a name="line-841"></a><span class="hs-comment">-- [&quot;&quot;,&quot;a&quot;,&quot;ab&quot;,&quot;abc&quot;]</span><span>
</span><a name="line-842"></a><span class="hs-comment">--</span><span>
</span><a name="line-843"></a><span class="hs-comment">-- Note that 'inits' has the following strictness property:</span><span>
</span><a name="line-844"></a><span class="hs-comment">-- @inits (xs ++ _|_) = inits xs ++ _|_@</span><span>
</span><a name="line-845"></a><span class="hs-comment">--</span><span>
</span><a name="line-846"></a><span class="hs-comment">-- In particular,</span><span>
</span><a name="line-847"></a><span class="hs-comment">-- @inits _|_ = [] : _|_@</span><span>
</span><a name="line-848"></a><span class="hs-identifier">inits</span><span>                   </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679151641"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">[</span><a href="#local-6989586621679151641"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">]</span><span class="hs-special">]</span><span>
</span><a name="line-849"></a><a name="inits"><a href="Data.OldList.html#inits"><span class="hs-identifier">inits</span></a></a><span>                   </span><span class="hs-glyph">=</span><span> </span><a href="GHC.Base.html#map"><span class="hs-identifier hs-var">map</span></a><span> </span><a href="Data.OldList.html#toListSB"><span class="hs-identifier hs-var">toListSB</span></a><span> </span><a href="GHC.Base.html#."><span class="hs-operator hs-var">.</span></a><span> </span><a href="GHC.List.html#scanl%27"><span class="hs-identifier hs-var">scanl'</span></a><span> </span><a href="Data.OldList.html#snocSB"><span class="hs-identifier hs-var">snocSB</span></a><span> </span><a href="Data.OldList.html#emptySB"><span class="hs-identifier hs-var">emptySB</span></a><span>
</span><a name="line-850"></a><span class="hs-pragma">{-# NOINLINE</span><span> </span><span class="hs-pragma">inits</span><span> </span><span class="hs-pragma">#-}</span><span>
</span><a name="line-851"></a><span>
</span><a name="line-852"></a><span class="hs-comment">-- We do not allow inits to inline, because it plays havoc with Call Arity</span><span>
</span><a name="line-853"></a><span class="hs-comment">-- if it fuses with a consumer, and it would generally lead to serious</span><span>
</span><a name="line-854"></a><span class="hs-comment">-- loss of sharing if allowed to fuse with a producer.</span><span>
</span><a name="line-855"></a><span>
</span><a name="line-856"></a><span class="hs-comment">-- | The 'tails' function returns all final segments of the argument,</span><span>
</span><a name="line-857"></a><span class="hs-comment">-- longest first.  For example,</span><span>
</span><a name="line-858"></a><span class="hs-comment">--</span><span>
</span><a name="line-859"></a><span class="hs-comment">-- &gt;&gt;&gt; tails &quot;abc&quot;</span><span>
</span><a name="line-860"></a><span class="hs-comment">-- [&quot;abc&quot;,&quot;bc&quot;,&quot;c&quot;,&quot;&quot;]</span><span>
</span><a name="line-861"></a><span class="hs-comment">--</span><span>
</span><a name="line-862"></a><span class="hs-comment">-- Note that 'tails' has the following strictness property:</span><span>
</span><a name="line-863"></a><span class="hs-comment">-- @tails _|_ = _|_ : _|_@</span><span>
</span><a name="line-864"></a><span class="hs-identifier">tails</span><span>                   </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679151640"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">[</span><a href="#local-6989586621679151640"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">]</span><span class="hs-special">]</span><span>
</span><a name="line-865"></a><span class="hs-pragma">{-# INLINABLE</span><span> </span><span class="hs-pragma">tails</span><span> </span><span class="hs-pragma">#-}</span><span>
</span><a name="line-866"></a><a name="tails"><a href="Data.OldList.html#tails"><span class="hs-identifier">tails</span></a></a><span> </span><a name="local-6989586621679152020"><a href="#local-6989586621679152020"><span class="hs-identifier">lst</span></a></a><span>               </span><span class="hs-glyph">=</span><span>  </span><a href="GHC.Base.html#build"><span class="hs-identifier hs-var">build</span></a><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><a name="local-6989586621679152021"><a href="#local-6989586621679152021"><span class="hs-identifier">c</span></a></a><span> </span><a name="local-6989586621679152022"><a href="#local-6989586621679152022"><span class="hs-identifier">n</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-867"></a><span>  </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679152023"><a href="#local-6989586621679152023"><span class="hs-identifier">tailsGo</span></a></a><span> </span><a name="local-6989586621679152024"><a href="#local-6989586621679152024"><span class="hs-identifier">xs</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679152024"><span class="hs-identifier hs-var">xs</span></a><span> </span><span class="hs-special">`</span><a href="#local-6989586621679152021"><span class="hs-identifier hs-var">c</span></a><span class="hs-special">`</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621679152024"><span class="hs-identifier hs-var">xs</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-868"></a><span>                             </span><span class="hs-special">[</span><span class="hs-special">]</span><span>      </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679152022"><span class="hs-identifier hs-var">n</span></a><span>
</span><a name="line-869"></a><span>                             </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">:</span><span> </span><a name="local-6989586621679152025"><a href="#local-6989586621679152025"><span class="hs-identifier">xs'</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679152023"><span class="hs-identifier hs-var">tailsGo</span></a><span> </span><a href="#local-6989586621679152025"><span class="hs-identifier hs-var">xs'</span></a><span>
</span><a name="line-870"></a><span>  </span><span class="hs-keyword">in</span><span> </span><a href="#local-6989586621679152023"><span class="hs-identifier hs-var">tailsGo</span></a><span> </span><a href="#local-6989586621679152020"><span class="hs-identifier hs-var">lst</span></a><span class="hs-special">)</span><span>
</span><a name="line-871"></a><span>
</span><a name="line-872"></a><span class="hs-comment">-- | The 'subsequences' function returns the list of all subsequences of the argument.</span><span>
</span><a name="line-873"></a><span class="hs-comment">--</span><span>
</span><a name="line-874"></a><span class="hs-comment">-- &gt;&gt;&gt; subsequences &quot;abc&quot;</span><span>
</span><a name="line-875"></a><span class="hs-comment">-- [&quot;&quot;,&quot;a&quot;,&quot;b&quot;,&quot;ab&quot;,&quot;c&quot;,&quot;ac&quot;,&quot;bc&quot;,&quot;abc&quot;]</span><span>
</span><a name="line-876"></a><span class="hs-identifier">subsequences</span><span>            </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679151639"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">[</span><a href="#local-6989586621679151639"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">]</span><span class="hs-special">]</span><span>
</span><a name="line-877"></a><a name="subsequences"><a href="Data.OldList.html#subsequences"><span class="hs-identifier">subsequences</span></a></a><span> </span><a name="local-6989586621679152026"><a href="#local-6989586621679152026"><span class="hs-identifier">xs</span></a></a><span>         </span><span class="hs-glyph">=</span><span>  </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">:</span><span> </span><a href="Data.OldList.html#nonEmptySubsequences"><span class="hs-identifier hs-var">nonEmptySubsequences</span></a><span> </span><a href="#local-6989586621679152026"><span class="hs-identifier hs-var">xs</span></a><span>
</span><a name="line-878"></a><span>
</span><a name="line-879"></a><span class="hs-comment">-- | The 'nonEmptySubsequences' function returns the list of all subsequences of the argument,</span><span>
</span><a name="line-880"></a><span class="hs-comment">--   except for the empty list.</span><span>
</span><a name="line-881"></a><span class="hs-comment">--</span><span>
</span><a name="line-882"></a><span class="hs-comment">-- &gt;&gt;&gt; nonEmptySubsequences &quot;abc&quot;</span><span>
</span><a name="line-883"></a><span class="hs-comment">-- [&quot;a&quot;,&quot;b&quot;,&quot;ab&quot;,&quot;c&quot;,&quot;ac&quot;,&quot;bc&quot;,&quot;abc&quot;]</span><span>
</span><a name="line-884"></a><span class="hs-identifier">nonEmptySubsequences</span><span>         </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679151638"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">[</span><a href="#local-6989586621679151638"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">]</span><span class="hs-special">]</span><span>
</span><a name="line-885"></a><a name="nonEmptySubsequences"><a href="Data.OldList.html#nonEmptySubsequences"><span class="hs-identifier">nonEmptySubsequences</span></a></a><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>      </span><span class="hs-glyph">=</span><span>  </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-886"></a><span class="hs-identifier">nonEmptySubsequences</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679152027"><a href="#local-6989586621679152027"><span class="hs-identifier">x</span></a></a><span class="hs-glyph">:</span><a name="local-6989586621679152028"><a href="#local-6989586621679152028"><span class="hs-identifier">xs</span></a></a><span class="hs-special">)</span><span>  </span><span class="hs-glyph">=</span><span>  </span><span class="hs-special">[</span><a href="#local-6989586621679152027"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">:</span><span> </span><a href="GHC.Base.html#foldr"><span class="hs-identifier hs-var">foldr</span></a><span> </span><a href="#local-6989586621679152029"><span class="hs-identifier hs-var">f</span></a><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-special">(</span><a href="Data.OldList.html#nonEmptySubsequences"><span class="hs-identifier hs-var">nonEmptySubsequences</span></a><span> </span><a href="#local-6989586621679152028"><span class="hs-identifier hs-var">xs</span></a><span class="hs-special">)</span><span>
</span><a name="line-887"></a><span>  </span><span class="hs-keyword">where</span><span> </span><a name="local-6989586621679152029"><a href="#local-6989586621679152029"><span class="hs-identifier">f</span></a></a><span> </span><a name="local-6989586621679152030"><a href="#local-6989586621679152030"><span class="hs-identifier">ys</span></a></a><span> </span><a name="local-6989586621679152031"><a href="#local-6989586621679152031"><span class="hs-identifier">r</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679152030"><span class="hs-identifier hs-var">ys</span></a><span> </span><span class="hs-glyph">:</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679152027"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-glyph">:</span><span> </span><a href="#local-6989586621679152030"><span class="hs-identifier hs-var">ys</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">:</span><span> </span><a href="#local-6989586621679152031"><span class="hs-identifier hs-var">r</span></a><span>
</span><a name="line-888"></a><span>
</span><a name="line-889"></a><span>
</span><a name="line-890"></a><span class="hs-comment">-- | The 'permutations' function returns the list of all permutations of the argument.</span><span>
</span><a name="line-891"></a><span class="hs-comment">--</span><span>
</span><a name="line-892"></a><span class="hs-comment">-- &gt;&gt;&gt; permutations &quot;abc&quot;</span><span>
</span><a name="line-893"></a><span class="hs-comment">-- [&quot;abc&quot;,&quot;bac&quot;,&quot;cba&quot;,&quot;bca&quot;,&quot;cab&quot;,&quot;acb&quot;]</span><span>
</span><a name="line-894"></a><span class="hs-identifier">permutations</span><span>            </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679151637"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">[</span><a href="#local-6989586621679151637"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">]</span><span class="hs-special">]</span><span>
</span><a name="line-895"></a><a name="permutations"><a href="Data.OldList.html#permutations"><span class="hs-identifier">permutations</span></a></a><span> </span><a name="local-6989586621679152032"><a href="#local-6989586621679152032"><span class="hs-identifier">xs0</span></a></a><span>        </span><span class="hs-glyph">=</span><span>  </span><a href="#local-6989586621679152032"><span class="hs-identifier hs-var">xs0</span></a><span> </span><span class="hs-glyph">:</span><span> </span><a href="#local-6989586621679152033"><span class="hs-identifier hs-var">perms</span></a><span> </span><a href="#local-6989586621679152032"><span class="hs-identifier hs-var">xs0</span></a><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-896"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-897"></a><span>    </span><a name="local-6989586621679152033"><a href="#local-6989586621679152033"><span class="hs-identifier">perms</span></a></a><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>     </span><span class="hs-identifier">_</span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-898"></a><span>    </span><span class="hs-identifier">perms</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679152034"><a href="#local-6989586621679152034"><span class="hs-identifier">t</span></a></a><span class="hs-glyph">:</span><a name="local-6989586621679152035"><a href="#local-6989586621679152035"><span class="hs-identifier">ts</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621679152036"><a href="#local-6989586621679152036"><span class="hs-identifier">is</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="GHC.Base.html#foldr"><span class="hs-identifier hs-var">foldr</span></a><span> </span><a href="#local-6989586621679152037"><span class="hs-identifier hs-var">interleave</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679152033"><span class="hs-identifier hs-var">perms</span></a><span> </span><a href="#local-6989586621679152035"><span class="hs-identifier hs-var">ts</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679152034"><span class="hs-identifier hs-var">t</span></a><span class="hs-glyph">:</span><a href="#local-6989586621679152036"><span class="hs-identifier hs-var">is</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Data.OldList.html#permutations"><span class="hs-identifier hs-var">permutations</span></a><span> </span><a href="#local-6989586621679152036"><span class="hs-identifier hs-var">is</span></a><span class="hs-special">)</span><span>
</span><a name="line-899"></a><span>      </span><span class="hs-keyword">where</span><span> </span><a name="local-6989586621679152037"><a href="#local-6989586621679152037"><span class="hs-identifier">interleave</span></a></a><span>    </span><a name="local-6989586621679152039"><a href="#local-6989586621679152039"><span class="hs-identifier">xs</span></a></a><span>     </span><a name="local-6989586621679152040"><a href="#local-6989586621679152040"><span class="hs-identifier">r</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">_</span><span class="hs-special">,</span><a name="local-6989586621679152041"><a href="#local-6989586621679152041"><span class="hs-identifier">zs</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679152038"><span class="hs-identifier hs-var">interleave'</span></a><span> </span><a href="GHC.Base.html#id"><span class="hs-identifier hs-var">id</span></a><span> </span><a href="#local-6989586621679152039"><span class="hs-identifier hs-var">xs</span></a><span> </span><a href="#local-6989586621679152040"><span class="hs-identifier hs-var">r</span></a><span> </span><span class="hs-keyword">in</span><span> </span><a href="#local-6989586621679152041"><span class="hs-identifier hs-var">zs</span></a><span>
</span><a name="line-900"></a><span>            </span><a name="local-6989586621679152038"><a href="#local-6989586621679152038"><span class="hs-identifier">interleave'</span></a></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>     </span><a name="local-6989586621679152042"><a href="#local-6989586621679152042"><span class="hs-identifier">r</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679152035"><span class="hs-identifier hs-var">ts</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679152042"><span class="hs-identifier hs-var">r</span></a><span class="hs-special">)</span><span>
</span><a name="line-901"></a><span>            </span><span class="hs-identifier">interleave'</span><span> </span><a name="local-6989586621679152043"><a href="#local-6989586621679152043"><span class="hs-identifier">f</span></a></a><span> </span><span class="hs-special">(</span><a name="local-6989586621679152044"><a href="#local-6989586621679152044"><span class="hs-identifier">y</span></a></a><span class="hs-glyph">:</span><a name="local-6989586621679152045"><a href="#local-6989586621679152045"><span class="hs-identifier">ys</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621679152046"><a href="#local-6989586621679152046"><span class="hs-identifier">r</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679152047"><a href="#local-6989586621679152047"><span class="hs-identifier">us</span></a></a><span class="hs-special">,</span><a name="local-6989586621679152048"><a href="#local-6989586621679152048"><span class="hs-identifier">zs</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679152038"><span class="hs-identifier hs-var">interleave'</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679152043"><span class="hs-identifier hs-var">f</span></a><span> </span><a href="GHC.Base.html#."><span class="hs-operator hs-var">.</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679152044"><span class="hs-identifier hs-var">y</span></a><span class="hs-glyph">:</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679152045"><span class="hs-identifier hs-var">ys</span></a><span> </span><a href="#local-6989586621679152046"><span class="hs-identifier hs-var">r</span></a><span>
</span><a name="line-902"></a><span>                                     </span><span class="hs-keyword">in</span><span>  </span><span class="hs-special">(</span><a href="#local-6989586621679152044"><span class="hs-identifier hs-var">y</span></a><span class="hs-glyph">:</span><a href="#local-6989586621679152047"><span class="hs-identifier hs-var">us</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679152043"><span class="hs-identifier hs-var">f</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679152034"><span class="hs-identifier hs-var">t</span></a><span class="hs-glyph">:</span><a href="#local-6989586621679152044"><span class="hs-identifier hs-var">y</span></a><span class="hs-glyph">:</span><a href="#local-6989586621679152047"><span class="hs-identifier hs-var">us</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">:</span><span> </span><a href="#local-6989586621679152048"><span class="hs-identifier hs-var">zs</span></a><span class="hs-special">)</span><span>
</span><a name="line-903"></a><span>
</span><a name="line-904"></a><span>
</span><a name="line-905"></a><span class="hs-comment">------------------------------------------------------------------------------</span><span>
</span><a name="line-906"></a><span class="hs-comment">-- Quick Sort algorithm taken from HBC's QSort library.</span><span>
</span><a name="line-907"></a><span>
</span><a name="line-908"></a><span class="hs-comment">-- | The 'sort' function implements a stable sorting algorithm.</span><span>
</span><a name="line-909"></a><span class="hs-comment">-- It is a special case of 'sortBy', which allows the programmer to supply</span><span>
</span><a name="line-910"></a><span class="hs-comment">-- their own comparison function.</span><span>
</span><a name="line-911"></a><span class="hs-comment">--</span><span>
</span><a name="line-912"></a><span class="hs-comment">-- Elements are arranged from from lowest to highest, keeping duplicates in</span><span>
</span><a name="line-913"></a><span class="hs-comment">-- the order they appeared in the input.</span><span>
</span><a name="line-914"></a><span class="hs-comment">--</span><span>
</span><a name="line-915"></a><span class="hs-comment">-- &gt;&gt;&gt; sort [1,6,4,3,2,5]</span><span>
</span><a name="line-916"></a><span class="hs-comment">-- [1,2,3,4,5,6]</span><span>
</span><a name="line-917"></a><span class="hs-identifier">sort</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><a href="../ghc-prim-0.5.2.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Classes.html#Ord"><span class="hs-identifier hs-type">Ord</span></a><span> </span><a href="#local-6989586621679151636"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679151636"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679151636"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">]</span><span>
</span><a name="line-918"></a><span>
</span><a name="line-919"></a><span class="hs-comment">-- | The 'sortBy' function is the non-overloaded version of 'sort'.</span><span>
</span><a name="line-920"></a><span class="hs-comment">--</span><span>
</span><a name="line-921"></a><span class="hs-comment">-- &gt;&gt;&gt; sortBy (\(a,_) (b,_) -&gt; compare a b) [(2, &quot;world&quot;), (4, &quot;!&quot;), (1, &quot;Hello&quot;)]</span><span>
</span><a name="line-922"></a><span class="hs-comment">-- [(1,&quot;Hello&quot;),(2,&quot;world&quot;),(4,&quot;!&quot;)]</span><span>
</span><a name="line-923"></a><span class="hs-identifier">sortBy</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679151635"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679151635"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../ghc-prim-0.5.2.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Types.html#Ordering"><span class="hs-identifier hs-type">Ordering</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679151635"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679151635"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">]</span><span>
</span><a name="line-924"></a><span>
</span><a name="line-925"></a><span class="hs-cpp">#if defined(USE_REPORT_PRELUDE)
</span><span class="hs-identifier">sort</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">sortBy</span><span> </span><span class="hs-identifier">compare</span><span>
</span><a name="line-927"></a><span class="hs-identifier">sortBy</span><span> </span><span class="hs-identifier">cmp</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">foldr</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">insertBy</span><span> </span><span class="hs-identifier">cmp</span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-928"></a><span class="hs-cpp">#else
</span><span>
</span><a name="line-930"></a><span class="hs-comment">{-
GHC's mergesort replaced by a better implementation, 24/12/2009.
This code originally contributed to the nhc12 compiler by Thomas Nordin
in 2002.  Rumoured to have been based on code by Lennart Augustsson, e.g.
    http://www.mail-archive.com/haskell@haskell.org/msg01822.html
and possibly to bear similarities to a 1982 paper by Richard O'Keefe:
&quot;A smooth applicative merge sort&quot;.

Benchmarks show it to be often 2x the speed of the previous implementation.
Fixes ticket http://ghc.haskell.org/trac/ghc/ticket/2143
-}</span><span>
</span><a name="line-941"></a><span>
</span><a name="line-942"></a><a name="sort"><a href="Data.OldList.html#sort"><span class="hs-identifier">sort</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.OldList.html#sortBy"><span class="hs-identifier hs-var">sortBy</span></a><span> </span><a href="../ghc-prim-0.5.2.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Classes.html#compare"><span class="hs-identifier hs-var">compare</span></a><span>
</span><a name="line-943"></a><a name="sortBy"><a href="Data.OldList.html#sortBy"><span class="hs-identifier">sortBy</span></a></a><span> </span><a name="local-6989586621679152049"><a href="#local-6989586621679152049"><span class="hs-identifier">cmp</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679152053"><span class="hs-identifier hs-var">mergeAll</span></a><span> </span><a href="GHC.Base.html#."><span class="hs-operator hs-var">.</span></a><span> </span><a href="#local-6989586621679152050"><span class="hs-identifier hs-var">sequences</span></a><span>
</span><a name="line-944"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-945"></a><span>    </span><a name="local-6989586621679152050"><a href="#local-6989586621679152050"><span class="hs-identifier">sequences</span></a></a><span> </span><span class="hs-special">(</span><a name="local-6989586621679152056"><a href="#local-6989586621679152056"><span class="hs-identifier">a</span></a></a><span class="hs-glyph">:</span><a name="local-6989586621679152057"><a href="#local-6989586621679152057"><span class="hs-identifier">b</span></a></a><span class="hs-glyph">:</span><a name="local-6989586621679152058"><a href="#local-6989586621679152058"><span class="hs-identifier">xs</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-946"></a><span>      </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621679152056"><span class="hs-identifier hs-var">a</span></a><span> </span><span class="hs-special">`</span><a href="#local-6989586621679152049"><span class="hs-identifier hs-var">cmp</span></a><span class="hs-special">`</span><span> </span><a href="#local-6989586621679152057"><span class="hs-identifier hs-var">b</span></a><span> </span><a href="../ghc-prim-0.5.2.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Classes.html#%3D%3D"><span class="hs-operator hs-var">==</span></a><span> </span><a href="../ghc-prim-0.5.2.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Types.html#GT"><span class="hs-identifier hs-var">GT</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679152051"><span class="hs-identifier hs-var">descending</span></a><span> </span><a href="#local-6989586621679152057"><span class="hs-identifier hs-var">b</span></a><span> </span><span class="hs-special">[</span><a href="#local-6989586621679152056"><span class="hs-identifier hs-var">a</span></a><span class="hs-special">]</span><span>  </span><a href="#local-6989586621679152058"><span class="hs-identifier hs-var">xs</span></a><span>
</span><a name="line-947"></a><span>      </span><span class="hs-glyph">|</span><span> </span><a href="GHC.Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a><span>       </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679152052"><span class="hs-identifier hs-var">ascending</span></a><span>  </span><a href="#local-6989586621679152057"><span class="hs-identifier hs-var">b</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679152056"><span class="hs-identifier hs-var">a</span></a><span class="hs-glyph">:</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679152058"><span class="hs-identifier hs-var">xs</span></a><span>
</span><a name="line-948"></a><span>    </span><span class="hs-identifier">sequences</span><span> </span><a name="local-6989586621679152059"><a href="#local-6989586621679152059"><span class="hs-identifier">xs</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679152059"><span class="hs-identifier hs-var">xs</span></a><span class="hs-special">]</span><span>
</span><a name="line-949"></a><span>
</span><a name="line-950"></a><span>    </span><a name="local-6989586621679152051"><a href="#local-6989586621679152051"><span class="hs-identifier">descending</span></a></a><span> </span><a name="local-6989586621679152060"><a href="#local-6989586621679152060"><span class="hs-identifier">a</span></a></a><span> </span><span class="hs-keyword">as</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679152062"><a href="#local-6989586621679152062"><span class="hs-identifier">b</span></a></a><span class="hs-glyph">:</span><a name="local-6989586621679152063"><a href="#local-6989586621679152063"><span class="hs-identifier">bs</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-951"></a><span>      </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621679152060"><span class="hs-identifier hs-var">a</span></a><span> </span><span class="hs-special">`</span><a href="#local-6989586621679152049"><span class="hs-identifier hs-var">cmp</span></a><span class="hs-special">`</span><span> </span><a href="#local-6989586621679152062"><span class="hs-identifier hs-var">b</span></a><span> </span><a href="../ghc-prim-0.5.2.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Classes.html#%3D%3D"><span class="hs-operator hs-var">==</span></a><span> </span><a href="../ghc-prim-0.5.2.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Types.html#GT"><span class="hs-identifier hs-var">GT</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679152051"><span class="hs-identifier hs-var">descending</span></a><span> </span><a href="#local-6989586621679152062"><span class="hs-identifier hs-var">b</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679152060"><span class="hs-identifier hs-var">a</span></a><span class="hs-glyph">:</span><span class="hs-keyword">as</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679152063"><span class="hs-identifier hs-var">bs</span></a><span>
</span><a name="line-952"></a><span>    </span><span class="hs-identifier">descending</span><span> </span><a name="local-6989586621679152064"><a href="#local-6989586621679152064"><span class="hs-identifier">a</span></a></a><span> </span><span class="hs-keyword">as</span><span> </span><a name="local-6989586621679152066"><a href="#local-6989586621679152066"><span class="hs-identifier">bs</span></a></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679152064"><span class="hs-identifier hs-var">a</span></a><span class="hs-glyph">:</span><span class="hs-keyword">as</span><span class="hs-special">)</span><span class="hs-glyph">:</span><span> </span><a href="#local-6989586621679152050"><span class="hs-identifier hs-var">sequences</span></a><span> </span><a href="#local-6989586621679152066"><span class="hs-identifier hs-var">bs</span></a><span>
</span><a name="line-953"></a><span>
</span><a name="line-954"></a><span>    </span><a name="local-6989586621679152052"><a href="#local-6989586621679152052"><span class="hs-identifier">ascending</span></a></a><span> </span><a name="local-6989586621679152067"><a href="#local-6989586621679152067"><span class="hs-identifier">a</span></a></a><span> </span><span class="hs-keyword">as</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679152069"><a href="#local-6989586621679152069"><span class="hs-identifier">b</span></a></a><span class="hs-glyph">:</span><a name="local-6989586621679152070"><a href="#local-6989586621679152070"><span class="hs-identifier">bs</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-955"></a><span>      </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621679152067"><span class="hs-identifier hs-var">a</span></a><span> </span><span class="hs-special">`</span><a href="#local-6989586621679152049"><span class="hs-identifier hs-var">cmp</span></a><span class="hs-special">`</span><span> </span><a href="#local-6989586621679152069"><span class="hs-identifier hs-var">b</span></a><span> </span><a href="../ghc-prim-0.5.2.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Classes.html#%2F%3D"><span class="hs-operator hs-var">/=</span></a><span> </span><a href="../ghc-prim-0.5.2.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Types.html#GT"><span class="hs-identifier hs-var">GT</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679152052"><span class="hs-identifier hs-var">ascending</span></a><span> </span><a href="#local-6989586621679152069"><span class="hs-identifier hs-var">b</span></a><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><a name="local-6989586621679152071"><a href="#local-6989586621679152071"><span class="hs-identifier">ys</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679152067"><span class="hs-identifier hs-var">a</span></a><span class="hs-glyph">:</span><a href="#local-6989586621679152071"><span class="hs-identifier hs-var">ys</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679152070"><span class="hs-identifier hs-var">bs</span></a><span>
</span><a name="line-956"></a><span>    </span><span class="hs-identifier">ascending</span><span> </span><a name="local-6989586621679152072"><a href="#local-6989586621679152072"><span class="hs-identifier">a</span></a></a><span> </span><span class="hs-keyword">as</span><span> </span><a name="local-6989586621679152074"><a href="#local-6989586621679152074"><span class="hs-identifier">bs</span></a></a><span>   </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">let</span><span> </span><span class="hs-glyph">!</span><a name="local-6989586621679152075"><a href="#local-6989586621679152075"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679152072"><span class="hs-identifier hs-var">a</span></a><span class="hs-special">]</span><span>
</span><a name="line-957"></a><span>                          </span><span class="hs-keyword">in</span><span> </span><a href="#local-6989586621679152075"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-glyph">:</span><span> </span><a href="#local-6989586621679152050"><span class="hs-identifier hs-var">sequences</span></a><span> </span><a href="#local-6989586621679152074"><span class="hs-identifier hs-var">bs</span></a><span>
</span><a name="line-958"></a><span>
</span><a name="line-959"></a><span>    </span><a name="local-6989586621679152053"><a href="#local-6989586621679152053"><span class="hs-identifier">mergeAll</span></a></a><span> </span><span class="hs-special">[</span><a name="local-6989586621679152076"><a href="#local-6989586621679152076"><span class="hs-identifier">x</span></a></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679152076"><span class="hs-identifier hs-var">x</span></a><span>
</span><a name="line-960"></a><span>    </span><span class="hs-identifier">mergeAll</span><span> </span><a name="local-6989586621679152077"><a href="#local-6989586621679152077"><span class="hs-identifier">xs</span></a></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679152053"><span class="hs-identifier hs-var">mergeAll</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679152054"><span class="hs-identifier hs-var">mergePairs</span></a><span> </span><a href="#local-6989586621679152077"><span class="hs-identifier hs-var">xs</span></a><span class="hs-special">)</span><span>
</span><a name="line-961"></a><span>
</span><a name="line-962"></a><span>    </span><a name="local-6989586621679152054"><a href="#local-6989586621679152054"><span class="hs-identifier">mergePairs</span></a></a><span> </span><span class="hs-special">(</span><a name="local-6989586621679152078"><a href="#local-6989586621679152078"><span class="hs-identifier">a</span></a></a><span class="hs-glyph">:</span><a name="local-6989586621679152079"><a href="#local-6989586621679152079"><span class="hs-identifier">b</span></a></a><span class="hs-glyph">:</span><a name="local-6989586621679152080"><a href="#local-6989586621679152080"><span class="hs-identifier">xs</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">let</span><span> </span><span class="hs-glyph">!</span><a name="local-6989586621679152081"><a href="#local-6989586621679152081"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679152055"><span class="hs-identifier hs-var">merge</span></a><span> </span><a href="#local-6989586621679152078"><span class="hs-identifier hs-var">a</span></a><span> </span><a href="#local-6989586621679152079"><span class="hs-identifier hs-var">b</span></a><span>
</span><a name="line-963"></a><span>                          </span><span class="hs-keyword">in</span><span> </span><a href="#local-6989586621679152081"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-glyph">:</span><span> </span><a href="#local-6989586621679152054"><span class="hs-identifier hs-var">mergePairs</span></a><span> </span><a href="#local-6989586621679152080"><span class="hs-identifier hs-var">xs</span></a><span>
</span><a name="line-964"></a><span>    </span><span class="hs-identifier">mergePairs</span><span> </span><a name="local-6989586621679152082"><a href="#local-6989586621679152082"><span class="hs-identifier">xs</span></a></a><span>       </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679152082"><span class="hs-identifier hs-var">xs</span></a><span>
</span><a name="line-965"></a><span>
</span><a name="line-966"></a><span>    </span><a name="local-6989586621679152055"><a href="#local-6989586621679152055"><span class="hs-identifier">merge</span></a></a><span> </span><span class="hs-keyword">as</span><span class="hs-glyph">@</span><span class="hs-special">(</span><a name="local-6989586621679152084"><a href="#local-6989586621679152084"><span class="hs-identifier">a</span></a></a><span class="hs-glyph">:</span><a name="local-6989586621679152085"><a href="#local-6989586621679152085"><span class="hs-identifier">as'</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621679152086"><a href="#local-6989586621679152086"><span class="hs-identifier">bs</span></a></a><span class="hs-glyph">@</span><span class="hs-special">(</span><a name="local-6989586621679152087"><a href="#local-6989586621679152087"><span class="hs-identifier">b</span></a></a><span class="hs-glyph">:</span><a name="local-6989586621679152088"><a href="#local-6989586621679152088"><span class="hs-identifier">bs'</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-967"></a><span>      </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621679152084"><span class="hs-identifier hs-var">a</span></a><span> </span><span class="hs-special">`</span><a href="#local-6989586621679152049"><span class="hs-identifier hs-var">cmp</span></a><span class="hs-special">`</span><span> </span><a href="#local-6989586621679152087"><span class="hs-identifier hs-var">b</span></a><span> </span><a href="../ghc-prim-0.5.2.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Classes.html#%3D%3D"><span class="hs-operator hs-var">==</span></a><span> </span><a href="../ghc-prim-0.5.2.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Types.html#GT"><span class="hs-identifier hs-var">GT</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679152087"><span class="hs-identifier hs-var">b</span></a><span class="hs-glyph">:</span><a href="#local-6989586621679152055"><span class="hs-identifier hs-var">merge</span></a><span> </span><span class="hs-keyword">as</span><span>  </span><a href="#local-6989586621679152088"><span class="hs-identifier hs-var">bs'</span></a><span>
</span><a name="line-968"></a><span>      </span><span class="hs-glyph">|</span><span> </span><a href="GHC.Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a><span>       </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679152084"><span class="hs-identifier hs-var">a</span></a><span class="hs-glyph">:</span><a href="#local-6989586621679152055"><span class="hs-identifier hs-var">merge</span></a><span> </span><a href="#local-6989586621679152085"><span class="hs-identifier hs-var">as'</span></a><span> </span><a href="#local-6989586621679152086"><span class="hs-identifier hs-var">bs</span></a><span>
</span><a name="line-969"></a><span>    </span><span class="hs-identifier">merge</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><a name="local-6989586621679152089"><a href="#local-6989586621679152089"><span class="hs-identifier">bs</span></a></a><span>         </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679152089"><span class="hs-identifier hs-var">bs</span></a><span>
</span><a name="line-970"></a><span>    </span><span class="hs-identifier">merge</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>         </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">as</span><span>
</span><a name="line-971"></a><span>
</span><a name="line-972"></a><span class="hs-comment">{-
sortBy cmp l = mergesort cmp l
sort l = mergesort compare l

Quicksort replaced by mergesort, 14/5/2002.

From: Ian Lynagh &lt;igloo@earth.li&gt;

I am curious as to why the List.sort implementation in GHC is a
quicksort algorithm rather than an algorithm that guarantees n log n
time in the worst case? I have attached a mergesort implementation along
with a few scripts to time it's performance, the results of which are
shown below (* means it didn't finish successfully - in all cases this
was due to a stack overflow).

If I heap profile the random_list case with only 10000 then I see
random_list peaks at using about 2.5M of memory, whereas in the same
program using List.sort it uses only 100k.

Input style     Input length     Sort data     Sort alg    User time
stdin           10000            random_list   sort        2.82
stdin           10000            random_list   mergesort   2.96
stdin           10000            sorted        sort        31.37
stdin           10000            sorted        mergesort   1.90
stdin           10000            revsorted     sort        31.21
stdin           10000            revsorted     mergesort   1.88
stdin           100000           random_list   sort        *
stdin           100000           random_list   mergesort   *
stdin           100000           sorted        sort        *
stdin           100000           sorted        mergesort   *
stdin           100000           revsorted     sort        *
stdin           100000           revsorted     mergesort   *
func            10000            random_list   sort        0.31
func            10000            random_list   mergesort   0.91
func            10000            sorted        sort        19.09
func            10000            sorted        mergesort   0.15
func            10000            revsorted     sort        19.17
func            10000            revsorted     mergesort   0.16
func            100000           random_list   sort        3.85
func            100000           random_list   mergesort   *
func            100000           sorted        sort        5831.47
func            100000           sorted        mergesort   2.23
func            100000           revsorted     sort        5872.34
func            100000           revsorted     mergesort   2.24

mergesort :: (a -&gt; a -&gt; Ordering) -&gt; [a] -&gt; [a]
mergesort cmp = mergesort' cmp . map wrap

mergesort' :: (a -&gt; a -&gt; Ordering) -&gt; [[a]] -&gt; [a]
mergesort' _   [] = []
mergesort' _   [xs] = xs
mergesort' cmp xss = mergesort' cmp (merge_pairs cmp xss)

merge_pairs :: (a -&gt; a -&gt; Ordering) -&gt; [[a]] -&gt; [[a]]
merge_pairs _   [] = []
merge_pairs _   [xs] = [xs]
merge_pairs cmp (xs:ys:xss) = merge cmp xs ys : merge_pairs cmp xss

merge :: (a -&gt; a -&gt; Ordering) -&gt; [a] -&gt; [a] -&gt; [a]
merge _   [] ys = ys
merge _   xs [] = xs
merge cmp (x:xs) (y:ys)
 = case x `cmp` y of
        GT -&gt; y : merge cmp (x:xs)   ys
        _  -&gt; x : merge cmp    xs (y:ys)

wrap :: a -&gt; [a]
wrap x = [x]



OLDER: qsort version

-- qsort is stable and does not concatenate.
qsort :: (a -&gt; a -&gt; Ordering) -&gt; [a] -&gt; [a] -&gt; [a]
qsort _   []     r = r
qsort _   [x]    r = x:r
qsort cmp (x:xs) r = qpart cmp x xs [] [] r

-- qpart partitions and sorts the sublists
qpart :: (a -&gt; a -&gt; Ordering) -&gt; a -&gt; [a] -&gt; [a] -&gt; [a] -&gt; [a] -&gt; [a]
qpart cmp x [] rlt rge r =
    -- rlt and rge are in reverse order and must be sorted with an
    -- anti-stable sorting
    rqsort cmp rlt (x:rqsort cmp rge r)
qpart cmp x (y:ys) rlt rge r =
    case cmp x y of
        GT -&gt; qpart cmp x ys (y:rlt) rge r
        _  -&gt; qpart cmp x ys rlt (y:rge) r

-- rqsort is as qsort but anti-stable, i.e. reverses equal elements
rqsort :: (a -&gt; a -&gt; Ordering) -&gt; [a] -&gt; [a] -&gt; [a]
rqsort _   []     r = r
rqsort _   [x]    r = x:r
rqsort cmp (x:xs) r = rqpart cmp x xs [] [] r

rqpart :: (a -&gt; a -&gt; Ordering) -&gt; a -&gt; [a] -&gt; [a] -&gt; [a] -&gt; [a] -&gt; [a]
rqpart cmp x [] rle rgt r =
    qsort cmp rle (x:qsort cmp rgt r)
rqpart cmp x (y:ys) rle rgt r =
    case cmp y x of
        GT -&gt; rqpart cmp x ys rle (y:rgt) r
        _  -&gt; rqpart cmp x ys (y:rle) rgt r
-}</span><span>
</span><a name="line-1076"></a><span>
</span><a name="line-1077"></a><span class="hs-cpp">#endif /* USE_REPORT_PRELUDE */
</span><span>
</span><a name="line-1079"></a><span class="hs-comment">-- | Sort a list by comparing the results of a key function applied to each</span><span>
</span><a name="line-1080"></a><span class="hs-comment">-- element.  @sortOn f@ is equivalent to @sortBy (comparing f)@, but has the</span><span>
</span><a name="line-1081"></a><span class="hs-comment">-- performance advantage of only evaluating @f@ once for each element in the</span><span>
</span><a name="line-1082"></a><span class="hs-comment">-- input list.  This is called the decorate-sort-undecorate paradigm, or</span><span>
</span><a name="line-1083"></a><span class="hs-comment">-- Schwartzian transform.</span><span>
</span><a name="line-1084"></a><span class="hs-comment">--</span><span>
</span><a name="line-1085"></a><span class="hs-comment">-- Elements are arranged from from lowest to highest, keeping duplicates in</span><span>
</span><a name="line-1086"></a><span class="hs-comment">-- the order they appeared in the input.</span><span>
</span><a name="line-1087"></a><span class="hs-comment">--</span><span>
</span><a name="line-1088"></a><span class="hs-comment">-- &gt;&gt;&gt; sortOn fst [(2, &quot;world&quot;), (4, &quot;!&quot;), (1, &quot;Hello&quot;)]</span><span>
</span><a name="line-1089"></a><span class="hs-comment">-- [(1,&quot;Hello&quot;),(2,&quot;world&quot;),(4,&quot;!&quot;)]</span><span>
</span><a name="line-1090"></a><span class="hs-comment">--</span><span>
</span><a name="line-1091"></a><span class="hs-comment">-- @since 4.8.0.0</span><span>
</span><a name="line-1092"></a><span class="hs-identifier">sortOn</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="../ghc-prim-0.5.2.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Classes.html#Ord"><span class="hs-identifier hs-type">Ord</span></a><span> </span><a href="#local-6989586621679151633"><span class="hs-identifier hs-type">b</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679151634"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679151633"><span class="hs-identifier hs-type">b</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679151634"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679151634"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">]</span><span>
</span><a name="line-1093"></a><a name="sortOn"><a href="Data.OldList.html#sortOn"><span class="hs-identifier">sortOn</span></a></a><span> </span><a name="local-6989586621679152091"><a href="#local-6989586621679152091"><span class="hs-identifier">f</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-1094"></a><span>  </span><a href="GHC.Base.html#map"><span class="hs-identifier hs-var">map</span></a><span> </span><a href="Data.Tuple.html#snd"><span class="hs-identifier hs-var">snd</span></a><span> </span><a href="GHC.Base.html#."><span class="hs-operator hs-var">.</span></a><span> </span><a href="Data.OldList.html#sortBy"><span class="hs-identifier hs-var">sortBy</span></a><span> </span><span class="hs-special">(</span><a href="Data.Ord.html#comparing"><span class="hs-identifier hs-var">comparing</span></a><span> </span><a href="Data.Tuple.html#fst"><span class="hs-identifier hs-var">fst</span></a><span class="hs-special">)</span><span> </span><a href="GHC.Base.html#."><span class="hs-operator hs-var">.</span></a><span> </span><a href="GHC.Base.html#map"><span class="hs-identifier hs-var">map</span></a><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><a name="local-6989586621679152092"><a href="#local-6989586621679152092"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679152093"><a href="#local-6989586621679152093"><span class="hs-identifier">y</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679152091"><span class="hs-identifier hs-var">f</span></a><span> </span><a href="#local-6989586621679152092"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-keyword">in</span><span> </span><a href="#local-6989586621679152093"><span class="hs-identifier hs-var">y</span></a><span> </span><span class="hs-special">`</span><a href="../ghc-prim-0.5.2.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Prim.html#seq"><span class="hs-identifier hs-var">seq</span></a><span class="hs-special">`</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679152093"><span class="hs-identifier hs-var">y</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679152092"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-1095"></a><span>
</span><a name="line-1096"></a><span class="hs-comment">-- | The 'unfoldr' function is a \`dual\' to 'foldr': while 'foldr'</span><span>
</span><a name="line-1097"></a><span class="hs-comment">-- reduces a list to a summary value, 'unfoldr' builds a list from</span><span>
</span><a name="line-1098"></a><span class="hs-comment">-- a seed value.  The function takes the element and returns 'Nothing'</span><span>
</span><a name="line-1099"></a><span class="hs-comment">-- if it is done producing the list or returns 'Just' @(a,b)@, in which</span><span>
</span><a name="line-1100"></a><span class="hs-comment">-- case, @a@ is a prepended to the list and @b@ is used as the next</span><span>
</span><a name="line-1101"></a><span class="hs-comment">-- element in a recursive call.  For example,</span><span>
</span><a name="line-1102"></a><span class="hs-comment">--</span><span>
</span><a name="line-1103"></a><span class="hs-comment">-- &gt; iterate f == unfoldr (\x -&gt; Just (x, f x))</span><span>
</span><a name="line-1104"></a><span class="hs-comment">--</span><span>
</span><a name="line-1105"></a><span class="hs-comment">-- In some cases, 'unfoldr' can undo a 'foldr' operation:</span><span>
</span><a name="line-1106"></a><span class="hs-comment">--</span><span>
</span><a name="line-1107"></a><span class="hs-comment">-- &gt; unfoldr f' (foldr f z xs) == xs</span><span>
</span><a name="line-1108"></a><span class="hs-comment">--</span><span>
</span><a name="line-1109"></a><span class="hs-comment">-- if the following holds:</span><span>
</span><a name="line-1110"></a><span class="hs-comment">--</span><span>
</span><a name="line-1111"></a><span class="hs-comment">-- &gt; f' (f x y) = Just (x,y)</span><span>
</span><a name="line-1112"></a><span class="hs-comment">-- &gt; f' z       = Nothing</span><span>
</span><a name="line-1113"></a><span class="hs-comment">--</span><span>
</span><a name="line-1114"></a><span class="hs-comment">-- A simple use of unfoldr:</span><span>
</span><a name="line-1115"></a><span class="hs-comment">--</span><span>
</span><a name="line-1116"></a><span class="hs-comment">-- &gt;&gt;&gt; unfoldr (\b -&gt; if b == 0 then Nothing else Just (b, b-1)) 10</span><span>
</span><a name="line-1117"></a><span class="hs-comment">-- [10,9,8,7,6,5,4,3,2,1]</span><span>
</span><a name="line-1118"></a><span class="hs-comment">--</span><span>
</span><a name="line-1119"></a><span>
</span><a name="line-1120"></a><span class="hs-comment">-- Note [INLINE unfoldr]</span><span>
</span><a name="line-1121"></a><span class="hs-comment">-- We treat unfoldr a little differently from some other forms for list fusion</span><span>
</span><a name="line-1122"></a><span class="hs-comment">-- for two reasons:</span><span>
</span><a name="line-1123"></a><span class="hs-comment">--</span><span>
</span><a name="line-1124"></a><span class="hs-comment">-- 1. We don't want to use a rule to rewrite a basic form to a fusible</span><span>
</span><a name="line-1125"></a><span class="hs-comment">-- form because this would inline before constant floating. As Simon Peyton-</span><span>
</span><a name="line-1126"></a><span class="hs-comment">-- Jones and others have pointed out, this could reduce sharing in some cases</span><span>
</span><a name="line-1127"></a><span class="hs-comment">-- where sharing is beneficial. Thus we simply INLINE it, which is, for</span><span>
</span><a name="line-1128"></a><span class="hs-comment">-- example, how enumFromTo::Int becomes eftInt. Unfortunately, we don't seem</span><span>
</span><a name="line-1129"></a><span class="hs-comment">-- to get enough of an inlining discount to get a version of eftInt based on</span><span>
</span><a name="line-1130"></a><span class="hs-comment">-- unfoldr to inline as readily as the usual one. We know that all the Maybe</span><span>
</span><a name="line-1131"></a><span class="hs-comment">-- nonsense will go away, but the compiler does not.</span><span>
</span><a name="line-1132"></a><span class="hs-comment">--</span><span>
</span><a name="line-1133"></a><span class="hs-comment">-- 2. The benefit of inlining unfoldr is likely to be huge in many common cases,</span><span>
</span><a name="line-1134"></a><span class="hs-comment">-- even apart from list fusion. In particular, inlining unfoldr often</span><span>
</span><a name="line-1135"></a><span class="hs-comment">-- allows GHC to erase all the Maybes. This appears to be critical if unfoldr</span><span>
</span><a name="line-1136"></a><span class="hs-comment">-- is to be used in high-performance code. A small increase in code size</span><span>
</span><a name="line-1137"></a><span class="hs-comment">-- in the relatively rare cases when this does not happen looks like a very</span><span>
</span><a name="line-1138"></a><span class="hs-comment">-- small price to pay.</span><span>
</span><a name="line-1139"></a><span class="hs-comment">--</span><span>
</span><a name="line-1140"></a><span class="hs-comment">-- Doing a back-and-forth dance doesn't seem to accomplish anything if the</span><span>
</span><a name="line-1141"></a><span class="hs-comment">-- final form has to be inlined in any case.</span><span>
</span><a name="line-1142"></a><span>
</span><a name="line-1143"></a><span class="hs-identifier">unfoldr</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679151631"><span class="hs-identifier hs-type">b</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="GHC.Base.html#Maybe"><span class="hs-identifier hs-type">Maybe</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679151632"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679151631"><span class="hs-identifier hs-type">b</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679151631"><span class="hs-identifier hs-type">b</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679151632"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">]</span><span>
</span><a name="line-1144"></a><span>
</span><a name="line-1145"></a><span class="hs-pragma">{-# INLINE</span><span> </span><span class="hs-pragma">unfoldr</span><span> </span><span class="hs-pragma">#-}</span><span> </span><span class="hs-comment">-- See Note [INLINE unfoldr]</span><span>
</span><a name="line-1146"></a><a name="unfoldr"><a href="Data.OldList.html#unfoldr"><span class="hs-identifier">unfoldr</span></a></a><span> </span><a name="local-6989586621679152094"><a href="#local-6989586621679152094"><span class="hs-identifier">f</span></a></a><span> </span><a name="local-6989586621679152095"><a href="#local-6989586621679152095"><span class="hs-identifier">b0</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="GHC.Base.html#build"><span class="hs-identifier hs-var">build</span></a><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><a name="local-6989586621679152096"><a href="#local-6989586621679152096"><span class="hs-identifier">c</span></a></a><span> </span><a name="local-6989586621679152097"><a href="#local-6989586621679152097"><span class="hs-identifier">n</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-1147"></a><span>  </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679152098"><a href="#local-6989586621679152098"><span class="hs-identifier">go</span></a></a><span> </span><a name="local-6989586621679152099"><a href="#local-6989586621679152099"><span class="hs-identifier">b</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621679152094"><span class="hs-identifier hs-var">f</span></a><span> </span><a href="#local-6989586621679152099"><span class="hs-identifier hs-var">b</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-1148"></a><span>               </span><a href="GHC.Base.html#Just"><span class="hs-identifier hs-var">Just</span></a><span> </span><span class="hs-special">(</span><a name="local-6989586621679152100"><a href="#local-6989586621679152100"><span class="hs-identifier">a</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679152101"><a href="#local-6989586621679152101"><span class="hs-identifier">new_b</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679152100"><span class="hs-identifier hs-var">a</span></a><span> </span><span class="hs-special">`</span><a href="#local-6989586621679152096"><span class="hs-identifier hs-var">c</span></a><span class="hs-special">`</span><span> </span><a href="#local-6989586621679152098"><span class="hs-identifier hs-var">go</span></a><span> </span><a href="#local-6989586621679152101"><span class="hs-identifier hs-var">new_b</span></a><span>
</span><a name="line-1149"></a><span>               </span><a href="GHC.Base.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a><span>         </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679152097"><span class="hs-identifier hs-var">n</span></a><span>
</span><a name="line-1150"></a><span>  </span><span class="hs-keyword">in</span><span> </span><a href="#local-6989586621679152098"><span class="hs-identifier hs-var">go</span></a><span> </span><a href="#local-6989586621679152095"><span class="hs-identifier hs-var">b0</span></a><span class="hs-special">)</span><span>
</span><a name="line-1151"></a><span>
</span><a name="line-1152"></a><span class="hs-comment">-- -----------------------------------------------------------------------------</span><span>
</span><a name="line-1153"></a><span class="hs-comment">-- Functions on strings</span><span>
</span><a name="line-1154"></a><span>
</span><a name="line-1155"></a><span class="hs-comment">-- | 'lines' breaks a string up into a list of strings at newline</span><span>
</span><a name="line-1156"></a><span class="hs-comment">-- characters.  The resulting strings do not contain newlines.</span><span>
</span><a name="line-1157"></a><span class="hs-comment">--</span><span>
</span><a name="line-1158"></a><span class="hs-comment">-- Note that after splitting the string at newline characters, the</span><span>
</span><a name="line-1159"></a><span class="hs-comment">-- last part of the string is considered a line even if it doesn't end</span><span>
</span><a name="line-1160"></a><span class="hs-comment">-- with a newline. For example,</span><span>
</span><a name="line-1161"></a><span class="hs-comment">--</span><span>
</span><a name="line-1162"></a><span class="hs-comment">-- &gt;&gt;&gt; lines &quot;&quot;</span><span>
</span><a name="line-1163"></a><span class="hs-comment">-- []</span><span>
</span><a name="line-1164"></a><span class="hs-comment">--</span><span>
</span><a name="line-1165"></a><span class="hs-comment">-- &gt;&gt;&gt; lines &quot;\n&quot;</span><span>
</span><a name="line-1166"></a><span class="hs-comment">-- [&quot;&quot;]</span><span>
</span><a name="line-1167"></a><span class="hs-comment">--</span><span>
</span><a name="line-1168"></a><span class="hs-comment">-- &gt;&gt;&gt; lines &quot;one&quot;</span><span>
</span><a name="line-1169"></a><span class="hs-comment">-- [&quot;one&quot;]</span><span>
</span><a name="line-1170"></a><span class="hs-comment">--</span><span>
</span><a name="line-1171"></a><span class="hs-comment">-- &gt;&gt;&gt; lines &quot;one\n&quot;</span><span>
</span><a name="line-1172"></a><span class="hs-comment">-- [&quot;one&quot;]</span><span>
</span><a name="line-1173"></a><span class="hs-comment">--</span><span>
</span><a name="line-1174"></a><span class="hs-comment">-- &gt;&gt;&gt; lines &quot;one\n\n&quot;</span><span>
</span><a name="line-1175"></a><span class="hs-comment">-- [&quot;one&quot;,&quot;&quot;]</span><span>
</span><a name="line-1176"></a><span class="hs-comment">--</span><span>
</span><a name="line-1177"></a><span class="hs-comment">-- &gt;&gt;&gt; lines &quot;one\ntwo&quot;</span><span>
</span><a name="line-1178"></a><span class="hs-comment">-- [&quot;one&quot;,&quot;two&quot;]</span><span>
</span><a name="line-1179"></a><span class="hs-comment">--</span><span>
</span><a name="line-1180"></a><span class="hs-comment">-- &gt;&gt;&gt; lines &quot;one\ntwo\n&quot;</span><span>
</span><a name="line-1181"></a><span class="hs-comment">-- [&quot;one&quot;,&quot;two&quot;]</span><span>
</span><a name="line-1182"></a><span class="hs-comment">--</span><span>
</span><a name="line-1183"></a><span class="hs-comment">-- Thus @'lines' s@ contains at least as many elements as newlines in @s@.</span><span>
</span><a name="line-1184"></a><span class="hs-identifier">lines</span><span>                   </span><span class="hs-glyph">::</span><span> </span><a href="GHC.Base.html#String"><span class="hs-identifier hs-type">String</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="GHC.Base.html#String"><span class="hs-identifier hs-type">String</span></a><span class="hs-special">]</span><span>
</span><a name="line-1185"></a><a name="lines"><a href="Data.OldList.html#lines"><span class="hs-identifier">lines</span></a></a><span> </span><span class="hs-string">&quot;&quot;</span><span>                </span><span class="hs-glyph">=</span><span>  </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-1186"></a><span class="hs-comment">-- Somehow GHC doesn't detect the selector thunks in the below code,</span><span>
</span><a name="line-1187"></a><span class="hs-comment">-- so s' keeps a reference to the first line via the pair and we have</span><span>
</span><a name="line-1188"></a><span class="hs-comment">-- a space leak (cf. #4334).</span><span>
</span><a name="line-1189"></a><span class="hs-comment">-- So we need to make GHC see the selector thunks with a trick.</span><span>
</span><a name="line-1190"></a><span class="hs-identifier">lines</span><span> </span><a name="local-6989586621679152102"><a href="#local-6989586621679152102"><span class="hs-identifier">s</span></a></a><span>                 </span><span class="hs-glyph">=</span><span>  </span><a href="#local-6989586621679152103"><span class="hs-identifier hs-var">cons</span></a><span> </span><span class="hs-special">(</span><span class="hs-keyword">case</span><span> </span><a href="GHC.List.html#break"><span class="hs-identifier hs-var">break</span></a><span> </span><span class="hs-special">(</span><a href="../ghc-prim-0.5.2.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Classes.html#%3D%3D"><span class="hs-operator hs-var">==</span></a><span> </span><span class="hs-char">'\n'</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679152102"><span class="hs-identifier hs-var">s</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-1191"></a><span>                                    </span><span class="hs-special">(</span><a name="local-6989586621679152106"><a href="#local-6989586621679152106"><span class="hs-identifier">l</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679152107"><a href="#local-6989586621679152107"><span class="hs-identifier">s'</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679152106"><span class="hs-identifier hs-var">l</span></a><span class="hs-special">,</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621679152107"><span class="hs-identifier hs-var">s'</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-1192"></a><span>                                                    </span><span class="hs-special">[</span><span class="hs-special">]</span><span>      </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-1193"></a><span>                                                    </span><span class="hs-identifier">_</span><span class="hs-glyph">:</span><a name="local-6989586621679152108"><a href="#local-6989586621679152108"><span class="hs-identifier">s''</span></a></a><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.OldList.html#lines"><span class="hs-identifier hs-var">lines</span></a><span> </span><a href="#local-6989586621679152108"><span class="hs-identifier hs-var">s''</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-1194"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-1195"></a><span>    </span><a name="local-6989586621679152103"><a href="#local-6989586621679152103"><span class="hs-identifier">cons</span></a></a><span> </span><span class="hs-glyph">~</span><span class="hs-special">(</span><a name="local-6989586621679152104"><a href="#local-6989586621679152104"><span class="hs-identifier">h</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679152105"><a href="#local-6989586621679152105"><span class="hs-identifier">t</span></a></a><span class="hs-special">)</span><span>        </span><span class="hs-glyph">=</span><span>  </span><a href="#local-6989586621679152104"><span class="hs-identifier hs-var">h</span></a><span> </span><span class="hs-glyph">:</span><span> </span><a href="#local-6989586621679152105"><span class="hs-identifier hs-var">t</span></a><span>
</span><a name="line-1196"></a><span>
</span><a name="line-1197"></a><span class="hs-comment">-- | 'unlines' is an inverse operation to 'lines'.</span><span>
</span><a name="line-1198"></a><span class="hs-comment">-- It joins lines, after appending a terminating newline to each.</span><span>
</span><a name="line-1199"></a><span class="hs-comment">--</span><span>
</span><a name="line-1200"></a><span class="hs-comment">-- &gt;&gt;&gt; unlines [&quot;Hello&quot;, &quot;World&quot;, &quot;!&quot;]</span><span>
</span><a name="line-1201"></a><span class="hs-comment">-- &quot;Hello\nWorld\n!\n&quot;</span><span>
</span><a name="line-1202"></a><span class="hs-identifier">unlines</span><span>                 </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><a href="GHC.Base.html#String"><span class="hs-identifier hs-type">String</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="GHC.Base.html#String"><span class="hs-identifier hs-type">String</span></a><span>
</span><a name="line-1203"></a><span class="hs-cpp">#if defined(USE_REPORT_PRELUDE)
</span><span class="hs-identifier">unlines</span><span>                 </span><span class="hs-glyph">=</span><span>  </span><span class="hs-identifier">concatMap</span><span> </span><span class="hs-special">(</span><span class="hs-operator">++</span><span> </span><span class="hs-string">&quot;\n&quot;</span><span class="hs-special">)</span><span>
</span><a name="line-1205"></a><span class="hs-cpp">#else
</span><span class="hs-comment">-- HBC version (stolen)</span><span>
</span><a name="line-1207"></a><span class="hs-comment">-- here's a more efficient version</span><span>
</span><a name="line-1208"></a><a name="unlines"><a href="Data.OldList.html#unlines"><span class="hs-identifier">unlines</span></a></a><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-1209"></a><span class="hs-identifier">unlines</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679152109"><a href="#local-6989586621679152109"><span class="hs-identifier">l</span></a></a><span class="hs-glyph">:</span><a name="local-6989586621679152110"><a href="#local-6989586621679152110"><span class="hs-identifier">ls</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679152109"><span class="hs-identifier hs-var">l</span></a><span> </span><a href="GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a><span> </span><span class="hs-char">'\n'</span><span> </span><span class="hs-glyph">:</span><span> </span><a href="Data.OldList.html#unlines"><span class="hs-identifier hs-var">unlines</span></a><span> </span><a href="#local-6989586621679152110"><span class="hs-identifier hs-var">ls</span></a><span>
</span><a name="line-1210"></a><span class="hs-cpp">#endif
</span><span>
</span><a name="line-1212"></a><span class="hs-comment">-- | 'words' breaks a string up into a list of words, which were delimited</span><span>
</span><a name="line-1213"></a><span class="hs-comment">-- by white space.</span><span>
</span><a name="line-1214"></a><span class="hs-comment">--</span><span>
</span><a name="line-1215"></a><span class="hs-comment">-- &gt;&gt;&gt; words &quot;Lorem ipsum\ndolor&quot;</span><span>
</span><a name="line-1216"></a><span class="hs-comment">-- [&quot;Lorem&quot;,&quot;ipsum&quot;,&quot;dolor&quot;]</span><span>
</span><a name="line-1217"></a><span class="hs-identifier">words</span><span>                   </span><span class="hs-glyph">::</span><span> </span><a href="GHC.Base.html#String"><span class="hs-identifier hs-type">String</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="GHC.Base.html#String"><span class="hs-identifier hs-type">String</span></a><span class="hs-special">]</span><span>
</span><a name="line-1218"></a><span class="hs-pragma">{-# NOINLINE</span><span> </span><span class="hs-pragma">[</span><span class="hs-pragma">1</span><span class="hs-pragma">]</span><span> </span><span class="hs-pragma">words</span><span> </span><span class="hs-pragma">#-}</span><span>
</span><a name="line-1219"></a><a name="words"><a href="Data.OldList.html#words"><span class="hs-identifier">words</span></a></a><span> </span><a name="local-6989586621679152111"><a href="#local-6989586621679152111"><span class="hs-identifier">s</span></a></a><span>                 </span><span class="hs-glyph">=</span><span>  </span><span class="hs-keyword">case</span><span> </span><a href="GHC.List.html#dropWhile"><span class="hs-identifier hs-var">dropWhile</span></a><span> </span><span class="hs-comment">{-partain:Char.-}</span><a href="GHC.Unicode.html#isSpace"><span class="hs-identifier hs-var">isSpace</span></a><span> </span><a href="#local-6989586621679152111"><span class="hs-identifier hs-var">s</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-1220"></a><span>                                </span><span class="hs-string">&quot;&quot;</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-1221"></a><span>                                </span><a name="local-6989586621679152112"><a href="#local-6989586621679152112"><span class="hs-identifier">s'</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679152113"><span class="hs-identifier hs-var">w</span></a><span> </span><span class="hs-glyph">:</span><span> </span><a href="Data.OldList.html#words"><span class="hs-identifier hs-var">words</span></a><span> </span><a href="#local-6989586621679152114"><span class="hs-identifier hs-var">s''</span></a><span>
</span><a name="line-1222"></a><span>                                      </span><span class="hs-keyword">where</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679152113"><a href="#local-6989586621679152113"><span class="hs-identifier">w</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679152114"><a href="#local-6989586621679152114"><span class="hs-identifier">s''</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-1223"></a><span>                                             </span><a href="GHC.List.html#break"><span class="hs-identifier hs-var">break</span></a><span> </span><span class="hs-comment">{-partain:Char.-}</span><a href="GHC.Unicode.html#isSpace"><span class="hs-identifier hs-var">isSpace</span></a><span> </span><a href="#local-6989586621679152112"><span class="hs-identifier hs-var">s'</span></a><span>
</span><a name="line-1224"></a><span>
</span><a name="line-1225"></a><span class="hs-pragma">{-# RULES</span><span>
</span><a name="line-1226"></a><span class="hs-pragma">&quot;words&quot;</span><span> </span><span class="hs-pragma">[</span><span class="hs-pragma">~</span><span class="hs-pragma">1</span><span class="hs-pragma">]</span><span> </span><span class="hs-pragma">forall</span><span> </span><span class="hs-pragma">s</span><span> </span><span class="hs-pragma">.</span><span> </span><span class="hs-pragma">words</span><span> </span><span class="hs-pragma">s</span><span> </span><span class="hs-pragma">=</span><span> </span><span class="hs-pragma">build</span><span> </span><span class="hs-pragma">(</span><span class="hs-pragma">\</span><span class="hs-pragma">c</span><span> </span><span class="hs-pragma">n</span><span> </span><span class="hs-pragma">-&gt;</span><span> </span><span class="hs-pragma">wordsFB</span><span> </span><span class="hs-pragma">c</span><span> </span><span class="hs-pragma">n</span><span> </span><span class="hs-pragma">s</span><span class="hs-pragma">)</span><span>
</span><a name="line-1227"></a><span class="hs-pragma">&quot;wordsList&quot;</span><span> </span><span class="hs-pragma">[</span><span class="hs-pragma">1</span><span class="hs-pragma">]</span><span> </span><span class="hs-pragma">wordsFB</span><span> </span><span class="hs-pragma">(</span><span class="hs-pragma">:</span><span class="hs-pragma">)</span><span> </span><span class="hs-pragma">[</span><span class="hs-pragma">]</span><span> </span><span class="hs-pragma">=</span><span> </span><span class="hs-pragma">words</span><span>
</span><a name="line-1228"></a><span> </span><span class="hs-pragma">#-}</span><span>
</span><a name="line-1229"></a><span class="hs-identifier">wordsFB</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><a href="../ghc-prim-0.5.2.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Types.html#Char"><span class="hs-identifier hs-type">Char</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679151630"><span class="hs-identifier hs-type">b</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679151630"><span class="hs-identifier hs-type">b</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679151630"><span class="hs-identifier hs-type">b</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="GHC.Base.html#String"><span class="hs-identifier hs-type">String</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679151630"><span class="hs-identifier hs-type">b</span></a><span>
</span><a name="line-1230"></a><span class="hs-pragma">{-# INLINE</span><span> </span><span class="hs-pragma">[</span><span class="hs-pragma">0</span><span class="hs-pragma">]</span><span> </span><span class="hs-pragma">wordsFB</span><span> </span><span class="hs-pragma">#-}</span><span> </span><span class="hs-comment">-- See Note [Inline FB functions] in GHC.List</span><span>
</span><a name="line-1231"></a><a name="wordsFB"><a href="Data.OldList.html#wordsFB"><span class="hs-identifier">wordsFB</span></a></a><span> </span><a name="local-6989586621679152115"><a href="#local-6989586621679152115"><span class="hs-identifier">c</span></a></a><span> </span><a name="local-6989586621679152116"><a href="#local-6989586621679152116"><span class="hs-identifier">n</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679152117"><span class="hs-identifier hs-var">go</span></a><span>
</span><a name="line-1232"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-1233"></a><span>    </span><a name="local-6989586621679152117"><a href="#local-6989586621679152117"><span class="hs-identifier">go</span></a></a><span> </span><a name="local-6989586621679152118"><a href="#local-6989586621679152118"><span class="hs-identifier">s</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="GHC.List.html#dropWhile"><span class="hs-identifier hs-var">dropWhile</span></a><span> </span><a href="GHC.Unicode.html#isSpace"><span class="hs-identifier hs-var">isSpace</span></a><span> </span><a href="#local-6989586621679152118"><span class="hs-identifier hs-var">s</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-1234"></a><span>             </span><span class="hs-string">&quot;&quot;</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679152116"><span class="hs-identifier hs-var">n</span></a><span>
</span><a name="line-1235"></a><span>             </span><a name="local-6989586621679152119"><a href="#local-6989586621679152119"><span class="hs-identifier">s'</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679152120"><span class="hs-identifier hs-var">w</span></a><span> </span><span class="hs-special">`</span><a href="#local-6989586621679152115"><span class="hs-identifier hs-var">c</span></a><span class="hs-special">`</span><span> </span><a href="#local-6989586621679152117"><span class="hs-identifier hs-var">go</span></a><span> </span><a href="#local-6989586621679152121"><span class="hs-identifier hs-var">s''</span></a><span>
</span><a name="line-1236"></a><span>                   </span><span class="hs-keyword">where</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679152120"><a href="#local-6989586621679152120"><span class="hs-identifier">w</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679152121"><a href="#local-6989586621679152121"><span class="hs-identifier">s''</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="GHC.List.html#break"><span class="hs-identifier hs-var">break</span></a><span> </span><a href="GHC.Unicode.html#isSpace"><span class="hs-identifier hs-var">isSpace</span></a><span> </span><a href="#local-6989586621679152119"><span class="hs-identifier hs-var">s'</span></a><span>
</span><a name="line-1237"></a><span>
</span><a name="line-1238"></a><span class="hs-comment">-- | 'unwords' is an inverse operation to 'words'.</span><span>
</span><a name="line-1239"></a><span class="hs-comment">-- It joins words with separating spaces.</span><span>
</span><a name="line-1240"></a><span class="hs-comment">--</span><span>
</span><a name="line-1241"></a><span class="hs-comment">-- &gt;&gt;&gt; unwords [&quot;Lorem&quot;, &quot;ipsum&quot;, &quot;dolor&quot;]</span><span>
</span><a name="line-1242"></a><span class="hs-comment">-- &quot;Lorem ipsum dolor&quot;</span><span>
</span><a name="line-1243"></a><span class="hs-identifier">unwords</span><span>                 </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><a href="GHC.Base.html#String"><span class="hs-identifier hs-type">String</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="GHC.Base.html#String"><span class="hs-identifier hs-type">String</span></a><span>
</span><a name="line-1244"></a><span class="hs-cpp">#if defined(USE_REPORT_PRELUDE)
</span><span class="hs-identifier">unwords</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>              </span><span class="hs-glyph">=</span><span>  </span><span class="hs-string">&quot;&quot;</span><span>
</span><a name="line-1246"></a><span class="hs-identifier">unwords</span><span> </span><span class="hs-identifier">ws</span><span>              </span><span class="hs-glyph">=</span><span>  </span><span class="hs-identifier">foldr1</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-identifier">w</span><span> </span><span class="hs-identifier">s</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">w</span><span> </span><span class="hs-operator">++</span><span> </span><span class="hs-char">' '</span><span class="hs-glyph">:</span><span class="hs-identifier">s</span><span class="hs-special">)</span><span> </span><span class="hs-identifier">ws</span><span>
</span><a name="line-1247"></a><span class="hs-cpp">#else
</span><span class="hs-comment">-- Here's a lazier version that can get the last element of a</span><span>
</span><a name="line-1249"></a><span class="hs-comment">-- _|_-terminated list.</span><span>
</span><a name="line-1250"></a><span class="hs-pragma">{-# NOINLINE</span><span> </span><span class="hs-pragma">[</span><span class="hs-pragma">1</span><span class="hs-pragma">]</span><span> </span><span class="hs-pragma">unwords</span><span> </span><span class="hs-pragma">#-}</span><span>
</span><a name="line-1251"></a><a name="unwords"><a href="Data.OldList.html#unwords"><span class="hs-identifier">unwords</span></a></a><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>              </span><span class="hs-glyph">=</span><span>  </span><span class="hs-string">&quot;&quot;</span><span>
</span><a name="line-1252"></a><span class="hs-identifier">unwords</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679152122"><a href="#local-6989586621679152122"><span class="hs-identifier">w</span></a></a><span class="hs-glyph">:</span><a name="local-6989586621679152123"><a href="#local-6989586621679152123"><span class="hs-identifier">ws</span></a></a><span class="hs-special">)</span><span>          </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679152122"><span class="hs-identifier hs-var">w</span></a><span> </span><a href="GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a><span> </span><a href="#local-6989586621679152124"><span class="hs-identifier hs-var">go</span></a><span> </span><a href="#local-6989586621679152123"><span class="hs-identifier hs-var">ws</span></a><span>
</span><a name="line-1253"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-1254"></a><span>    </span><a name="local-6989586621679152124"><a href="#local-6989586621679152124"><span class="hs-identifier">go</span></a></a><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="hs-string">&quot;&quot;</span><span>
</span><a name="line-1255"></a><span>    </span><span class="hs-identifier">go</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679152125"><a href="#local-6989586621679152125"><span class="hs-identifier">v</span></a></a><span class="hs-glyph">:</span><a name="local-6989586621679152126"><a href="#local-6989586621679152126"><span class="hs-identifier">vs</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-char">' '</span><span> </span><span class="hs-glyph">:</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679152125"><span class="hs-identifier hs-var">v</span></a><span> </span><a href="GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a><span> </span><a href="#local-6989586621679152124"><span class="hs-identifier hs-var">go</span></a><span> </span><a href="#local-6989586621679152126"><span class="hs-identifier hs-var">vs</span></a><span class="hs-special">)</span><span>
</span><a name="line-1256"></a><span>
</span><a name="line-1257"></a><span class="hs-comment">-- In general, the foldr-based version is probably slightly worse</span><span>
</span><a name="line-1258"></a><span class="hs-comment">-- than the HBC version, because it adds an extra space and then takes</span><span>
</span><a name="line-1259"></a><span class="hs-comment">-- it back off again. But when it fuses, it reduces allocation. How much</span><span>
</span><a name="line-1260"></a><span class="hs-comment">-- depends entirely on the average word length--it's most effective when</span><span>
</span><a name="line-1261"></a><span class="hs-comment">-- the words are on the short side.</span><span>
</span><a name="line-1262"></a><span class="hs-pragma">{-# RULES</span><span>
</span><a name="line-1263"></a><span class="hs-pragma">&quot;unwords&quot;</span><span> </span><span class="hs-pragma">[</span><span class="hs-pragma">~</span><span class="hs-pragma">1</span><span class="hs-pragma">]</span><span> </span><span class="hs-pragma">forall</span><span> </span><span class="hs-pragma">ws</span><span> </span><span class="hs-pragma">.</span><span>
</span><a name="line-1264"></a><span>   </span><span class="hs-pragma">unwords</span><span> </span><span class="hs-pragma">ws</span><span> </span><span class="hs-pragma">=</span><span> </span><span class="hs-pragma">tailUnwords</span><span> </span><span class="hs-pragma">(</span><span class="hs-pragma">foldr</span><span> </span><span class="hs-pragma">unwordsFB</span><span> </span><span class="hs-pragma">&quot;&quot;</span><span> </span><span class="hs-pragma">ws</span><span class="hs-pragma">)</span><span>
</span><a name="line-1265"></a><span class="hs-pragma">&quot;unwordsList&quot;</span><span> </span><span class="hs-pragma">[</span><span class="hs-pragma">1</span><span class="hs-pragma">]</span><span> </span><span class="hs-pragma">forall</span><span> </span><span class="hs-pragma">ws</span><span> </span><span class="hs-pragma">.</span><span>
</span><a name="line-1266"></a><span>   </span><span class="hs-pragma">tailUnwords</span><span> </span><span class="hs-pragma">(</span><span class="hs-pragma">foldr</span><span> </span><span class="hs-pragma">unwordsFB</span><span> </span><span class="hs-pragma">&quot;&quot;</span><span> </span><span class="hs-pragma">ws</span><span class="hs-pragma">)</span><span> </span><span class="hs-pragma">=</span><span> </span><span class="hs-pragma">unwords</span><span> </span><span class="hs-pragma">ws</span><span>
</span><a name="line-1267"></a><span> </span><span class="hs-pragma">#-}</span><span>
</span><a name="line-1268"></a><span>
</span><a name="line-1269"></a><span class="hs-pragma">{-# INLINE</span><span> </span><span class="hs-pragma">[</span><span class="hs-pragma">0</span><span class="hs-pragma">]</span><span> </span><span class="hs-pragma">tailUnwords</span><span> </span><span class="hs-pragma">#-}</span><span>
</span><a name="line-1270"></a><span class="hs-identifier">tailUnwords</span><span>           </span><span class="hs-glyph">::</span><span> </span><a href="GHC.Base.html#String"><span class="hs-identifier hs-type">String</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="GHC.Base.html#String"><span class="hs-identifier hs-type">String</span></a><span>
</span><a name="line-1271"></a><a name="tailUnwords"><a href="Data.OldList.html#tailUnwords"><span class="hs-identifier">tailUnwords</span></a></a><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>        </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-1272"></a><span class="hs-identifier">tailUnwords</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">_</span><span class="hs-glyph">:</span><a name="local-6989586621679152127"><a href="#local-6989586621679152127"><span class="hs-identifier">xs</span></a></a><span class="hs-special">)</span><span>    </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679152127"><span class="hs-identifier hs-var">xs</span></a><span>
</span><a name="line-1273"></a><span>
</span><a name="line-1274"></a><span class="hs-pragma">{-# INLINE</span><span> </span><span class="hs-pragma">[</span><span class="hs-pragma">0</span><span class="hs-pragma">]</span><span> </span><span class="hs-pragma">unwordsFB</span><span> </span><span class="hs-pragma">#-}</span><span>
</span><a name="line-1275"></a><span class="hs-identifier">unwordsFB</span><span>               </span><span class="hs-glyph">::</span><span> </span><a href="GHC.Base.html#String"><span class="hs-identifier hs-type">String</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="GHC.Base.html#String"><span class="hs-identifier hs-type">String</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="GHC.Base.html#String"><span class="hs-identifier hs-type">String</span></a><span>
</span><a name="line-1276"></a><a name="unwordsFB"><a href="Data.OldList.html#unwordsFB"><span class="hs-identifier">unwordsFB</span></a></a><span> </span><a name="local-6989586621679152128"><a href="#local-6989586621679152128"><span class="hs-identifier">w</span></a></a><span> </span><a name="local-6989586621679152129"><a href="#local-6989586621679152129"><span class="hs-identifier">r</span></a></a><span>           </span><span class="hs-glyph">=</span><span> </span><span class="hs-char">' '</span><span> </span><span class="hs-glyph">:</span><span> </span><a href="#local-6989586621679152128"><span class="hs-identifier hs-var">w</span></a><span> </span><a href="GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a><span> </span><a href="#local-6989586621679152129"><span class="hs-identifier hs-var">r</span></a><span>
</span><a name="line-1277"></a><span class="hs-cpp">#endif
</span><span>
</span><a name="line-1279"></a><span class="hs-comment">{- A &quot;SnocBuilder&quot; is a version of Chris Okasaki's banker's queue that supports
toListSB instead of uncons. In single-threaded use, its performance
characteristics are similar to John Hughes's functional difference lists, but
likely somewhat worse. In heavily persistent settings, however, it does much
better, because it takes advantage of sharing. The banker's queue guarantees
(amortized) O(1) snoc and O(1) uncons, meaning that we can think of toListSB as
an O(1) conversion to a list-like structure a constant factor slower than
normal lists--we pay the O(n) cost incrementally as we consume the list. Using
functional difference lists, on the other hand, we would have to pay the whole
cost up front for each output list. -}</span><span>
</span><a name="line-1289"></a><span>
</span><a name="line-1290"></a><span class="hs-comment">{- We store a front list, a rear list, and the length of the queue.  Because we
only snoc onto the queue and never uncons, we know it's time to rotate when the
length of the queue plus 1 is a power of 2. Note that we rely on the value of
the length field only for performance.  In the unlikely event of overflow, the
performance will suffer but the semantics will remain correct.  -}</span><span>
</span><a name="line-1295"></a><span>
</span><a name="line-1296"></a><span class="hs-keyword">data</span><span> </span><a name="SnocBuilder"><a href="Data.OldList.html#SnocBuilder"><span class="hs-identifier">SnocBuilder</span></a></a><span> </span><a name="local-6989586621679151625"><a href="#local-6989586621679151625"><span class="hs-identifier">a</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a name="SnocBuilder"><a href="Data.OldList.html#SnocBuilder"><span class="hs-identifier">SnocBuilder</span></a></a><span> </span><span class="hs-pragma">{-# UNPACK</span><span> </span><span class="hs-pragma">#-}</span><span> </span><span class="hs-glyph">!</span><a href="../ghc-prim-0.5.2.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Types.html#Word"><span class="hs-identifier hs-type">Word</span></a><span> </span><span class="hs-special">[</span><a href="#local-6989586621679151625"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">]</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679151625"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">]</span><span>
</span><a name="line-1297"></a><span>
</span><a name="line-1298"></a><span class="hs-comment">{- Smart constructor that rotates the builder when lp is one minus a power of
2. Does not rotate very small builders because doing so is not worth the
trouble. The lp &lt; 255 test goes first because the power-of-2 test gives awful
branch prediction for very small n (there are 5 powers of 2 between 1 and
16). Putting the well-predicted lp &lt; 255 test first avoids branching on the
power-of-2 test until powers of 2 have become sufficiently rare to be predicted
well. -}</span><span>
</span><a name="line-1305"></a><span>
</span><a name="line-1306"></a><span class="hs-pragma">{-# INLINE</span><span> </span><span class="hs-pragma">sb</span><span> </span><span class="hs-pragma">#-}</span><span>
</span><a name="line-1307"></a><span class="hs-identifier">sb</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="../ghc-prim-0.5.2.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Types.html#Word"><span class="hs-identifier hs-type">Word</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679151629"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679151629"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.OldList.html#SnocBuilder"><span class="hs-identifier hs-type">SnocBuilder</span></a><span> </span><a href="#local-6989586621679151629"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-1308"></a><a name="sb"><a href="Data.OldList.html#sb"><span class="hs-identifier">sb</span></a></a><span> </span><a name="local-6989586621679152130"><a href="#local-6989586621679152130"><span class="hs-identifier">lp</span></a></a><span> </span><a name="local-6989586621679152131"><a href="#local-6989586621679152131"><span class="hs-identifier">f</span></a></a><span> </span><a name="local-6989586621679152132"><a href="#local-6989586621679152132"><span class="hs-identifier">r</span></a></a><span>
</span><a name="line-1309"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621679152130"><span class="hs-identifier hs-var">lp</span></a><span> </span><a href="../ghc-prim-0.5.2.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Classes.html#%3C"><span class="hs-operator hs-var">&lt;</span></a><span> </span><span class="hs-number">255</span><span> </span><a href="../ghc-prim-0.5.2.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Classes.html#%7C%7C"><span class="hs-operator hs-var">||</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679152130"><span class="hs-identifier hs-var">lp</span></a><span> </span><a href="Data.Bits.html#.%26."><span class="hs-operator hs-var">.&amp;.</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679152130"><span class="hs-identifier hs-var">lp</span></a><span> </span><a href="GHC.Num.html#%2B"><span class="hs-operator hs-var">+</span></a><span> </span><span class="hs-number">1</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><a href="../ghc-prim-0.5.2.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Classes.html#%2F%3D"><span class="hs-operator hs-var">/=</span></a><span> </span><span class="hs-number">0</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.OldList.html#SnocBuilder"><span class="hs-identifier hs-var">SnocBuilder</span></a><span> </span><a href="#local-6989586621679152130"><span class="hs-identifier hs-var">lp</span></a><span> </span><a href="#local-6989586621679152131"><span class="hs-identifier hs-var">f</span></a><span> </span><a href="#local-6989586621679152132"><span class="hs-identifier hs-var">r</span></a><span>
</span><a name="line-1310"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="GHC.Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a><span>                          </span><span class="hs-glyph">=</span><span> </span><a href="Data.OldList.html#SnocBuilder"><span class="hs-identifier hs-var">SnocBuilder</span></a><span> </span><a href="#local-6989586621679152130"><span class="hs-identifier hs-var">lp</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679152131"><span class="hs-identifier hs-var">f</span></a><span> </span><a href="GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a><span> </span><a href="GHC.List.html#reverse"><span class="hs-identifier hs-var">reverse</span></a><span> </span><a href="#local-6989586621679152132"><span class="hs-identifier hs-var">r</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-1311"></a><span>
</span><a name="line-1312"></a><span class="hs-comment">-- The empty builder</span><span>
</span><a name="line-1313"></a><span>
</span><a name="line-1314"></a><span class="hs-identifier">emptySB</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Data.OldList.html#SnocBuilder"><span class="hs-identifier hs-type">SnocBuilder</span></a><span> </span><a href="#local-6989586621679151628"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-1315"></a><a name="emptySB"><a href="Data.OldList.html#emptySB"><span class="hs-identifier">emptySB</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.OldList.html#SnocBuilder"><span class="hs-identifier hs-var">SnocBuilder</span></a><span> </span><span class="hs-number">0</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-1316"></a><span>
</span><a name="line-1317"></a><span class="hs-comment">-- Add an element to the end of a queue.</span><span>
</span><a name="line-1318"></a><span>
</span><a name="line-1319"></a><span class="hs-identifier">snocSB</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Data.OldList.html#SnocBuilder"><span class="hs-identifier hs-type">SnocBuilder</span></a><span> </span><a href="#local-6989586621679151627"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679151627"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.OldList.html#SnocBuilder"><span class="hs-identifier hs-type">SnocBuilder</span></a><span> </span><a href="#local-6989586621679151627"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-1320"></a><a name="snocSB"><a href="Data.OldList.html#snocSB"><span class="hs-identifier">snocSB</span></a></a><span> </span><span class="hs-special">(</span><a href="Data.OldList.html#SnocBuilder"><span class="hs-identifier hs-var">SnocBuilder</span></a><span> </span><a name="local-6989586621679152133"><a href="#local-6989586621679152133"><span class="hs-identifier">lp</span></a></a><span> </span><a name="local-6989586621679152134"><a href="#local-6989586621679152134"><span class="hs-identifier">f</span></a></a><span> </span><a name="local-6989586621679152135"><a href="#local-6989586621679152135"><span class="hs-identifier">r</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621679152136"><a href="#local-6989586621679152136"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.OldList.html#sb"><span class="hs-identifier hs-var">sb</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679152133"><span class="hs-identifier hs-var">lp</span></a><span> </span><a href="GHC.Num.html#%2B"><span class="hs-operator hs-var">+</span></a><span> </span><span class="hs-number">1</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679152134"><span class="hs-identifier hs-var">f</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679152136"><span class="hs-identifier hs-var">x</span></a><span class="hs-glyph">:</span><a href="#local-6989586621679152135"><span class="hs-identifier hs-var">r</span></a><span class="hs-special">)</span><span>
</span><a name="line-1321"></a><span>
</span><a name="line-1322"></a><span class="hs-comment">-- Convert a builder to a list</span><span>
</span><a name="line-1323"></a><span>
</span><a name="line-1324"></a><span class="hs-identifier">toListSB</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Data.OldList.html#SnocBuilder"><span class="hs-identifier hs-type">SnocBuilder</span></a><span> </span><a href="#local-6989586621679151626"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679151626"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">]</span><span>
</span><a name="line-1325"></a><a name="toListSB"><a href="Data.OldList.html#toListSB"><span class="hs-identifier">toListSB</span></a></a><span> </span><span class="hs-special">(</span><a href="Data.OldList.html#SnocBuilder"><span class="hs-identifier hs-var">SnocBuilder</span></a><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621679152137"><a href="#local-6989586621679152137"><span class="hs-identifier">f</span></a></a><span> </span><a name="local-6989586621679152138"><a href="#local-6989586621679152138"><span class="hs-identifier">r</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679152137"><span class="hs-identifier hs-var">f</span></a><span> </span><a href="GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a><span> </span><a href="GHC.List.html#reverse"><span class="hs-identifier hs-var">reverse</span></a><span> </span><a href="#local-6989586621679152138"><span class="hs-identifier hs-var">r</span></a><span>
</span><a name="line-1326"></a></pre></body></html>